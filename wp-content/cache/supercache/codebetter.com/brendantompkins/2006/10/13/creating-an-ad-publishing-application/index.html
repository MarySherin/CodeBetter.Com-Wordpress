<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Creating an Ad Publishing Application | Brendan Tompkins</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/brendantompkins/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/brendantompkins/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/brendantompkins/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/brendantompkins/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Brendan Tompkins' href='http://codebetter.com/brendantompkins/' />
<link rel='start' title='Tap. Tap.  Is this thing on?' href='http://codebetter.com/brendantompkins/2003/10/08/tap-tap-is-this-thing-on/' />
<link rel='prev' title='Devlicio.Us Day One a Success&#8230; Let the Blogging Season Begin!' href='http://codebetter.com/brendantompkins/2006/09/21/devlicio-us-day-one-a-success-let-the-blogging-season-begin/' />
<link rel='next' title='The Great CodeBetter Eight-Week Fall Book Giveaway' href='http://codebetter.com/brendantompkins/2006/10/23/the-great-codebetter-eight-week-fall-book-giveaway/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/brendantompkins/2006/10/13/creating-an-ad-publishing-application/' />
<link rel='shortlink' href='http://codebetter.com/brendantompkins/?p=386' />
<link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/brendantompkins/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-386" class="post-386 post type-post status-publish format-standard hentry category-asp-net-javascript">
					<h1 class="entry-title">Creating an Ad Publishing Application</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">Brendan Tompkins</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/brendantompkins/2006/10/13/creating-an-ad-publishing-application/" title="7:17 pm" rel="bookmark"><span class="entry-date">October 13, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/brendantompkins/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/brendantompkins/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/brendantompkins/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>I&#039;ve been&nbsp; working with <a href="http://www.codebetter.com/blogs/eric.wise">Eric</a> lately on <a href="http://jobs.codebetter.com">Jobs.CodeBetter.Com</a>, our Job ad publishing network.&nbsp; Eric&#039;s been the brains behind the web application, the concept and everything else. &nbsp; I&#039;ve been doing the menial tasks such as skinning and creating our ad syndication application.&nbsp; I had a lot of fun writing the code that actually renders our ads onto our affiliate sites like <a href="http://www.donxml.com">DonXml</a>, <a href="http://www.hanselman.com">Hanselman.Com</a>, <a href="http://www.larkware.com">Larkware</a>, <a href="http://devlicio.us">Devlicio.us</a>, <a href="http://www.devauthority.com">DevAuthority</a> and others. I think I have developed a fairly good pattern for doing this syndication stuff</p>
<p><strong>Minimal Deployed Code</strong><br />I didn&#039;t want to have to ever re-deploy code to any affiliate, and the best way to do this is to minimize any code that they have to copy/paste onto their sites.&nbsp; I solved this by simply having them paste a single javascript line, like so:
</p>
<p> <span style="color: blue;font-family: 'Courier New'"><br />
                 &lt;</span><span style="color: maroon;font-family: 'Courier New'">script</span><span style="font-family: 'Courier New'"> <span style="color: red">src</span><span style="color: blue">=&quot;http://jobs.codebetter.com/feeds/js.ashx?referrer=codebetter&amp;amp;format=leaderboard</span><span style="color: blue">&quot;</span><br />
                         <span style="color: red">type</span><span style="color: blue">=&quot;text/javascript&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></span></p>
<p>The file, js.ashx renders out javascript that finds the script&#039;s place on the page, and renders div elements and associated style information into the page.</p>
<p>Wanna know how I found where on the page to drop the ad?&nbsp; I used the following JavaScript code:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var m = document.getElementsByTagName(&#039;script&#039;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var adscript;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (var i=0; i&lt;m.length; i++) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(m[ i].src.match(&#039;js.ashx&#039;)){ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adscript = m[ i] &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var addiv = document.createElement(&#039;div&#039;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addiv.setAttribute(&#039;id&#039;, &#039;addiv&#039;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addiv.className = &#039;cb_&quot; + format + @&quot;&#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adscript.parentNode.appendChild(addiv)&nbsp;&nbsp;&nbsp; </p>
<p><strong>CSS Styled</strong><br />I wanted to make the ad using divs and CSS so that the affiliate site could override the styles if necessary.. To that end, the javascript adds div elements to the browser&#039;s DOM, and writes out the CSS styles inline.</p>
<p>I found this resulted in the fastest, cleanest rendering.&nbsp; I tried linking in stylesheets by adding style elements to the DOM, but that seemed to create a strange flash as the browser applied the styles.&nbsp; When I wrote out the CSS directly using some document.write() calls, it seemed to work fine.&nbsp;</p>
<p><strong>Provide Customization via an Editor</strong><br />I also wanted to give the affiliate sites an editor to allow them to choose the format of their ads.&nbsp; I was able to do this easily, since the script generated div elements styled using CSS.&nbsp; I simply plopped 6 color chooser controls onto the page, and on postback passed this new color in to the script renderer via the query string.&nbsp; These I place in a separate &lt;style&gt; section allowing the styles to cascade properly.</p>
<p><img src="/photos/brendan.tompkins/images/150322/original.aspx" /></p>
<p>You can <a href="http://jobs.codebetter.com/AdFormatDesigner.aspx">take a look at the tool live here</a>. I used the awesomely easy to use color chooser from <a href="http://xult.org/">Andrew Gretton</a>&nbsp; <a href="http://xult.org/stuff/colorpicker.aspx"><u><u>ASP.NET / C# Color Picker Control</u></u></a></p>
<p>Put this all together and I think we provide a pretty good ad&nbsp; publishing experience for publishers, if I do say so myself. </p>
<p>-Brendan</p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Brendan Tompkins</h2>
							By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.							<div id="author-link">
								<a href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">View all posts by Brendan Tompkins &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/brendantompkins/category/asp-net-javascript/" title="View all posts in asp.net javascript" rel="category tag">asp.net javascript</a>. Bookmark the <a href="http://codebetter.com/brendantompkins/2006/10/13/creating-an-ad-publishing-application/" title="Permalink to Creating an Ad Publishing Application" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/brendantompkins/2006/10/13/creating-an-ad-publishing-application/feed/" title="Comments RSS to Creating an Ad Publishing Application" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-386 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/brendantompkins/2006/09/21/devlicio-us-day-one-a-success-let-the-blogging-season-begin/" rel="prev"><span class="meta-nav">&larr;</span> Devlicio.Us Day One a Success&#8230; Let the Blogging Season Begin!</a></div>
					<div class="nav-next"><a href="http://codebetter.com/brendantompkins/2006/10/23/the-great-codebetter-eight-week-fall-book-giveaway/" rel="next">The Great CodeBetter Eight-Week Fall Book Giveaway <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-2823">
					<div id="dsq-comment-header-2823" class="dsq-comment-header">
						<cite id="dsq-cite-2823">
								<span id="dsq-author-user-2823">karl</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2823" class="dsq-comment-body">
						<div id="dsq-comment-message-2823" class="dsq-comment-message"><p>Brendan:<br />
I have some experience with this stuff. One of the issues we had with syndication was bandwidth costs. Every extra byte in your .js file can end up impacting the bottom line as it gets pushed out to X sites each with Y visitors.</p>
<p>I noticed that the javascript isn&#8217;t being compressed, nor is it obfuscated. I bet using GZIP you could get it to ~30% in size&#8230;or using a packer you could get it to 50% in size.</p>
<p>I&#8217;d recommend this HTtpCompression library:<br />
<a href="http://www.gotdotnet.com/Workspaces/Workspace.aspx?id=2ccc1da1-e45c-401f-9b58-9b533eadb66b" rel="nofollow">http://www.gotdotnet.com/Workspaces/Workspace.aspx?id=2ccc1da1-e45c-401f-9b58-9b533eadb66b</a></p>
<p>or if you wanna go the packer route, check out:<br />
<a href="http://openmymind.net/index.aspx?documentId=55" rel="nofollow">http://openmymind.net/index.aspx?documentId=55</a></p>
<p>Karl</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2824">
					<div id="dsq-comment-header-2824" class="dsq-comment-header">
						<cite id="dsq-cite-2824">
								<span id="dsq-author-user-2824">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2824" class="dsq-comment-body">
						<div id="dsq-comment-message-2824" class="dsq-comment-message"><p>Karl,</p>
<p>Great points, </p>
<p>If I just turn on HTTP compression within IIS, it will do the same as the library, right?  </p>
<p>As for obfuscation, do you have any recommendations for JavaScript obfuscation tools?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2825">
					<div id="dsq-comment-header-2825" class="dsq-comment-header">
						<cite id="dsq-cite-2825">
								<span id="dsq-author-user-2825">karl</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2825" class="dsq-comment-body">
						<div id="dsq-comment-message-2825" class="dsq-comment-message"><p>I&#8217;ve used Dean Edward&#8217;s packer for JS obfuscation:<br />
<a href="http://dean.edwards.name/packer/" rel="nofollow">http://dean.edwards.name/packer/</a></p>
<p>6.0&#8242;s built in HTTPCompression should do the same thing. I know some people have had a hard go of getting it up and running (<a href="http://www.codinghorror.com/blog/archives/000059.html" rel="nofollow">http://www.codinghorror.com/blog/archives/000059.html</a>).</p>
<p>In my experience, using BOTH obfuscation AND compression results in a LARGER data stream than JUST compression. Give it a try for yourself. Fiddler is really handy for this sorta testing.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2826">
					<div id="dsq-comment-header-2826" class="dsq-comment-header">
						<cite id="dsq-cite-2826">
								<span id="dsq-author-user-2826">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2826" class="dsq-comment-body">
						<div id="dsq-comment-message-2826" class="dsq-comment-message"><p>Ah.. I see packer IS the obsfuscation tool. thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2827">
					<div id="dsq-comment-header-2827" class="dsq-comment-header">
						<cite id="dsq-cite-2827">
								<span id="dsq-author-user-2827">Mark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2827" class="dsq-comment-body">
						<div id="dsq-comment-message-2827" class="dsq-comment-message"><p>Thanks Brendan just what I was looking for.</p>
<p>How would you now go about getting an image to appear on the affiliate site? My image ads are quite small but I have no idea how to implement this. Streaming does not seem to work because the affiliate site expects javascript!  Any ideas please?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2828">
					<div id="dsq-comment-header-2828" class="dsq-comment-header">
						<cite id="dsq-cite-2828">
								<span id="dsq-author-user-2828">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2828" class="dsq-comment-body">
						<div id="dsq-comment-message-2828" class="dsq-comment-message"><p>Mark,</p>
<p>I think you should be able to just write an IMG tag to the DOM using JavaScript, with the URL pointing to your image server.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2829">
					<div id="dsq-comment-header-2829" class="dsq-comment-header">
						<cite id="dsq-cite-2829">
								<span id="dsq-author-user-2829">Mark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2829" class="dsq-comment-body">
						<div id="dsq-comment-message-2829" class="dsq-comment-message"><p>Thanks Brendan. A couple of days ago my knowledge was limited but now I have managed to code our ad publishing system. A handler returns the Ads which are a number of image links and basic html displayed onto client sites. The images within the ads are also now served by another generic handler purely for streaming images (and cached). It works very well. Thanks for your posting, much appreciated.</p>
<p>As an aside do you know how to stop IE from blocking the script? By that I mean a way to code the script so that users do not have to allow it in their browser? Thanks..</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2830">
					<div id="dsq-comment-header-2830" class="dsq-comment-header">
						<cite id="dsq-cite-2830">
								<span id="dsq-author-user-2830">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2830" class="dsq-comment-body">
						<div id="dsq-comment-message-2830" class="dsq-comment-message"><p>Hmmm.. Not sure about how to do that.. You mean if they have JavaScript turned off?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2831">
					<div id="dsq-comment-header-2831" class="dsq-comment-header">
						<cite id="dsq-cite-2831">
								<span id="dsq-author-user-2831">Mark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2831" class="dsq-comment-body">
						<div id="dsq-comment-message-2831" class="dsq-comment-message"><p>I am new to all this so &#8230; but if they have javascript turned on! IE (not sure about FF) will (default?) automatically block the script so the ads will not be seen without user intervention. Need to click on the bar that appears at the top of the browser and allow it.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2832">
					<div id="dsq-comment-header-2832" class="dsq-comment-header">
						<cite id="dsq-cite-2832">
								<span id="dsq-author-user-2832">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2832" class="dsq-comment-body">
						<div id="dsq-comment-message-2832" class="dsq-comment-message"><p>Mark, something&#8217;s not setup right.  If your affiliates use script tags to embed the script with the src pointing to your host, they shouldn&#8217;t get the security warning. I&#8217;m not sure under what conditions you&#8217;d get warning.  Do you have an example of where this is happening?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2833">
					<div id="dsq-comment-header-2833" class="dsq-comment-header">
						<cite id="dsq-cite-2833">
								<span id="dsq-author-user-2833">Mark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2833" class="dsq-comment-body">
						<div id="dsq-comment-message-2833" class="dsq-comment-message"><p>Thanks Brendan. It seems that the script was being blocked because for my testing the HTML document that I was using was something I knocked up on notepad, i.e. sitting on my desktop and not within IIS. I&#8217;m definitely new to all this <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  but thanks to people like yourself I&#8217;m learning fast. Cheers.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2834">
					<div id="dsq-comment-header-2834" class="dsq-comment-header">
						<cite id="dsq-cite-2834">
								<span id="dsq-author-user-2834">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2834" class="dsq-comment-body">
						<div id="dsq-comment-message-2834" class="dsq-comment-message"><p>You&#8217;re welcome!  Good luck with this.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2835">
					<div id="dsq-comment-header-2835" class="dsq-comment-header">
						<cite id="dsq-cite-2835">
	http://tradd.us							<span id="dsq-author-user-2835">Eduardo</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2835" class="dsq-comment-body">
						<div id="dsq-comment-message-2835" class="dsq-comment-message"><p>Great tip, this was exactly what i was looking for. I was almost there but probably i would have spent some hours to figure this out&#8230;</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/brendantompkins/2006/10/13/creating-an-ad-publishing-application/ ';
	var disqus_identifier = '386 /blogs/brendan.tompkins/archive/2006/10/13/Creating-an-Ad-Publishing-Application.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'brendantompkins';
	var disqus_title = "Creating an Ad Publishing Application";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=386');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/brendantompkins/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/brendantompkins\/2006\/10\/13\/creating-an-ad-publishing-application\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">About Me</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: left;"><img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=96&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.242 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-26 18:55:38 -->
<!-- super cache -->