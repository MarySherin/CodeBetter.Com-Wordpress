<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Howard Dierking | CodeBetter.Com &#8211; Stuff you need to Code Better!</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/howarddierking/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/howarddierking/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/howarddierking/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/howarddierking/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/howarddierking/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Howard Dierking' href='http://codebetter.com/howarddierking/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel="stylesheet" href="http://codebetter.com/howarddierking/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/howarddierking/wp-content/uploads/spacker-cache/3e52f3b292da95601a0d3fbd9775ac0e.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content">
			<div id="main" class="grid_8">
			<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/howarddierking/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/howarddierking/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/howarddierking/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div>			
	<div id="nav-above" class="navigation">
		<div class="nav-next"><a href="?page=1" > Next Page &raquo;</a></div>
		
	</div><!-- #nav-above -->


				
			<div id="post-61" class="post-61 post type-post status-publish format-standard hentry category-msdn-magazine category-pivot">
			<h2 class="entry-title"><a href="http://codebetter.com/howarddierking/2011/01/03/automating-pivot-trade-card-creation/" title="Permalink to Automating Pivot Trade Card Creation" rel="bookmark">Automating Pivot Trade Card Creation</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on </span><a href="http://codebetter.com/howarddierking/2011/01/03/automating-pivot-trade-card-creation/" title="11:58 pm" rel="bookmark"><span class="entry-date">January 3, 2011</span></a> <span class="meta-sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codebetter.com/howarddierking" title="View all posts by Howard Dierking">Howard Dierking</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p>UPDATE: since I can&#8217;t figure out how to attach the template file discussed here, I&#8217;ve uploaded it to my bitbucket samples repository &#8211; <a href="https://bitbucket.org/howarddierking/samples/src/17c4913453f3/MSDN%20Magazine%20Pivot/MSDNMagazineCollectionTemplate2.htm">you can see the code here</a>.</p>
<p>Sorry for the delay in this part in my series documenting how I created the MSDN Magazine Pivot collection.  Between the holidays and a bunch of other stuff that’s been happening at work (more on that later), I let this slip through the cracks.  Anyways, my gut feel is that for those of you who are interested in creating data-driven Pivot collections, this is likely the installment that you’ll be most interested in.</p>
<p>In Pivot, the trade card is the name given to a single visual unit of data.  For example, in the MSDN Magazine collection, a single article is represented by a single trade card as shown below.</p>
<p><a href="http://codebetter.com/howarddierking/files/2011/01/single-trade-card.png"><img style="margin: 0px 0px 24px;padding-left: 0px;padding-right: 0px;padding-top: 0px;border-width: 0px" src="http://codebetter.com/howarddierking/files/2011/01/single-trade-card_thumb.png" border="0" alt="single-trade-card" width="244" height="244" /></a></p>
<p>Everything you see here with the one exception being the 2 action buttons in the upper right hand corner is part of the trade card.  There’s additional metadata that drives the filter and info panes, but that stuff is defined in your cxml which we covered in the <a href="http://codebetter.com/howarddierking/2010/10/28/generating-the-collection-data/">previous post</a>.  The 2 action buttons are going to be defined in your Silverlight xap – we’ll cover that in a future post.</p>
<p>So when you take a look at all of the different elements on the trade card, you should see that these are simply the data elements that you’ve defined in your cxml (or they are visual elements whose display is conditional on those data elements – the example here being the code icon in the upper right).  The would make this a simple data binding problem, right?  Well, perhaps in some future version, but for now, that’s not quite how things work.</p>
<p>Pivot viewer leverages <a href="http://www.microsoft.com/silverlight/deep-zoom/">Deep Zoom</a> image compositions to do its magic.  This means that all of those various data elements and imagery spread across the trade card are actually a single bitmap which is fed into the Deep Zoom composer to produce a whole bunch of additional bitmaps for different zoom levels.</p>
<p>When Pivot was first available for experimentation, you basically had a couple choices for creating collections.  There was an Excel based tool which was capable of generating both cxml and Deep Zoom collections from your data.  However, the tool did not give you the ability to do anything sophisticated with the trade card image (rather, there was a single column for ‘image’).  For data-driven collections such as the MSDN Magazine collection, the alternative was to figure out how to create the image you wanted for your trade card and then feed the set of trade cards into the Deep Zoom composer software to generate all of the different images for all of the different zoom levels.</p>
<p>For a while, the solution du jour for creating the trade card images was to use a technology like Windows Forms or WPF (where you had a data binding infrastructure), iterating through the source data, binding the data to the form, and then <a href="http://www.grumpydev.com/2009/01/03/taking-wpf-screenshots/">saving a snapshot of the form as the trade card image</a>.  That set could then be fed into the Deep Zoom composer and the outputted composition (dzc file) could be handed to the Pivot Viewer control (along with the cxml) which could then display the collection.</p>
<p>Fortunately, not too long after the Pivot viewer was made available, the Pivot team released a command line utility called pauthor.exe.  This tool allowed you to (among other things) feed in a cxml file and an HTML template file.  It would then follow the same basic steps I outlined above:</p>
<ol>
<li>Bind a cxml item to the HTML template</li>
<li>Take a snapshot of the bound template</li>
<li>Call the Deep Zoom composition API for the set of all captured snapshots</li>
</ol>
<p>This was a hugely helpful tool for a couple of reasons.  Firstly, it was less code that I had to maintain and evolve.  Secondly, pauthor had built-in multi-threading and parallelization, which made it run a great deal faster than performing these steps manually.  And while I could have evolved my custom image generator to have the same great capabilities, I’ll fall back to the first point and say that this was code I didn’t have to write.</p>
<p>So, if you recall the SSIS package that I was using to stitch everything together, you’ll see that the last control flow task is to shell out to pauthor using the following command:</p>
<p>pauthor.exe /source cxml &#8220;Working/msdnmagazine.cxml&#8221; /target deepzoom &#8220;Output/msdnmagazine.cxml&#8221; /html-template &#8220;MSDNMagazineCollectionTemplate2.htm&#8221;</p>
<p>The Template</p>
<p>So you’ve seen how the cxml gets generated, you’ve seen how it is used to create the Deep Zoom image compositions – the only thing you haven’t seen is the template that is used to create the individual trade cards, so here it is.</p>
<pre class="brush: xml; title: ;" title="">
&lt;!-- size: 1200, 1200 --&gt;
&lt;html&gt;
&lt;head&gt;
   &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot; /&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
      var popGroup = &quot;{Popularity}&quot;.toLowerCase();

      switch (popGroup) {
         case &quot;viewed often&quot;:
            popGroup = &quot;top&quot;;
            break;
         case &quot;viewed occasionally&quot;:
            popGroup = &quot;middle&quot;;
            break;
         default:
            popGroup = &quot;bottom&quot;;
      }

      function GetNthPosition(str, c, occurrence) {
         var lastoccurrence = 0;
         for (var i = 0; i &lt; occurrence; i++) {
            var t = str.indexOf(c, lastoccurrence + 1);
            if (t == lastoccurrence)
               return lastoccurrence;
            else if (t == -1)
               return -1;
            lastoccurrence = t;
         }
         return lastoccurrence;
      }
   &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;tradeCard&quot;&gt;
      &lt;div id=&quot;top&quot;&gt;
         &lt;div id=&quot;codeIndicator&quot;&gt;
            &lt;script type=&quot;text/javascript&quot;&gt;
                    var hasCode = &quot;{Has Code}&quot;;

                    if (hasCode == &quot;Has Code&quot;) {
                        if (popGroup == &quot;bottom&quot;)
                            document.write('&lt;img alt=&quot;&quot; src=&quot;Images/hasCode_black.png&quot; /&gt;');
                        else
                            document.write('&lt;img alt=&quot;&quot; src=&quot;Images/hasCode_white.png&quot; /&gt;');
                    }
                &lt;/script&gt;
             &lt;/div&gt;
             &lt;div id=&quot;headline&quot;&gt;
                 &lt;span id=&quot;subhead&quot;&gt;{Subhead}&lt;/span&gt;: &lt;br /&gt;
                 &lt;span id=&quot;title&quot;&gt;
                     &lt;script type=&quot;text/javascript&quot;&gt;
                        var titleStr = &quot;{Title}&quot;;
                        if (titleStr == &quot;(no data)&quot;)
                            document.write(&quot;&quot;);
                        else
                            document.write(titleStr);
                    &lt;/script&gt;
                 &lt;/span&gt;
             &lt;/div&gt;
             &lt;div id=&quot;authors&quot;&gt;{Authors}&lt;/div&gt;
         &lt;/div&gt;
         &lt;div id=&quot;bottom&quot;&gt;
             &lt;div id=&quot;description&quot;&gt;
                 &lt;script type=&quot;text/javascript&quot;&gt;
                    var desc = &quot;{description}&quot;;

                    if (desc) {
                        var fifthSpacePos = GetNthPosition(desc, ' ', 5);

                        document.write('&lt;span id=&quot;lead&quot;&gt;' + desc.substring(0, fifthSpacePos) + ' &lt;/span&gt;');

                        var detailStr = desc.substring(fifthSpacePos + 1, desc.length);
                        if (detailStr.length &gt; 400) {
                            detailStr = detailStr.substring(0, detailStr.indexOf(&quot; &quot;, 400)) + &quot;...&quot;;
                        }

                        document.write('&lt;span id=&quot;detail&quot;&gt;' + detailStr + '&lt;/span&gt;');
                    }

                &lt;/script&gt;
             &lt;/div&gt;
             &lt;div id=&quot;popularity&quot;&gt;
                 &lt;div id=&quot;popularityGroup&quot;&gt;{Popularity}&lt;/div&gt;
                 &lt;div id=&quot;pageViewsSnapshotDates&quot;&gt;{Page Views} Page Views in November&lt;/div&gt;
             &lt;/div&gt;
             &lt;div id=&quot;issue&quot;&gt;&lt;span class=&quot;verticalRule&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;{Issue}&lt;/span&gt;&lt;/div&gt;
             &lt;div id=&quot;topics&quot;&gt;
                 &lt;script type=&quot;text/javascript&quot;&gt;
                    var allTopicsStr = &quot;{Topic:join: | }&quot;;

                    if (allTopicsStr.indexOf(&quot;Topic:join:&quot;, 0) &gt; -1 || &quot;{Issue}&quot;.length &gt; 20)
                        document.write(&quot;&quot;);
                    else {
                        var secondPipePos = GetNthPosition(allTopicsStr, &quot; | &quot;, 2);
                        if (secondPipePos &gt; -1)
                            allTopicsStr = allTopicsStr.substring(0, secondPipePos);

                        if (allTopicsStr.length &gt; 33) //second pass to ensure still not too long
                            allTopicsStr = allTopicsStr.substring(0, allTopicsStr.lastIndexOf(&quot; | &quot;));

                        document.write(allTopicsStr);
                    }
                &lt;/script&gt;
             &lt;/div&gt;
         &lt;/div&gt;
     &lt;/div&gt;
      &lt;script type=&quot;text/javascript&quot;&gt;
        document.getElementById(&quot;tradeCard&quot;).className = popGroup;
    &lt;/script&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</pre>
<p>A couple quick notes on this code – and some stuff to be aware of should you go down this path as well.</p>
<ul>
<li>Make sure you include that size comment at the top of the file – this is needed by pauthor.exe so that it knows the appropriate region of which to take a snapshot post data binding.</li>
<li>As you&#8217;ve probably already noticed, the data binding syntax is simply the name of the facet enclosed in curly braces.</li>
<li>I’ve commented out the CSS that defines all the layout and background images – I’ve done this only for space.  I’ll attach the HTML template file to this post for a more thorough view.</li>
<li>While unobtrusive JavaScript is the right way to build Web pages, it’s not always the right way to build pauthor templates.  This is because as pauthor iterates, it only allows for a certain amount of time for the data binding operation.  If the operation goes past this time quantum, the item is skipped by pauthor.  Initially, my template did all of its work in an unobtrusive manner – and the result was a bunch of blank squares in the generated collection.  As such, you can see that I’m doing a bunch of inline logic and document.write code.</li>
<li>Testing is a bit of a pain, but it’s doable (and should be done).  Download the whole template file to see some of the test code that I have in there.</li>
</ul>
<p>I hope this gives you a good sense of how the trade cards were created for the MSDN Magazine Pivot collection.  I’ll follow up with the Silverlight bits and then the Azure bits.  Hopefully, I’ll let less time go by this time.</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
				<span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">Posted in <a href="http://codebetter.com/howarddierking/category/msdn-magazine/" title="View all posts in MSDN Magazine" rel="category">MSDN Magazine</a>, <a href="http://codebetter.com/howarddierking/category/pivot/" title="View all posts in Pivot" rel="category">Pivot</a></span></span>
				<span class="meta-sep"> | </span>
												<span class="comments-link"><a href="http://codebetter.com/howarddierking/2011/01/03/automating-pivot-trade-card-creation/#respond" title="Comment on Automating Pivot Trade Card Creation"><span class="dsq-postid" rel="61 http://codebetter.com/howarddierking/?p=61">View Comments</span></a></span>
							</div><!-- #entry-utility -->
		</div><!-- #post-61 -->

		
						
			<div id="post-56" class="post-56 post type-post status-publish format-standard hentry category-uncategorized">
			<h2 class="entry-title"><a href="http://codebetter.com/howarddierking/2010/12/18/umbraco-source-code-migrated-to-mercurial/" title="Permalink to Umbraco Source Code Migrated to Mercurial" rel="bookmark">Umbraco Source Code Migrated to Mercurial</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on </span><a href="http://codebetter.com/howarddierking/2010/12/18/umbraco-source-code-migrated-to-mercurial/" title="3:43 pm" rel="bookmark"><span class="entry-date">December 18, 2010</span></a> <span class="meta-sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codebetter.com/howarddierking" title="View all posts by Howard Dierking">Howard Dierking</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p>It looks as though the good folks at Umbraco have successfully migrated the bulk of their codebase from SVN to Mercurial on <a href="http://umbraco.codeplex.com/">CodePlex</a>.&nbsp; I say “bulk of” because I don’t yet see the v5.0 branch – though based on a <a href="http://umbraco.org/follow-us/blog-archive/2010/12/8/heads-up-umbraco-sourcecode-at-codeplex-to-switch-to-mercurial">recent post by Alex Norcliffe</a>, I expect to see it soon enough.</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
				<span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">Posted in <a href="http://codebetter.com/howarddierking/category/uncategorized/" title="View all posts in Uncategorized" rel="category">Uncategorized</a></span></span>
				<span class="meta-sep"> | </span>
												<span class="comments-link"><a href="http://codebetter.com/howarddierking/2010/12/18/umbraco-source-code-migrated-to-mercurial/#respond" title="Comment on Umbraco Source Code Migrated to Mercurial"><span class="dsq-postid" rel="56 http://codebetter.com/howarddierking/2010/12/18/umbraco-source-code-migrated-to-mercurial/">View Comments</span></a></span>
							</div><!-- #entry-utility -->
		</div><!-- #post-56 -->

		
						
			<div id="post-55" class="post-55 post type-post status-publish format-standard hentry category-architecture category-international category-web">
			<h2 class="entry-title"><a href="http://codebetter.com/howarddierking/2010/12/18/thoughts-on-ip-reverse-lookup/" title="Permalink to Thoughts On IP Reverse Lookup?" rel="bookmark">Thoughts On IP Reverse Lookup?</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on </span><a href="http://codebetter.com/howarddierking/2010/12/18/thoughts-on-ip-reverse-lookup/" title="6:30 am" rel="bookmark"><span class="entry-date">December 18, 2010</span></a> <span class="meta-sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codebetter.com/howarddierking" title="View all posts by Howard Dierking">Howard Dierking</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p>I was having a discussion today about URLs and associated behaviors with a colleague who works with many of our international subsidiaries.&nbsp; In the course of the conversation, we came to the topic of IP reverse lookup and it’s pros/cons for geo-detection and content routing.&nbsp; In the past, we’ve used this technique as a last ditch effort to try and route a user to the most relevant possible version of a site or page (by last ditch, I mean to say that there’s no info provided by the URL, by user preferences, or by browser headers).&nbsp; However, my colleague had some general concerns about using it at all – a couple reasons were:</p>
<ul>
<li>Geo-detection systems based on IP addresses tend to have problems with accuracy as the result of things like proxy servers</li>
<li>We’re making a decision based on information about you that you are not able to control (unlike something like your browser language or any other HTTP header)</li>
</ul>
<p>We talked through several different scenarios, including user scenarios like that of a business traveler who may want to see content in his language but see local events for the region in which he is traveling.&nbsp; We also talked through several of the different geo-political scenarios where users in a country may speak the same language as users in another country, but should never be automatically directed to the site of that other country for legal reasons.&nbsp; </p>
<p>In the end, the question came down to whether or not we should use any form of implicit user context to make any kind of default content routing decision (e.g. browser lang or geo-detection).&nbsp; Making the choice explicit would certainly disambiguate the Web site’s behavior for users, though it would also add a step for first time visitors.</p>
<p>What are your thoughts/experiences in this area?&nbsp; Any good pointers to articles/reference that helped?</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
				<span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">Posted in <a href="http://codebetter.com/howarddierking/category/architecture/" title="View all posts in architecture" rel="category">architecture</a>, <a href="http://codebetter.com/howarddierking/category/international/" title="View all posts in International" rel="category">International</a>, <a href="http://codebetter.com/howarddierking/category/web/" title="View all posts in Web" rel="category">Web</a></span></span>
				<span class="meta-sep"> | </span>
												<span class="comments-link"><a href="http://codebetter.com/howarddierking/2010/12/18/thoughts-on-ip-reverse-lookup/#respond" title="Comment on Thoughts On IP Reverse Lookup?"><span class="dsq-postid" rel="55 http://codebetter.com/howarddierking/2010/12/18/thoughts-on-ip-reverse-lookup/">View Comments</span></a></span>
							</div><!-- #entry-utility -->
		</div><!-- #post-55 -->

		
						
			<div id="post-31" class="post-31 post type-post status-publish format-standard hentry category-msdn-magazine category-pivot">
			<h2 class="entry-title"><a href="http://codebetter.com/howarddierking/2010/10/28/generating-the-collection-data/" title="Permalink to Generating the Collection Data" rel="bookmark">Generating the Collection Data</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on </span><a href="http://codebetter.com/howarddierking/2010/10/28/generating-the-collection-data/" title="6:24 am" rel="bookmark"><span class="entry-date">October 28, 2010</span></a> <span class="meta-sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codebetter.com/howarddierking" title="View all posts by Howard Dierking">Howard Dierking</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p>As I mentioned <a href="/blogs/howard.dierking/archive/2010/09/19/data-and-design-the-chicken-and-egg-problem.aspx">previously</a>, getting your data design right is critical in creating a highly functional and aesthetically pleasing collection.  In that same post, I also mentioned that it’s good to test your data design using the pivot viewer before creating any of your trade card images.  This will help to validate that you’ve chosen the right facet categories and that your sample sizes look like about what you would expect across your various pivots – particularly in histogram mode.</p>
<p>Pivot (both the rich client and Silverlight control) expects XML data written to a defined XML schema.  Additionally, your XML should be saved as a file with a *.cxml extension (more about additional requirements for hosting on the Web or from Azure later).  The best resource for understanding more about this format (as well as download the actual XSD files) is the pivot Web site – more specifically, the <a href="http://www.getpivot.com/developer-info/xml-schema.aspx">Collection XML Schema page</a>.  For the <a href="http://msdn.microsoft.com/en-us/magazine/default.aspx">MSDN Magazine collection</a>, the collection definition XML looked like the following:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Collection xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:p=http://schemas.microsoft.com/livelabs/pivot/...
    Name="MSDN Magazine Articles"
    p:Icon="msdnmagazine_icon.ico"
    SchemaVersion="1.0"
    xmlns="http://schemas.microsoft.com/collection/metadata/2009"&gt;
    &lt;FacetCategories&gt;
        &lt;FacetCategory Name="Popularity" Type="String" p:IsFilterVisible="true"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false"&gt;
            &lt;Extension&gt;
                &lt;p:SortOrder Name="Popularity Group"&gt;
                    &lt;p:SortValue Value="Viewed Often" /&gt;
                    &lt;p:SortValue Value="Viewed Occasionally" /&gt;
                    &lt;p:SortValue Value="Viewed Infrequently" /&gt;
                &lt;/p:SortOrder&gt;
            &lt;/Extension&gt;
        &lt;/FacetCategory&gt;
        &lt;FacetCategory Name="Issue Date" Type="DateTime" Format="MMMM yyyy"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Topic" Type="String"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="true"
            p:IsWordWheelVisible="true" /&gt;
        &lt;FacetCategory Name="Authors" Type="String"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="true"
            p:IsWordWheelVisible="true" /&gt;
        &lt;FacetCategory Name="Column / Feature" Type="String"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="true"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Column Name" Type="String"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="true"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Has Code" Type="String"
            p:IsFilterVisible="true"
            p:IsMetaDataVisible="true"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Issue" Type="String"
            p:IsFilterVisible="false"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Code Link" Type="String"
            p:IsFilterVisible="false"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Title" Type="String"
            p:IsFilterVisible="false"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Subhead" Type="String"
            p:IsFilterVisible="false"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
        &lt;FacetCategory Name="Page Views" Type="String"
            p:IsFilterVisible="false"
            p:IsMetaDataVisible="false"
            p:IsWordWheelVisible="false" /&gt;
    &lt;/FacetCategories&gt;
    &lt;Items ImgBase="msdnmagazine_deepzoom\msdnmagazine.dzc"&gt;
        &lt;Item Id="1"
            Name="Thread Pools: Scalable Multithreaded ..."
            Img="#0" Href="http://msdn.microsoft.com/..."&gt;
            &lt;Description&gt;
                &lt;!-- long description here --&gt;
            &lt;/Description&gt;
            &lt;Facets&gt;
                &lt;Facet Name="Authors"&gt;
                    &lt;String Value="Ron Fosner" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Code Link"&gt;
                    &lt;String Value="http://code.msdn...." /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Column / Feature"&gt;
                    &lt;String Value="feature" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Column Name"&gt;
                    &lt;String Value="Feature Article or Unknown " /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Has Code"&gt;
                    &lt;String Value="Has Code" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Issue"&gt;
                    &lt;String Value="October 2010" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Issue Date"&gt;
                    &lt;DateTime Value="2010-10-01T00:00:00" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Page Views"&gt;
                    &lt;String Value="Unknown" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Popularity"&gt;
                    &lt;String Value="Viewed Infrequently" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Subhead"&gt;
                    &lt;String Value="Thread Pools" /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Title"&gt;
                    &lt;String Value="Scalable Multithreaded ..." /&gt;
                &lt;/Facet&gt;
                &lt;Facet Name="Topic"&gt;
                    &lt;String Value="C++" /&gt;
                    &lt;String Value=".NET" /&gt;
                    &lt;String Value="Concurrency" /&gt;
                &lt;/Facet&gt;
            &lt;/Facets&gt;
        &lt;/Item&gt;

        &lt;!-- Many, many, many more items --&gt;
    &lt;/Items&gt;
&lt;/Collection&gt;
</pre>
<p>As you can see, most of the configuration information that tells the Pivot viewer how to setup its various windows (filters, the details pane, etc.) is defined up top in the FacetCategories section.  I’ll quickly point out a couple features of the collection schema that I’ve taken advantage of for the magazine collection, but won’t spend too much time here because it’s all really well documented on the Pivot Web site.</p>
<ul>
<li>Depending on the level of control that you desire, you may end up needing to use elements from 2 different Pivot-related schemas.  All of the basic elements are defined in the http://schemas.microsoft.com/collection/metadata/2009 namespace, which is my default namespace.  More detailed settings, such as determining whether a facet category is visible in the filter pane, are controllable through elements and attributes defined in the http://schemas.microsoft.com/livelabs/pivot/collection/2009 namespace (prefixed “p” in my document).</li>
<li>I’ve defined a custom sort order for the popularity group.  As you can see, this is really simple to do – just put the various text strings in the order that they should show up in.  The key here is that you need to know what your possible values are – so not a good idea to try this when you could have a lot of different values or when you don’t know all of the possible values up front.  Then again, if you have a large set of facets in a category, this should in itself be a “smell” – you want to keep your set of facets relatively small within a facet category so that your user is not having to scroll through an exhaustive list just to filter.  For the magazine collection, I broke this rule a bit for the authors facet category – but I did this intentionally for 2 reasons:
<ul>
<li>Looking at previous traffic data showed that people actually did care to filter by specific authors</li>
<li>Within the filter pane, the Pivot viewer enables sorting by the number of articles an author has written and not just by the alphabetical list of authors – and I thought this was a nice way to bring the ‘regular’ writers (and based on our data, our more searched out writers) up to the front.</li>
</ul>
</li>
<li>If you compare the above XML with the actual Pivot viewer, you’ll see that I’ve defined more facet categories than I’m actually displaying (for example, “Subhead”).  This has to do with my production workflow (more on that later) – these are not actually needed by the Pivot viewer.</li>
<li>The “Topic” facet has multiple string values in it.  This is great for enabling an article to show up across multiple topics, but it has the downside of double-counting the article in histogram mode.  Because of my <a href="/blogs/howard.dierking/archive/2010/09/12/creating-the-msdn-magazine-pivot-collection-what-and-why.aspx">goals</a>, this was an acceptable level of imprecision – however, you may have different requirements, so be aware.</li>
</ul>
<h2>And now the part about actually generating the data…</h2>
<p>There are 4 different data sources that feed into the process that ultimately yields the above XML:</p>
<ul>
<li>The MSDN Magazine metadata management application (SharePoint lists)</li>
<li>A legacy MSDN content item with the mappings of topic friendly names to short names (emphasis on legacy)</li>
<li>The MSDN back end database for getting ‘short ids’ from the longer guid identifiers</li>
<li>The previous month’s page traffic report, courtesy of <a href="http://www.omniture.com">Omniture</a></li>
</ul>
<p>The workflow is managed using a SSIS package and looks like the following:</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/howard.dierking/pivotWorkflow_5F00_2.png"><img style="padding-left: 0px;padding-right: 0px;padding-top: 0px;border-width: 0px" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/howard/dierking/pivotWorkflow_thumb.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787593&amp;Signature=IWDsgQSZW5FuiR%2fPPKc9JoY0%2bXI%3d" border="0" alt="pivotWorkflow" width="357" height="348" /></a></p>
<p>There’s (unfortunately) some pre-processing work that needs to happen on the Omniture data due to the fact that apparently, “csv” to the Omniture developers translates into “CSV that we assume someone will be reading using only Excel”.  As such, the file contains a bunch of header data (again, stuff that would look great if you were using Excel to view the file, but stuff that only gets in the way when you’re trying to programmatically load the data).  Even more insidious, and the part that required the true ‘cleanup’ by me (SSIS can be configured to simply ignore header rows, so that’s more about me complaining than anything else), was in the fact that the – again, CSV – file outputted formatted numbers, and guess what character was used for the thousands separator?  You guessed it – the comma!  As a result, my script task reads in the text and runs the following regular expression code to replace the formatted numbers with unformatted numbers.</p>
<pre>Regex regex = new Regex("\"(\\d+),(\\d+)\"",
    RegexOptions.CultureInvariant | RegexOptions.Compiled);
string regexReplace ="$1$2";
string result = regex.Replace(fileText, regexReplace);</pre>
<p>The Omniture cleanup then simply removes extra data columns from the report and then saves the cleaned up file over the original one in the working directory.  While all this has been happening, we’ve also copied the XML representation of all article content from the magazine metadata management application.  This XML looks like the following:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Index&gt;
    &lt;Mag Name="MSDN Magazine"
        homepageguid="ebc3411f-9739-4103-a534-76783c4aa573"
        issuesguid="320c2adc-3dc5-4fbb-b197-e2dfbc766d35"
        issuestocguid="f3f75834-f3c2-4973-8d63-375fe8231b5e"
        rootguid="bc353eb1-58d9-4e7f-b70a-2900729b6b18"&gt;
        &lt;Yr Name="2010" Dir="10"
            guid="7aaba6cc-42b6-4432-85ac-592e48b79e30"
            tocguid="cdb28296-4fe9-473b-841a-d34a17643c88" codeguid=""&gt;
            &lt;Iss Note="" Year="2010" Dir="10" Name="October"
                Date="10/1/2010" guid="7a430b75-f398-4b6f-9d70-41888e7b95b2"
                tocguid="bdc12809-ffaa-4ff7-86e1-0c4ea451e8eb" Id="25;#"&gt;
                &lt;Art Note="" Sub="Thread Pools" type="feature"
                    Ti="Scalable Multithreaded Programming with Thread Pools"
                    Au="Ron Fosner" Sum="Getting the most out of ..."
                    guid="26c5f253-ff52-4e94-bbc5-1a8f8d6ab031"
                    shortid="gg232758" codeguid="" Name=""
                    coderef="http://code.msdn.microsoft.com/mag201010Thread"
                    codename="http://code.msdn.microsoft.com/mag201010Thread"
                    WebTitle="Scalable Multithreaded Programming ..."
                    Id="345;#" IssuePublishDate="2010-10-01T00:00:00"&gt;
                    &lt;Tag&gt;C++&lt;/Tag&gt;
                    &lt;Tag&gt;.NET&lt;/Tag&gt;
                    &lt;Tag&gt;Concurrency&lt;/Tag&gt;
                &lt;/Art&gt;
                &lt;!-- Many, many, many more articles --&gt;
            &lt;/Iss&gt;
        &lt;/Yr&gt;
    &lt;/Mag&gt;
&lt;/Index&gt;</pre>
<p>Once I’ve got that copied over, I perform several post-processing steps on it using the other data sources I’ve mentioned above.  I’ll walk through them in order.</p>
<p>1. Resolve Short IDs</p>
<p>If you look at the above XML, you can see that the example article has an attribute ‘shortid’ defined.  As you probably figured, this is what shows up on the URL – and as such, what shows up in the Omniture traffic reports.  Most of the more recently added articles have this short id defined – however, when I started the project, I discovered that nearly all articles which were more than 2 years old had only a surrogate guid defined, and as such, I created this command to find the guid in the backend content database and extract the short id.</p>
<p>2. Get the Friendly Tag Name</p>
<p>This is just a product of history – I would explain it to you if I even knew the original background.  But for whatever reason, the value of the Tag elements does not match to the “Friendly Name” that gets displayed in the UI.  It doesn’t look too bad in the example above, but there are some really cryptic ones in there – promise.  Anyway, the mapping data is stored as a content item which can be publically accessed through the <a href="http://services.msdn.microsoft.com/ContentServices/ContentService.asmx">MTPS content Web services</a>.  Here’s the code to match everything up.</p>
<pre>class UpdateTagDescriptions
{
    private const string MAGAZINE_TOPICS_ASSET = "ff754346";
    private const string MAGAZINE_TOPICS_LOCALE = "en-us";
    private const string MAGAZINE_TOPICS_VERSION = "MSDN.10";
    private const string XMLNS_XHTML = "http://www.w3.org/1999/xhtml";

    private static XmlNamespaceManager _namespaceMgr;

    public UpdateTagDescriptions() {
        _namespaceMgr = new XmlNamespaceManager(new NameTable());
        _namespaceMgr.AddNamespace("x", XMLNS_XHTML);
    }

    public void Run(XDocument masterXmlDoc) {
        //get the topics from the MTPS content Web service
        var proxy = new ContentServicePortTypeClient();
        var request = new getContentRequest
        {
            contentIdentifier = MAGAZINE_TOPICS_ASSET,
            locale = MAGAZINE_TOPICS_LOCALE,
            version = MAGAZINE_TOPICS_VERSION
        };

        // Specify that we want the XHTML primary document
        // contents and code stream
        var documents = new requestedDocument[1];
        documents[0] = new requestedDocument {
            type = documentTypes.primary,
            selector = "Mtps.Code" };

        request.requestedDocuments = documents;

        var response = proxy.GetContent(null, request);
        var r = response.primaryDocuments[3].Any;

        Console.WriteLine("Building tag map...");

        var tagMap = new Dictionary&lt;string, string&gt;();
        var topicElements = r.SelectNodes("//x:topic", _namespaceMgr);
        if(topicElements == null)
            throw new Exception("No topic elements found.");

        foreach (XmlElement topicElement in topicElements)
        {
            var name = topicElement.GetAttribute("name");
            var tag = topicElement.GetAttribute("tag");
            tagMap.Add(tag, name);
        }

        Console.WriteLine("Total number of elements in the tag map: "
            + tagMap.Count);

        foreach (var mappingItem in tagMap) {
            var tagElements = masterXmlDoc.XPathSelectElements(
                "//Tag[.='" + mappingItem.Key + "']", _namespaceMgr);

            Console.WriteLine("Replacing {0} {1} tags with {2}",
                tagElements.Count(), mappingItem.Key, mappingItem.Value);

            foreach (var tagElement in tagElements)
                tagElement.Value = mappingItem.Value;
        }
    }
}</pre>
<p>3. Embellish with Omniture Metrics</p>
<p>Here is where the Omniture data actually gets added to the working copy of the XML file pulled from the metadata management application.  Basically, the code does 3 things:</p>
<ol>
<li>create a popularity group map based on the total number of ‘art’ elements in the metadata management app’s XML</li>
<li>run through the cleaned up Omniture report CSV from top to bottom (the data comes out of Omniture sorted from top ranked (most viewed) to bottom)</li>
<li>Add XML data noting the popularity group as well as some of the raw statistics (e.g. page views)</li>
</ol>
<p>The code looks like the following:</p>
<pre>class EmbelishWithPageMetrics
{
    public static Regex ShortIdRegEx = new Regex("/(\\w+).aspx",
        RegexOptions.CultureInvariant | RegexOptions.Compiled);

    public void Run(XDocument masterXmlDoc, string omnitureFile) {
        Console.WriteLine("Embelishing with Omniture page metrics...");

        // get total number of articles and setup the popularity group
        var articleElements = masterXmlDoc.XPathSelectElements("//Art");
        var popularityGroupMap = new PopularityGroupMap(
            articleElements.Count());

        // update each article with popularity group and page views data\
        using (var textStream = new FileStream(omnitureFile, FileMode.Open)) {
            using (var sr = new StreamReader(textStream)) {
                var recordNumber = 1;
                while (!sr.EndOfStream) {
                    var line = sr.ReadLine();
                    var cells = line.Split(new[] {','});

                    var shortId = ExtractShortIdFromUrl(cells[1]);

                    recordNumber += UpdateOmnitureFacetsForArticle(shortId,
                        recordNumber, int.Parse(cells[2]),
                        popularityGroupMap, masterXmlDoc);
                }
            }
        }
    }

    private static string ExtractShortIdFromUrl(string url)
    {
        var shortIdMatch = ShortIdRegEx.Match(url);
        return shortIdMatch.Groups[1].Value;
    }

    private static int UpdateOmnitureFacetsForArticle(string shortId,
        int sortRank, int pageViews, PopularityGroupMap popularityGroupMap,
        XDocument masterXmlDoc)
    {
        var matchingArticle = masterXmlDoc.XPathSelectElement(
            "//Art[@shortid='"+ shortId +"']");
        if (matchingArticle == null) {
            return 0;
        }    

        matchingArticle.SetAttributeValue("OmniturePopularityGroup",
            popularityGroupMap.GetGroup(sortRank));
        matchingArticle.SetAttributeValue("OmniturePageViews", pageViews);

        return 1;
    }
}</pre>
<p>and the popularity group map looks like this:</p>
<pre>class PopularityGroupMap
{
    private int[] _groupUpperBounds;

    public PopularityGroupMap(int totalItems)
    {
        //sets up distribution of 1:10%, 2:60%, 3:30%
        _groupUpperBounds = new[] {
            (int)(totalItems * .1),
            (int)(totalItems * .7) };
    }

    public int GetGroup(int rank)
    {
        if (rank &lt;= _groupUpperBounds[0])
            return 1;
        return rank &lt;= _groupUpperBounds[1] ? 2 : 3;
    }
}</pre>
<p>After the post processing adds this data to the XML, getting to the final CXML (collection schema) is the matter of a simple XSLT.  I was planning to post the XSLT here, but it’s around 300 lines and I’m sure I would have to make it twice that long to keep lines from running off the page, so instead, I’ll reference it in bitbucket as soon as I get the solution posted.</p>
<p>Anyways, the final step is to run the pauthor.exe tool to create the DeepZoom images.  <a href="http://www.getpivot.com/developer-info/cmd-line-tools.aspx">Pauthor is a command line tool provided by Live Labs</a> which, among other things, let’s you create a DHTML template and bind it to items in your CXML to create your image pyramids.  I’ll talk about this at more length in my next post.</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
				<span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">Posted in <a href="http://codebetter.com/howarddierking/category/msdn-magazine/" title="View all posts in MSDN Magazine" rel="category">MSDN Magazine</a>, <a href="http://codebetter.com/howarddierking/category/pivot/" title="View all posts in Pivot" rel="category">Pivot</a></span></span>
				<span class="meta-sep"> | </span>
												<span class="comments-link"><a href="http://codebetter.com/howarddierking/2010/10/28/generating-the-collection-data/#respond" title="Comment on Generating the Collection Data"><span class="dsq-postid" rel="31 /blogs/howard.dierking/archive/2010/10/27/generating-the-collection-data.aspx">View Comments</span></a></span>
							</div><!-- #entry-utility -->
		</div><!-- #post-31 -->

		
						
			<div id="post-30" class="post-30 post type-post status-publish format-standard hentry category-msdn-magazine category-pivot">
			<h2 class="entry-title"><a href="http://codebetter.com/howarddierking/2010/09/20/data-and-design-the-chicken-and-egg-problem/" title="Permalink to Data and Design: The Chicken and Egg Problem" rel="bookmark">Data and Design: The Chicken and Egg Problem</a></h2>

			<div class="entry-meta">
				<span class="meta-prep meta-prep-author">Posted on </span><a href="http://codebetter.com/howarddierking/2010/09/20/data-and-design-the-chicken-and-egg-problem/" title="5:29 am" rel="bookmark"><span class="entry-date">September 20, 2010</span></a> <span class="meta-sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codebetter.com/howarddierking" title="View all posts by Howard Dierking">Howard Dierking</a></span>			</div><!-- .entry-meta -->

				<div class="entry-content">
				<p>Since it seems that summer (all 3 weeks of it) is now over here in the northwestern United States, I&rsquo;ll start this post with a winter sports anecdote.&nbsp; When explaining the differences between skiing and snowboarding to people who are not winter-sports-minded (like my parents who live in Texas), I usually mention that while snowboarding takes a little longer to get the basics, once you get it, there&rsquo;s not that much more to it (Shaun White acrobatics aside).&nbsp; Skiing, on the other hand, is an activity where with a little coordination, you can get to an average level pretty quickly &ndash; but it takes a lot more practice to get really good at it.</p>
<p>Creating a Pivot collection is kind of like skiing in that regard.&nbsp; It&rsquo;s pretty easy to take some data, shove it into a tool (or through an XSLT file), and get a file that will enable Pivot to move some rectangles around on the screen.&nbsp; However, to create a truly compelling and effective collection requires a good bit more thought &ndash; and at least in my case, quite a few iterations.&nbsp; An effective collection follows a design path very similar to that in creating info graphics &ndash; it must be visually compelling so that people actually bother to look at it, but it should be equally data-rich, and the visual cues should serve to focus the data without being distracting.&nbsp; Further, because the Pivot experience exists on multiple levels, the design challenge is even more pronounced than in a static info graphic (more on this in a bit).</p>
<p>A quick disclaimer: I&rsquo;m not claiming to have got this 100% right with the MSDN Magazine collection &ndash; this feels like one of those things I could refine and iterate on for a long, long time.&nbsp; I did, however, go through quite a few design reviews with the Pivot UX team, so I hope to at least tell you some of the feedback that they gave me along the way.&nbsp; I also want to tell you the approach I took for getting to a place where I was able to iterate pretty quickly.</p>
<h3>1) What&rsquo;s the Goal | What&rsquo;s the Grain?</h3>
<p>Since the magazine collection went live, I&rsquo;ve talked to several different groups who have wanted to create collections for their own content.&nbsp; However, many come to the conversation without having a clear goal in mind for what they hope to accomplish with the collection.&nbsp; For some things, having something cool might be in itself sufficient (though even that is debatable), but remember that a Pivot collection follows many of the same rules of info graphics &ndash; and as such serves to communicate some specific (and hopefully intended) message to your users.&nbsp; So what&rsquo;s your message?&nbsp; As I mentioned in my first post, my goal with the MSDN Magazine collection was to enable users to explore article content in a more immersive and meaningful way than the current search or navigation facilities.&nbsp; Put another way, the Pivot experience is juxtaposed with navigation and search experiences, both of which tend to be static and decontextualized in nature.</p>
<p>Just answering this simple question around what you&rsquo;re trying to accomplish with the collection will help to drive some fundamental design design decisions, such as:</p>
<ul>
<li>What is the grain of a single item (which will ultimately be your trade card)? </li>
<li>Do I actually have 2 collections that need to be composed in a linked collection? </li>
<li>How do my users generally set about to accomplish the goals that I hope to improve by my collection? </li>
</ul>
<p>For example, in the case of the magazine collection, I knew from my goals that the grain of an item would be an article.&nbsp; I also considered whether or not it made sense to pull issues out into a separate collection and have the articles collection link to it.&nbsp; In the end, I decided that having an issue&rsquo;s collection didn&rsquo;t really add a lot of value in helping people to explore article content, so while it would have been a cool excuse for me to build a linked collection, it hit the cutting room floor.&nbsp; Finally, by looking at the existing MSDN Magazine Web site, I was able to get an initial sense of how users are able to navigate to article content today.&nbsp; This shaped the initial data facets that I implemented in the collection.</p>
<h3>2) Start with the Data &ndash; Think Dimensionally</h3>
<p>Speaking of those facets, let&rsquo;s talk about the data.&nbsp; We live in a world where it feels as though every data&nbsp; problem is looked at through the lens of the relational database &ndash; and that&rsquo;s tragic.&nbsp; Don&rsquo;t get me wrong &ndash; there are many great things that you can do with relational databases, and a normalized design is the right solution to plenty of data problems out there &ndash; but not all.&nbsp; When we think about problems that fall into the categories of&nbsp; reporting (particularly the ad-hoc type), data analysis and exploration, the more appropriate data model is many times denormalized and dimensional rather than normalized and relational.&nbsp; As a quick illustration, consider how how you might model the MSDN Magazine data in a traditional, normalized SQL database.&nbsp; It might look something like this:</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/howard.dierking/image_5F00_0F0BB587.png"><img height="233" width="432" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/howard/dierking/image_thumb_16677534.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787593&amp;Signature=rchShSDdwnDxqZGJ%2bnbPj5Gh4vA%3d" alt="image" border="0" style="border-right-width: 0px;margin:;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" /></a></p>
<p>Now, this kind of design might be great if I were creating a transactional system where I&rsquo;m doing lots of inserts, but for something like a reporting store (or a Pivot collection) where you&rsquo;re focusing on reads, this is a suboptimal data structure because getting any kind of useful data set out of it requires joining tables together.&nbsp; Instead, think about how you might create this in Excel &ndash; might be something more like this:</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/howard.dierking/exceldata_5F00_799DDA51.png"><img height="90" width="480" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/howard/dierking/exceldata_thumb_3E69FE86.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787593&amp;Signature=s%2f1BDcmgEVvU%2fgLDjN8%2bnEpKVMM%3d" alt="exceldata" border="0" style="border-right-width: 0px;margin:;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" /></a></p>
<p>Note that there&rsquo;s now lots of data duplication (in this example, some of the duplicates are more realistic than others) &ndash; this is just fine for reporting scenarios where what we care about most is our engine&rsquo;s ability to do things like grouping, filtering, and sorting.&nbsp; This is the kind of data structure that tools like SQL Server Analysis Services work best on, and it&rsquo;s the kind of data structure that Pivot expects for its collections &ndash; so best that you go ahead and get into that mindset early on.</p>
<h3>3) Get to a Working State</h3>
<p>Many of the people I&rsquo;ve talked to about the magazine collection and about building Pivot collections more generally come in with the mindset of needing to plan the entire collection, from data to UI, before they start implementing any of it.&nbsp; Given the number of iterations I personally went trough with my UI (the trade card design), I can say with confidence that unless you are equal parts developer and brilliant graphic artist, if you wait until you have all parts clearly understood, you may never get anything done.&nbsp; One of the great things about developing Pivot collections is that you can pass a CXML file to the viewer and if the viewer can&rsquo;t find your images (your trade cards), it will render placeholder images for all of the items specified in your CXML file.&nbsp; Everything in your collection will function exactly how you should expect, from filtering and sorting to the item information pane when you click on an item.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/howard.dierking/image_5F00_2FAF2CD4.png"><img height="294" width="455" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/howard/dierking/image_thumb_0627736F.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787593&amp;Signature=g%2feQkAwZitAkRVuG3nAdZ9R7e48%3d" alt="image" border="0" style="border-right-width: 0px;margin:;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" /></a></p>
<p>The moral here is simple &ndash; focus first on your data and create a CXML.&nbsp; You can then view it in the Pivot viewer.&nbsp; Iterate on your CXML until you&rsquo;ve got your data exactly how you want it.&nbsp; THEN, worry about your trade card design.</p>
<h3>4) Conflate Dimensions Based on the Goal</h3>
<p>In some of my initial iterations of the MSDN Magazine Pivot collection, I had aspects of my publish date spread out between 2 different filter options.&nbsp; Year was one option &ndash; it was stored as an integer value &ndash; and looking back, I think that I did this primarily so that I would get the cool slider bar control for the filter UX.&nbsp; I also had the issue name, which was in most cases the issue&rsquo;s publication month, sorted alphabetically.&nbsp; </p>
<p>Now there were really a couple problems to the approach which weren&rsquo;t apparent until a few iterations (and feedback from the Pivot design team).&nbsp; The first problem was that I was using 2 different filters to filter on the same logical bit of data from the user perspective.&nbsp; Second, my approach had me storing year as a number and months as a string &ndash; and this brought a variety of additional technical challenges.&nbsp; For example, even though I had formatted my years to show up as integers, the slider control was still enabling me to select fractional values &ndash; and most people don&rsquo;t find a lot of value in filtering by a date range starting with 2008.12345.&nbsp; The other major challenge I ran into was with months being stored as strings.&nbsp; As you know, the months of the year are not exactly alphabetical &ndash; which led me to have to create a custom sort order in my CXML.&nbsp; While this is absolutely doable (and not at all difficult), it was also something that caused me to revisit the goals behind having these filters there in the first place.</p>
<p>In the case of year/issue, the goal was to enable users to filter or pivot by the date that the issue was published.&nbsp; The manner in which I had exposed this information was disjointed and not even complete as it turned out (for example, how do you know when the &lsquo;Visual Studio 2008 Launch Issue&rsquo; was published?&nbsp; After reflecting on these sorts of issues for a bit, I decided to forego the cool slider control, and conflate year and issue into a single &lsquo;Published Date&rsquo; category of a date data type.</p>
<h3>5) What are the 30,000 Foot Insights?</h3>
<p>Early on in the development of the magazine collection, I was fortunate to meet with one of the main UX designers on the Live Labs Pivot team.&nbsp; One of the biggest challenges that this designer said to me when we first began discussing the idea was &lsquo;That&rsquo;s great that you can put 2500 articles in the Pivot browser&rsquo;, but what kind of insights can you convey when you&rsquo;re looking at all 2500 articles in a single, zoomed-out view?&nbsp; This was (and continues to be) a really interesting question for me &ndash; how can you show insight from such a high level view?&nbsp; What tools do you even have to work with at that level?&nbsp; The obvious answer to that last question (though I&rsquo;m sure that there are also less-obvious answers) is color.&nbsp; So then came the question &ndash; so what kinds of things can I show using color?&nbsp; One option that I considered and ruled out was topic.&nbsp; I ruled it out for 2 reasons &ndash; 1) I had too many topics, and too many colors would have yielded a very muddy picture when zoomed out; 2) multiple topics could be mapped to a single article &ndash; again, it just doesn&rsquo;t paint a very clean picture.</p>
<p>In the end, I decided that viewership was a data point which would always be specific to a single article and which could be divided into however many discrete &lsquo;viewership groups&rsquo; that I wanted to show in my design.&nbsp; Therefore, I setup my data extract routine (more on that later) to pull the previous month&rsquo;s page views for each article and put it into a low/middle/high group.&nbsp; And that&rsquo;s what the background colors mean in the magazine collection.&nbsp; The previous month&rsquo;s page views are conveyed from the lightest background color (least viewed) to the darkest (most viewed).</p>
							</div><!-- .entry-content -->
	
			<div class="entry-utility">
				<span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">Posted in <a href="http://codebetter.com/howarddierking/category/msdn-magazine/" title="View all posts in MSDN Magazine" rel="category">MSDN Magazine</a>, <a href="http://codebetter.com/howarddierking/category/pivot/" title="View all posts in Pivot" rel="category">Pivot</a></span></span>
				<span class="meta-sep"> | </span>
												<span class="comments-link"><a href="http://codebetter.com/howarddierking/2010/09/20/data-and-design-the-chicken-and-egg-problem/#respond" title="Comment on Data and Design: The Chicken and Egg Problem"><span class="dsq-postid" rel="30 /blogs/howard.dierking/archive/2010/09/19/data-and-design-the-chicken-and-egg-problem.aspx">View Comments</span></a></span>
							</div><!-- #entry-utility -->
		</div><!-- #post-30 -->

		
			
	<div id="nav-below" class="navigation">
		<div class="nav-next"><a href="?page=1" > Next Page &raquo;</a></div>
		
	</div><!-- #nav-below -->
			</div><!-- #main -->
			<div id="sidebar" class="grid_4">
						<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://0.gravatar.com/avatar/859e318f8403226ff4b912edf77fba2a?s=96&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>I like technology...a lot...
</li><li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Categories</h3><div class="tagcloud"><a href='http://codebetter.com/howarddierking/category/ado-net-data-services/' class='tag-link-4922' title='5 topics' style='font-size: 22pt;'>ADO.NET Data Services</a>
<a href='http://codebetter.com/howarddierking/category/alt-net/' class='tag-link-1362' title='1 topic' style='font-size: 8pt;'>ALT.NET</a>
<a href='http://codebetter.com/howarddierking/category/architecture/' class='tag-link-2588' title='4 topics' style='font-size: 19.6666666667pt;'>architecture</a>
<a href='http://codebetter.com/howarddierking/category/auto-tagging/' class='tag-link-4908' title='1 topic' style='font-size: 8pt;'>auto tagging</a>
<a href='http://codebetter.com/howarddierking/category/bdd/' class='tag-link-2123' title='4 topics' style='font-size: 19.6666666667pt;'>BDD</a>
<a href='http://codebetter.com/howarddierking/category/ddd/' class='tag-link-1717' title='1 topic' style='font-size: 8pt;'>DDD</a>
<a href='http://codebetter.com/howarddierking/category/fluent-nhibernate/' class='tag-link-4911' title='1 topic' style='font-size: 8pt;'>Fluent NHibernate</a>
<a href='http://codebetter.com/howarddierking/category/hardware/' class='tag-link-4927' title='1 topic' style='font-size: 8pt;'>hardware</a>
<a href='http://codebetter.com/howarddierking/category/home-network/' class='tag-link-4909' title='1 topic' style='font-size: 8pt;'>Home Network</a>
<a href='http://codebetter.com/howarddierking/category/international/' class='tag-link-9201' title='1 topic' style='font-size: 8pt;'>International</a>
<a href='http://codebetter.com/howarddierking/category/ioc/' class='tag-link-1361' title='1 topic' style='font-size: 8pt;'>IoC</a>
<a href='http://codebetter.com/howarddierking/category/msdn-magazine/' class='tag-link-4919' title='5 topics' style='font-size: 22pt;'>MSDN Magazine</a>
<a href='http://codebetter.com/howarddierking/category/mspec/' class='tag-link-2130' title='2 topics' style='font-size: 13.25pt;'>MSpec</a>
<a href='http://codebetter.com/howarddierking/category/my-setup/' class='tag-link-4926' title='1 topic' style='font-size: 8pt;'>my setup</a>
<a href='http://codebetter.com/howarddierking/category/nhibernate/' class='tag-link-2527' title='1 topic' style='font-size: 8pt;'>NHibernate</a>
<a href='http://codebetter.com/howarddierking/category/performance/' class='tag-link-4925' title='2 topics' style='font-size: 13.25pt;'>performance</a>
<a href='http://codebetter.com/howarddierking/category/pivot/' class='tag-link-4931' title='4 topics' style='font-size: 19.6666666667pt;'>Pivot</a>
<a href='http://codebetter.com/howarddierking/category/r/' class='tag-link-4916' title='3 topics' style='font-size: 16.75pt;'>R#</a>
<a href='http://codebetter.com/howarddierking/category/refactoring/' class='tag-link-4737' title='1 topic' style='font-size: 8pt;'>Refactoring</a>
<a href='http://codebetter.com/howarddierking/category/ssis/' class='tag-link-4921' title='5 topics' style='font-size: 22pt;'>SSIS</a>
<a href='http://codebetter.com/howarddierking/category/tortoisesvn/' class='tag-link-4923' title='1 topic' style='font-size: 8pt;'>TortoiseSVN</a>
<a href='http://codebetter.com/howarddierking/category/uncategorized/' class='tag-link-1044' title='5 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/howarddierking/category/virtualization/' class='tag-link-4918' title='1 topic' style='font-size: 8pt;'>virtualization</a>
<a href='http://codebetter.com/howarddierking/category/wcf/' class='tag-link-4928' title='1 topic' style='font-size: 8pt;'>WCF</a>
<a href='http://codebetter.com/howarddierking/category/web/' class='tag-link-5485' title='1 topic' style='font-size: 8pt;'>Web</a>
<a href='http://codebetter.com/howarddierking/category/windows-7/' class='tag-link-4917' title='1 topic' style='font-size: 8pt;'>Windows 7</a>
<a href='http://codebetter.com/howarddierking/category/windsor/' class='tag-link-4930' title='1 topic' style='font-size: 8pt;'>Windsor</a></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/howarddierking/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/howarddierking/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/howarddierking/2010/10/' title='October 2010'>October 2010</a></li>
	<li><a href='http://codebetter.com/howarddierking/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/howarddierking/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/howarddierking/2009/03/' title='March 2009'>March 2009</a></li>
		</ul>
</li>				</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #content -->
	
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.311 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-26 18:46:44 -->
<!-- super cache -->