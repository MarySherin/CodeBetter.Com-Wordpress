<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Introduction to the Reactive Extensions for JavaScript – Drag and Drop | Matthew Podwysocki</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Matthew Podwysocki' href='http://codebetter.com/matthewpodwysocki/' />
<link rel='start' title='let Matt = CodeBetter + 1' href='http://codebetter.com/matthewpodwysocki/2008/04/24/let-matt-codebetter-1/' />
<link rel='prev' title='The Reactive Extensions for JavaScript Released' href='http://codebetter.com/matthewpodwysocki/2010/03/17/the-reactive-extensions-for-javascript-released/' />
<link rel='next' title='Introduction to the Reactive Extensions for JavaScript – jQuery Live Event Integration' href='http://codebetter.com/matthewpodwysocki/2010/03/21/introduction-to-the-reactive-extensions-for-javascript-jquery-live-event-integration/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/matthewpodwysocki/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop/' />
<link rel='shortlink' href='http://codebetter.com/matthewpodwysocki/?p=213' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/matthewpodwysocki/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-213" class="post-213 post type-post status-publish format-standard hentry category-event-based-porgramming category-javascript category-jsconf category-reactive-framework">
					<h1 class="entry-title">Introduction to the Reactive Extensions for JavaScript – Drag and Drop</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/matthewpodwysocki/author/matthewpodwysocki/" title="View all posts by matthewpodwysocki">matthewpodwysocki</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/matthewpodwysocki/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop/" title="5:55 am" rel="bookmark"><span class="entry-date">March 19, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/matthewpodwysocki/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/matthewpodwysocki/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>We’ve covered a bit of ground in this series on the <a href="http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx">Reactive Extensions for JavaScript</a>, covering the basics, jQuery integration, blocking to asynchronous and further composition.&#160; One way I’ve found to really get your hands dirty using this library is to take examples from other libraries and translate them into using our library of choice.&#160; In this case, I’m taking examples written in the <a href="http://flapjax-lang.org">Flapjax language</a>, and translating them into the Reactive Extensions for JavaScript and jQuery.</p>
<p>Before we get started, let’s get caught up to where we are today:</p>
<ul>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/16/introduction-to-the-reactive-extensions-to-javascript.aspx">Introduction</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/23/introduction-to-the-reactive-extensions-for-javascript-creating-observables.aspx">Creating Observables</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/27/introduction-to-the-reactive-extensions-for-javascript-creating-observers.aspx">Creating Observers</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/05/introduction-to-the-reactive-extensions-for-javascript-jquery-integration.aspx">jQuery Integration</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/11/introduction-to-the-reactive-extensions-for-javascript-composing-callbacks.aspx">Composing Callbacks</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/12/introduction-to-the-reactive-extensions-for-javascript-from-blocking-to-async.aspx">From Blocking to Async</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/15/introduction-to-the-reactive-extensions-for-javascript-wikipedia-lookup.aspx">Wikipedia Lookup</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper.aspx">Composing Deeper</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/17/the-reactive-extensions-for-javascript-released.aspx">Bing Maps and Twitter Mashup</a> </li>
</ul>
<h2>Drag and Drop Example</h2>
<p>Some of the comments made during my initial introduction to the Reactive Extensions for JavaScript mentioned the Flapjax language and whether I had heard of it.&#160; I had indeed, having translated some of the samples from the language to the Reactive Extensions for JavaScript with some assistance with jQuery.&#160; Today, we’ll step through a simple drag and drop scenario.&#160; </p>
<p>For those unfamiliar with Flapjax, it’s a programming language built on top of JavaScript which deals with event-driven reactive design, much like RxJS.&#160; By reading the APIs, you can very much see a Haskell influence in not only the design, but the naming and even down to the notation they use to describe the functions.&#160; Not to mention of course that the actual compiler for Flapjax is written in Haskell.&#160; Interestingly enough, Erik Meijer hosted an <a href="http://channel9.msdn.com/shows/Going+Deep/Expert-to-Expert-Web-Programming-with-Flapjax/">Expert-to-Expert on Channel9</a> with one of the Flapjax creators, <a href="http://www.cs.brown.edu/~sk/">Shriram Krishnamurthi</a>.</p>
<p>Before we move onto the actual drag and drop scenario, let’s look at the most basic example, tracking the mouse movement.&#160; In Flapjax, you could write some inline code which gets compiled to native JavaScript such as the following:</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">&lt;</span><span style="color: #800000">p</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">The mouse coordinates are
</span><span style="color: #FF0000">&amp;lt;</span><span style="color: #000000"> {! mouseLeftB(document) !}, {! mouseTopB(document) !} </span><span style="color: #FF0000">&amp;gt;</span><span style="color: #000000">
</span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000FF">&gt;</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Then, when compiled with Flapjax, will produce real JavaScript like the following which allows us to track the mouse movement:</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">    </span><span style="color: #0000FF">&lt;</span><span style="color: #800000">p</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
      The mouse coordinates are
</span><span style="color: #FF0000">&amp;lt;</span><span style="color: #000000">
      </span><span style="color: #0000FF">&lt;</span><span style="color: #800000">script </span><span style="color: #FF0000">lang</span><span style="color: #0000FF">="text/javascript"</span><span style="color: #FF0000"> type</span><span style="color: #0000FF">=""</span><span style="color: #0000FF">&gt;</span><span style="background-color: #F5F5F5;color: #000000">
        </span><span style="background-color: #F5F5F5;color: #0000FF">function</span><span style="background-color: #F5F5F5;color: #000000"> fxcode0()
        {
          compilerInsertDomB(mouseLeftB(compilerUnbehavior(document)),
                             </span><span style="background-color: #F5F5F5;color: #000000">"</span><span style="background-color: #F5F5F5;color: #000000">flapjaxsuid0</span><span style="background-color: #F5F5F5;color: #000000">"</span><span style="background-color: #F5F5F5;color: #000000">);
        }
        fxcode.push(fxcode0)
      </span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000FF">&gt;</span><span style="color: #008000">&lt;!--</span><span style="color: #008000">
      </span><span style="color: #008000">--&gt;</span><span style="color: #0000FF">&lt;</span><span style="color: #800000">span </span><span style="color: #FF0000">id</span><span style="color: #0000FF">="flapjaxsuid0"</span><span style="color: #0000FF">&gt;</span><span style="color: #000000"> 

         </span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
      ,
      </span><span style="color: #0000FF">&lt;</span><span style="color: #800000">script </span><span style="color: #FF0000">lang</span><span style="color: #0000FF">="text/javascript"</span><span style="color: #FF0000"> type</span><span style="color: #0000FF">=""</span><span style="color: #0000FF">&gt;</span><span style="background-color: #F5F5F5;color: #000000">
        </span><span style="background-color: #F5F5F5;color: #0000FF">function</span><span style="background-color: #F5F5F5;color: #000000"> fxcode1()
        {
          compilerInsertDomB(mouseTopB(compilerUnbehavior(document)),
                             </span><span style="background-color: #F5F5F5;color: #000000">"</span><span style="background-color: #F5F5F5;color: #000000">flapjaxsuid1</span><span style="background-color: #F5F5F5;color: #000000">"</span><span style="background-color: #F5F5F5;color: #000000">);
        }
        fxcode.push(fxcode1)
      </span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000FF">&gt;</span><span style="color: #008000">&lt;!--</span><span style="color: #008000">
      </span><span style="color: #008000">--&gt;</span><span style="color: #0000FF">&lt;</span><span style="color: #800000">span </span><span style="color: #FF0000">id</span><span style="color: #0000FF">="flapjaxsuid1"</span><span style="color: #0000FF">&gt;</span><span style="color: #000000"> 

         </span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
      </span><span style="color: #FF0000">&amp;gt;</span><span style="color: #000000">

    </span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000FF">&gt;</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Not exactly the prettiest, yet quite effective on what it’s trying to do.&#160; What I’d rather do, however, is live in native JavaScript to make this happen instead of some of these more interesting abstractions.&#160; In some sense, I like tools that stay true to the language and focus on libraries such as jQuery, Moo Tools, etc, although I do find CoffeeScript oddly fascinating.&#160; </p>
<p>To back up my argument for a second with an example in native JavaScript, we could do similar using the Reactive Extensions for JavaScript and a little bit of jQuery.&#160; In this case, we’ll take the document’s mousemove event and in our Subscribe method call, we set the coords &lt;span&gt; element with our pageX and pageY values from the mousemove event.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">$(document).ready(</span><span style="color: #0000FF">function</span><span style="color: #000000">() {

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseMove </span><span style="color: #000000">=</span><span style="color: #000000"> $(document)
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mousemove</span><span style="color: #000000">"</span><span style="color: #000000">)
        .Subscribe(</span><span style="color: #0000FF">function</span><span style="color: #000000">(event) {
            $(</span><span style="color: #000000">"</span><span style="color: #000000">#coords</span><span style="color: #000000">"</span><span style="color: #000000">).html(event.pageX </span><span style="color: #000000">+</span><span style="color: #000000"> </span><span style="color: #000000">"</span><span style="color: #000000">, </span><span style="color: #000000">"</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> event.pageY);
        });

});</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>And then we get to our actual HTML which displays our initial values of 0, 0 inside a span before our mouse starts moving.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">&lt;</span><span style="color: #800000">div</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">The mouse coordinates are </span><span style="color: #FF0000">&amp;lt;</span><span style="color: #000000"> </span><span style="color: #0000FF">&lt;</span><span style="color: #800000">span </span><span style="color: #FF0000">id</span><span style="color: #0000FF">="coords"</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">0, 0</span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000FF">&gt;</span><span style="color: #000000"> </span><span style="color: #FF0000">&amp;gt;</span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000FF">&gt;</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>We could of course have tackled this in any number of ways with any number of frameworks, but it is interesting how they differ in tackling the same problem.&#160; Let’s take their example of dragging an object around the screen.&#160; You can check their code sample here.</p>
<p>Let’s double up our approach and create two &lt;div&gt; elements that we want to drag around the screen.&#160; </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">&lt;</span><span style="color: #800000">div </span><span style="color: #FF0000">id</span><span style="color: #0000FF">="dragTarget1"</span><span style="color: #FF0000">
     style</span><span style="color: #0000FF">="background-color: #000000; border: 1px solid #666666;
            color: #ffffff; padding: 10px; position: absolute;
            font-family: sans-serif; cursor: move"</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
Drag Me!
</span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
</span><span style="color: #0000FF">&lt;</span><span style="color: #800000">div </span><span style="color: #FF0000">id</span><span style="color: #0000FF">="dragTarget2"</span><span style="color: #FF0000">
     style</span><span style="color: #0000FF">="background-color: #0000FF; border: 1px solid #666666;
            color: #ffffff; padding: 10px; position: absolute;
            font-family: sans-serif; cursor: move; left: 150px"</span><span style="color: #0000FF">&gt;</span><span style="color: #000000">
Drag Me Too!
</span><span style="color: #0000FF">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000FF">&gt;</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Now, let’s do something interesting with it.&#160; We’ll create a function called drag which takes a jQuery element and we’ll return the different between our image offset and the position of the mouse.&#160; Let’s first define the function and get our mouse up and mouse move events bound.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">function</span><span style="color: #000000"> drag(dragTarget) {

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseUp </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mouseup</span><span style="color: #000000">"</span><span style="color: #000000">);

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseMove </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mousemove</span><span style="color: #000000">"</span><span style="color: #000000">);</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Next, on our mouse down, we’ll need to calculate the difference between the mouse position and the offset of our drag target.&#160; We will return an object with a left and top properties calculated with the difference between the mouse position and the element’s offset.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseDown </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mousedown</span><span style="color: #000000">"</span><span style="color: #000000">)
        .Select(</span><span style="color: #0000FF">function</span><span style="color: #000000">(event) {
            </span><span style="color: #0000FF">return</span><span style="color: #000000"> { left : event.clientX </span><span style="color: #000000">-</span><span style="color: #000000"> dragTarget.offset().left,
                     top  : event.clientY </span><span style="color: #000000">-</span><span style="color: #000000"> dragTarget.offset().top }; });</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Finally, we need to take our mouse down and bind it to our mouse down with the SelectMany method passing in our image offset.&#160; With our mouse move, we need to prevent the default action of the event from happening, which in this case is the text from being selected.&#160; We’ll then project the position of the mouse move and create a delta between that and the image offset coming from the mouse down along with returning our drag target for ease of access.&#160; And finally, we’ll do all of this until the mouse up event.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">    </span><span style="color: #0000FF">return</span><span style="color: #000000"> mouseDown
        .SelectMany(</span><span style="color: #0000FF">function</span><span style="color: #000000">(imageOffset) {
            </span><span style="color: #0000FF">return</span><span style="color: #000000"> mouseMove
                .Do(</span><span style="color: #0000FF">function</span><span style="color: #000000">(event) { event.preventDefault(); })
                .Select(</span><span style="color: #0000FF">function</span><span style="color: #000000">(pos) {
                    </span><span style="color: #0000FF">return</span><span style="color: #000000"> { target : dragTarget,
                             left   : pos.clientX </span><span style="color: #000000">-</span><span style="color: #000000"> imageOffset.left,
                             top    : pos.clientY </span><span style="color: #000000">-</span><span style="color: #000000"> imageOffset.top }; })
                .TakeUntil(mouseUp); });</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Below is the drag function in its entirety.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">function</span><span style="color: #000000"> drag(dragTarget) {

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseUp </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mouseup</span><span style="color: #000000">"</span><span style="color: #000000">);

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseMove </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mousemove</span><span style="color: #000000">"</span><span style="color: #000000">);

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> mouseDown </span><span style="color: #000000">=</span><span style="color: #000000"> dragTarget
        .ToObservable(</span><span style="color: #000000">"</span><span style="color: #000000">mousedown</span><span style="color: #000000">"</span><span style="color: #000000">)
        .Select(</span><span style="color: #0000FF">function</span><span style="color: #000000">(event) {
            </span><span style="color: #0000FF">return</span><span style="color: #000000"> { left : event.clientX </span><span style="color: #000000">-</span><span style="color: #000000"> dragTarget.offset().left,
                     top  : event.clientY </span><span style="color: #000000">-</span><span style="color: #000000"> dragTarget.offset().top }; });

    </span><span style="color: #0000FF">return</span><span style="color: #000000"> mouseDown
        .SelectMany(</span><span style="color: #0000FF">function</span><span style="color: #000000">(imageOffset) {
            </span><span style="color: #0000FF">return</span><span style="color: #000000"> mouseMove
                .Do(</span><span style="color: #0000FF">function</span><span style="color: #000000">(event) { event.preventDefault(); })
                .Select(</span><span style="color: #0000FF">function</span><span style="color: #000000">(pos) {
                    </span><span style="color: #0000FF">return</span><span style="color: #000000"> { target : dragTarget,
                             left   : pos.clientX </span><span style="color: #000000">-</span><span style="color: #000000"> imageOffset.left,
                             top    : pos.clientY </span><span style="color: #000000">-</span><span style="color: #000000"> imageOffset.top }; })
                .TakeUntil(mouseUp); });
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Now to hook up the two &lt;div&gt; elements to the drag function and then set the top and left appropriately.&#160; To do this, we’ll create an Observer which takes the mouse position and sets the CSS property top and left accordingly.&#160; We’ll then call Subscribe on our two elements using the Observer.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">$(document).ready(</span><span style="color: #0000FF">function</span><span style="color: #000000">() {

    </span><span style="color: #0000FF">var</span><span style="color: #000000"> observer </span><span style="color: #000000">=</span><span style="color: #000000"> Rx.Observer.Create(
        </span><span style="color: #0000FF">function</span><span style="color: #000000">(pos) {
            pos.target.css(</span><span style="color: #000000">"</span><span style="color: #000000">left</span><span style="color: #000000">"</span><span style="color: #000000">, pos.left);
            pos.target.css(</span><span style="color: #000000">"</span><span style="color: #000000">top</span><span style="color: #000000">"</span><span style="color: #000000">,  pos.top);
        });

    drag($(</span><span style="color: #000000">"</span><span style="color: #000000">#dragTarget1</span><span style="color: #000000">"</span><span style="color: #000000">)).Subscribe(observer);
    drag($(</span><span style="color: #000000">"</span><span style="color: #000000">#dragTarget2</span><span style="color: #000000">"</span><span style="color: #000000">)).Subscribe(observer);
});</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>You can find the source in its entirety <a href="http://gist.github.com/337272">here</a>.</p>
<h2>Conclusion</h2>
<p>Taking lessons from other frameworks gives us some good practice on how to do things with our current library and with the Reactive Extensions for JavaScript and some jQuery, we’re able to do some pretty interesting things such as this simple drag and drop example.&#160; That’s just one of the many things we can do with it that I’ll hopefully cover more in the near future.&#160; So, <a href="http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx">download it</a>, and <a href="http://social.msdn.microsoft.com/Forums/en-US/rx/threads">give the team feedback!</a></p>
<p>What can I say?&#160; I love JavaScript and very much looking forward to the upcoming <a href="http://jsconf.us/2010">JSConf 2010</a> here in Washington, DC where the Reactive Extensions for JavaScript will be shown in its full glory with <a href="http://twitter.com/jvgogh">Jeffrey Van Gogh</a> (who you can now follow on Twitter).&#160; For too many times, we’ve looked for the abstractions over the natural language of the web (HTML, CSS and JavaScript) and created monstrosities instead of embracing the web for what it is.&#160; With libraries such as jQuery and indeed the Reactive Extensions for JavaScript gives us better tools for dealing with the troubled child that is DOM manipulation and especially events.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/matthewpodwysocki/category/event-based-porgramming/" title="View all posts in Event-based Porgramming" rel="category tag">Event-based Porgramming</a>, <a href="http://codebetter.com/matthewpodwysocki/category/javascript/" title="View all posts in JavaScript" rel="category tag">JavaScript</a>, <a href="http://codebetter.com/matthewpodwysocki/category/jsconf/" title="View all posts in JSConf" rel="category tag">JSConf</a>, <a href="http://codebetter.com/matthewpodwysocki/category/reactive-framework/" title="View all posts in Reactive Framework" rel="category tag">Reactive Framework</a>. Bookmark the <a href="http://codebetter.com/matthewpodwysocki/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop/" title="Permalink to Introduction to the Reactive Extensions for JavaScript – Drag and Drop" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/matthewpodwysocki/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop/feed/" title="Comments RSS to Introduction to the Reactive Extensions for JavaScript – Drag and Drop" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-213 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/matthewpodwysocki/2010/03/17/the-reactive-extensions-for-javascript-released/" rel="prev"><span class="meta-nav">&larr;</span> The Reactive Extensions for JavaScript Released</a></div>
					<div class="nav-next"><a href="http://codebetter.com/matthewpodwysocki/2010/03/21/introduction-to-the-reactive-extensions-for-javascript-jquery-live-event-integration/" rel="next">Introduction to the Reactive Extensions for JavaScript – jQuery Live Event Integration <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/matthewpodwysocki/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop/ ';
	var disqus_identifier = '213 /blogs/matthew.podwysocki/archive/2010/03/19/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'matthewpodwysocki';
	var disqus_title = "Introduction to the Reactive Extensions for JavaScript – Drag and Drop";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=213');
		});
					};
	var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/matthewpodwysocki\/2010\/03\/19\/introduction-to-the-reactive-extensions-for-javascript-drag-and-drop\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.254 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 13:58:53 -->
<!-- super cache -->