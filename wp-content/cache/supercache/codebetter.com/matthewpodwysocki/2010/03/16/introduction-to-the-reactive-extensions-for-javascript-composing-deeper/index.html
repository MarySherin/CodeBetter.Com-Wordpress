<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Introduction to the Reactive Extensions for JavaScript – Composing deeper | Matthew Podwysocki</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Matthew Podwysocki' href='http://codebetter.com/matthewpodwysocki/' />
<link rel='start' title='let Matt = CodeBetter + 1' href='http://codebetter.com/matthewpodwysocki/2008/04/24/let-matt-codebetter-1/' />
<link rel='prev' title='Introduction to the Reactive Extensions for JavaScript – Wikipedia Lookup' href='http://codebetter.com/matthewpodwysocki/2010/03/15/introduction-to-the-reactive-extensions-for-javascript-wikipedia-lookup/' />
<link rel='next' title='The Reactive Extensions for JavaScript Released' href='http://codebetter.com/matthewpodwysocki/2010/03/17/the-reactive-extensions-for-javascript-released/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/matthewpodwysocki/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper/' />
<link rel='shortlink' href='http://codebetter.com/matthewpodwysocki/?p=210' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/matthewpodwysocki/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-210" class="post-210 post type-post status-publish format-standard hentry category-event-based-porgramming category-javascript category-jsconf category-reactive-framework">
					<h1 class="entry-title">Introduction to the Reactive Extensions for JavaScript – Composing deeper</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/matthewpodwysocki/author/matthewpodwysocki/" title="View all posts by matthewpodwysocki">matthewpodwysocki</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/matthewpodwysocki/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper/" title="11:59 pm" rel="bookmark"><span class="entry-date">March 16, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/matthewpodwysocki/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/matthewpodwysocki/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>We’ve covered a bit of ground already in this series on the Reactive Extensions for JavaScript (RxJS) from the basic information, creating observers and observables, jQuery integration, composing asynchronous methods with callbacks and in the last post, turned blocking calls into asynchronous calls.&#160; Now that we have some more fundamental building blocks, let’s see what else we can do with it.&#160; Before moving to <a href="http://flapjax-lang.org/">FlapJax</a> examples, I want to revisit the <a href="http://www.microsofttranslator.com/Default.aspx">Microsoft Translator</a> to take a piece of text and translate into all languages except the currently detected.</p>
<p>Also, if you’re at <a href="http://live.visitmix.com/">Mix</a> this year, you’ll notice that Erik Meijer is giving a talk on the <a href="http://live.visitmix.com/MIX10/Sessions/FTL01">Reactive Extensions for JavaScript</a>. I highly recommend that you go to this session, especially if you’ve been interested in this series.&#160; Prepare for some pretty slick demos to show off the functionality of the library. </p>
<p>Before we get started, let’s get caught up to where we are today:</p>
<ul>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/16/introduction-to-the-reactive-extensions-to-javascript.aspx">Introduction</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/23/introduction-to-the-reactive-extensions-for-javascript-creating-observables.aspx">Creating Observables</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/02/27/introduction-to-the-reactive-extensions-for-javascript-creating-observers.aspx">Creating Observers</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/05/introduction-to-the-reactive-extensions-for-javascript-jquery-integration.aspx">jQuery Integration</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/11/introduction-to-the-reactive-extensions-for-javascript-composing-callbacks.aspx">Composing Callbacks</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/12/introduction-to-the-reactive-extensions-for-javascript-from-blocking-to-async.aspx">From Blocking to Async</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2010/03/15/introduction-to-the-reactive-extensions-for-javascript-wikipedia-lookup.aspx">Wikipedia Lookup</a>&#160; </li>
</ul>
<h2>Composing and Filtering</h2>
<p>As I stated earlier, the goal of this post was to take our piece of text, detect the language and then translate it to all other languages other than the detected.&#160; We’ll make use of the detect, getLanguages and translate methods as we’ve talked about earlier, but with some slight changes.&#160; Since the time I wrote these posts, the Microsoft Translator has released a new API for us to call which gets away from the JavaScript library approach and to the URL based approach instead.&#160; You can read more about <a href="http://msdn.microsoft.com/en-us/library/ff512423.aspx">the APIs</a> in their documentation.&#160; Let’s get started taking our old code and porting it to the new APIs.&#160; First, I’ll need the base URL and an AppID that you can apply for.&#160; And next, I’ll need to handle making an XmlHttpRequest, getting the value and then evaluating the response.&#160; Yes, I realize that eval might be used for malicious purposes, but in this case, this is simple text being returned.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">var</span><span style="color: #000000"> url </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&quot;</span><span style="color: #000000">http://api.microsofttranslator.com/V2/Ajax.svc/</span><span style="color: #000000">&quot;</span><span style="color: #000000">;
</span><span style="color: #0000ff">var</span><span style="color: #000000"> appId </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&quot;</span><span style="color: #000000">someappid</span><span style="color: #000000">&quot;</span><span style="color: #000000">;

</span><span style="color: #0000ff">function</span><span style="color: #000000"> getResponse(url) {
    </span><span style="color: #0000ff">return</span><span style="color: #000000"> Rx.Observable.XmlHttpRequest(url)
        .Select(</span><span style="color: #0000ff">function</span><span style="color: #000000">(result) {
            </span><span style="color: #0000ff">return</span><span style="color: #000000"> eval(result.responseText);
        });
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Now we can turn our attention once again to the getLanguages function which gives us all of the language codes that are currently supported by the Translator.&#160; To do this, we build up a URL for our request, send it to the getResponse function, and then project each language array of our observable sequence to an observable sequence, in this case our resulting array turned into an observable, and flattens the resulting observable sequences into one observable sequence.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">function</span><span style="color: #000000"> getLanguages() {
    </span><span style="color: #0000ff">var</span><span style="color: #000000"> serviceUrl </span><span style="color: #000000">=</span><span style="color: #000000"> url </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">GetLanguagesForTranslate?appId=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000">  appId;

    </span><span style="color: #0000ff">return</span><span style="color: #000000"> getResponse(serviceUrl)
        .SelectMany(</span><span style="color: #0000ff">function</span><span style="color: #000000">(result) {
            </span><span style="color: #0000ff">return</span><span style="color: #000000"> result.toObservable(); });
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Our detect follows the same pattern of building up a URL and gets the response from the XmlHttpRequest as an observable sequence. </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">function</span><span style="color: #000000"> detect(text) {

    </span><span style="color: #0000ff">var</span><span style="color: #000000"> serviceUrl </span><span style="color: #000000">=</span><span style="color: #000000"> url </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">Detect?AppId=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> appId </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">&amp;text=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> encodeURIComponent(text);

    </span><span style="color: #0000ff">return</span><span style="color: #000000"> getResponse(serviceUrl);
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>And translate follows the very same pattern as well. </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">function</span><span style="color: #000000"> translate(text, from, to) {

    </span><span style="color: #0000ff">var</span><span style="color: #000000"> serviceUrl </span><span style="color: #000000">=</span><span style="color: #000000"> url </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">Translate?appId=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000">  appId </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">&amp;from=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> from </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">&amp;to=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> to </span><span style="color: #000000">+</span><span style="color: #000000">
        </span><span style="color: #000000">&quot;</span><span style="color: #000000">&amp;text=</span><span style="color: #000000">&quot;</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> encodeURIComponent(text);

    </span><span style="color: #0000ff">return</span><span style="color: #000000"> getResponse(serviceUrl);
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>We’ll start first at creating a subscription for the translation button to listen for clicks:</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #000000">$(</span><span style="color: #000000">&quot;</span><span style="color: #000000">#translateCommand</span><span style="color: #000000">&quot;</span><span style="color: #000000">)
    .ToObservable(</span><span style="color: #000000">&quot;</span><span style="color: #000000">click</span><span style="color: #000000">&quot;</span><span style="color: #000000">)
    .Subscribe(</span><span style="color: #0000ff">function</span><span style="color: #000000">(event) {

    </span><span style="color: #008000">//</span><span style="color: #008000"> More stuff here</span><span style="color: #008000">
</span><span style="color: #000000">
});</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Inside of the Subscribe method, we need to clear out the last results as well as get the value of the text to be translated.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #000000">$(</span><span style="color: #000000">&quot;</span><span style="color: #000000">#translatedText</span><span style="color: #000000">&quot;</span><span style="color: #000000">).empty();
</span><span style="color: #0000ff">var</span><span style="color: #000000"> textTotranslate </span><span style="color: #000000">=</span><span style="color: #000000"> $(</span><span style="color: #000000">&quot;</span><span style="color: #000000">#translateText</span><span style="color: #000000">&quot;</span><span style="color: #000000">).val();</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Next, we need to add more code to do the actual translation.&#160; What we’re going to do is first detect the text and before we get to combining this with another function.&#160; </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">var</span><span style="color: #000000"> translator </span><span style="color: #000000">=</span><span style="color: #000000"> detect(textTotranslate)</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>I’m going to need to take the detected language and then translate it into all the other languages.&#160; In order to do that, I need to use the SelectMany method which lets you project our detected text to another observable sequence, which in this case will be the languages.&#160; </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #000000">.SelectMany(</span><span style="color: #0000ff">function</span><span style="color: #000000">(detectedLanguage) {
    </span><span style="color: #008000">//</span><span style="color: #008000"> Code goes here</span><span style="color: #008000">
</span><span style="color: #000000">});</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Once we get to the languages, we want to filter out the language that equals our detected language, and then once again, project our language to the translate method observable sequence.&#160; </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">return</span><span style="color: #000000"> getLanguages()
    .Where(</span><span style="color: #0000ff">function</span><span style="color: #000000">(language) { </span><span style="color: #0000ff">return</span><span style="color: #000000"> language </span><span style="color: #000000">!=</span><span style="color: #000000"> detectedLanguage; })</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>I’ll take the result of the translated text and then project to return an object with a translated property with our translated text, and the associated language property.&#160; </p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #000000">.SelectMany(</span><span style="color: #0000ff">function</span><span style="color: #000000">(language) {
     </span><span style="color: #0000ff">return</span><span style="color: #000000"> translate(translatedText, detectedLanguage, language)
        .Select(</span><span style="color: #0000ff">function</span><span style="color: #000000">(translatedText) {
            </span><span style="color: #0000ff">return</span><span style="color: #000000"> { translated : translatedText, language : language };
 });</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>All together, the code to take the piece of text, detect its language, and translate it into all other supported languages looks like the following.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent">
<pre style="background-color: #ffffff;overflow: auto"><span style="color: #0000ff">var</span><span style="color: #000000"> translator </span><span style="color: #000000">=</span><span style="color: #000000"> detect(textTotranslate)
    .SelectMany(</span><span style="color: #0000ff">function</span><span style="color: #000000">(detectedLanguage) {
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> getLanguages()
            .Where(</span><span style="color: #0000ff">function</span><span style="color: #000000">(language) { </span><span style="color: #0000ff">return</span><span style="color: #000000"> language </span><span style="color: #000000">!=</span><span style="color: #000000"> detectedLanguage; })
            .SelectMany(</span><span style="color: #0000ff">function</span><span style="color: #000000">(language) {
                </span><span style="color: #0000ff">return</span><span style="color: #000000"> translate(translatedText, detectedLanguage, language)
                    .Select(</span><span style="color: #0000ff">function</span><span style="color: #000000">(translatedText) {
                        </span><span style="color: #0000ff">return</span><span style="color: #000000"> { translated : translatedText, language : language };
                });
        });
});</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Then we could subscribe to this observable sequence and for example, take a sentence “Do you know what time it is?” and translate it into 29 other languages.</p>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/matthew.podwysocki/image_5F00_4AA99198.png"><img style="border-bottom: 0px;border-left: 0px;border-top: 0px;border-right: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/matthew/podwysocki/image_thumb_1B0B730C.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787602&amp;Signature=kqPXy5mEeM%2fWwS7JjOukkASPspw%3d" width="364" height="438" /></a> </p>
<p>What’s really interesting about this example is the true asynchronous behavior.&#160; If I press the button again with the same sentence, the order of their return is not always the same each and every time.&#160;&#160; </p>
<h2>Conclusion</h2>
<p>Through the use of the Reactive Extensions for JavaScript, we’ve been able to compose together asynchronous behavior of detecting a piece of text’s language, and translating it into 29 different languages all at once.&#160; This could apply to any number of scenarios where we need to compose together one asynchronous call after another, but only when certain things happen.&#160; And better yet, to use code in a fluent API style, you don’t have this logic scattered throughout all of your functions.</p>
<p>This of course is only scratching the surface of what capabilities this library has and there is much more yet left to cover.&#160; The question you’re probably asking now is where can I get it?&#160; Well, for that you’ll have to stay tuned to Erik Meijer and his <a href="http://live.visitmix.com/MIX10/Sessions/FTL01">Reactive Extensions for JavaScript</a> session at Mix on Wednesday.</p>
<p>What can I say?&#160; I love JavaScript and very much looking forward to the upcoming <a href="http://jsconf.us/2010">JSConf 2010</a> here in Washington, DC where the Reactive Extensions for JavaScript will be shown in its full glory with <a href="http://twitter.com/jvgogh">Jeffrey Van Gogh</a> (who you can now follow on Twitter).&#160; For too many times, we’ve looked for the abstractions over the natural language of the web (HTML, CSS and JavaScript) and created monstrosities instead of embracing the web for what it is.&#160; With libraries such as jQuery and indeed the Reactive Extensions for JavaScript gives us better tools for dealing with the troubled child that is DOM manipulation and especially events.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/matthewpodwysocki/category/event-based-porgramming/" title="View all posts in Event-based Porgramming" rel="category tag">Event-based Porgramming</a>, <a href="http://codebetter.com/matthewpodwysocki/category/javascript/" title="View all posts in JavaScript" rel="category tag">JavaScript</a>, <a href="http://codebetter.com/matthewpodwysocki/category/jsconf/" title="View all posts in JSConf" rel="category tag">JSConf</a>, <a href="http://codebetter.com/matthewpodwysocki/category/reactive-framework/" title="View all posts in Reactive Framework" rel="category tag">Reactive Framework</a>. Bookmark the <a href="http://codebetter.com/matthewpodwysocki/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper/" title="Permalink to Introduction to the Reactive Extensions for JavaScript – Composing deeper" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/matthewpodwysocki/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper/feed/" title="Comments RSS to Introduction to the Reactive Extensions for JavaScript – Composing deeper" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-210 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/matthewpodwysocki/2010/03/15/introduction-to-the-reactive-extensions-for-javascript-wikipedia-lookup/" rel="prev"><span class="meta-nav">&larr;</span> Introduction to the Reactive Extensions for JavaScript – Wikipedia Lookup</a></div>
					<div class="nav-next"><a href="http://codebetter.com/matthewpodwysocki/2010/03/17/the-reactive-extensions-for-javascript-released/" rel="next">The Reactive Extensions for JavaScript Released <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-498">
					<div id="dsq-comment-header-498" class="dsq-comment-header">
						<cite id="dsq-cite-498">
	http://www.servicestack.net/mythz_blog/							<span id="dsq-author-user-498">Demis Bellot</span>
							</cite>
					</div>
					<div id="dsq-comment-body-498" class="dsq-comment-body">
						<div id="dsq-comment-message-498" class="dsq-comment-message"><p>Does this code make an unnecessary network ajax call to &#8216;getLanguages()&#8217; everytime? If it does, it&#8217;s not a great idea to promote bad practices for the sake of a more elegant example as sooner or later we&#8217;re going to have to use this stuff in the real world.</p>
<p>Another problem I have is the number of nested callbacks that still needs to be done with an RxJs solution as I count 3 in the last example. </p>
<p>RxJs definitely has superior composability and can be more elegant at times but the concept and write-ability is still harder to grasp then with straight-forward async callbacks. </p>
<p>Anyway it&#8217;s still early days so I hope you guys have a lot more examples how we can Rx-ify our async web service calls. Specifically I have an async service that look something like: </p>
<p>function AsyncService(url)<br />
{<br />
  this.url = url;<br />
}<br />
AsyncService.prototype = {<br />
  getValue1  = function(input1, onSuccessFn, onErrorFn) {<br />
  },<br />
  getValue2  = function(input2, onSuccessFn, onErrorFn) {<br />
  }<br />
};</p>
<p>//So at the moment composing the results of 2 calls would look like:<br />
var asyncService = new AsyncService(&#8220;http://location/&#8221;);<br />
asyncService.getValue1(&#8220;1&#8243;, function(result1) {<br />
  asyncService.getValue2(result1, function(result2) {<br />
    alert(result2);<br />
  };<br />
});</p>
<p>It would be nice to know how I could Rx-ify my async service, i.e. what the boiler plate I would require look like. Also how the above example would look like in Rx?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-499">
					<div id="dsq-comment-header-499" class="dsq-comment-header">
						<cite id="dsq-cite-499">
	http://codebetter.com/members/Matthew.Podwysocki/default.aspx							<span id="dsq-author-user-499">Matthew.Podwysocki</span>
							</cite>
					</div>
					<div id="dsq-comment-body-499" class="dsq-comment-body">
						<div id="dsq-comment-message-499" class="dsq-comment-message"><p>@Demis,</p>
<p>Yes, I should move getLanguages() out and have it cached at this point, and that&#8217;s a good point because it&#8217;s an operation that should only happen once.  </p>
<p>I&#8217;m not sure I get the complaint about the nested callbacks.  After all, I need to chain together the transformations of taking one computation and creating another based upon it and to do that, you are providing projections which then get invoked on the OnNext call.</p>
<p>Now to answer your question in regards to your services to compose getValue1 and getValue2, you could use the following:</p>
<p>Now your ultimate goal for your webservices should be something like the following using RxJS:</p>
<p>asyncService.getValue1AsObservable(&#8220;1&#8243;)<br />
    .SelectMany(<br />
        function(result) {<br />
            return asyncService.getValue2AsObservable(result); })<br />
    .Subscribe(function(result) { alert(result); });</p>
<p>In the parlance of using LINQ expressions would be:</p>
<p>from result1 in asyncService.getValue1AsObservable(&#8220;1)<br />
 from result2 in asyncService.getValue2AsObservable(result1)<br />
select result2;</p>
<p>Alternatively, if you know each one is going to project one and only one value, you could use a Select/Switch, but SelectMany in this instance makes more sense.  But that would look like the following:</p>
<p>asyncService.getValue1AsObservable(&#8220;1&#8243;)<br />
    .Select(<br />
        function(result) {<br />
            return asyncService.getValue2AsObservable(result); })<br />
    .Switch()<br />
    .Subscribe(function(result) { alert(result); });</p>
<p>Now the question of how to wrap the services, you should use the AsyncSubject to return the value and handle the associated success and error cases:</p>
<p>asyncService.prototype.getValue1AsObservable = function(data) {<br />
    var subject = new Rx.AsyncSubject();</p>
<p>    var onNext = function(next) {<br />
        subject.OnNext(next);<br />
        subject.OnCompleted();<br />
    }</p>
<p>    var onError = function(err) {<br />
        subject.OnError(err);<br />
    }</p>
<p>    asyncService.getValue1(data, next, err);</p>
<p>    return subject;<br />
}</p>
<p>Hope that helps!  I should probably turn this into a post as well.</p>
<p>Matt</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-500">
					<div id="dsq-comment-header-500" class="dsq-comment-header">
						<cite id="dsq-cite-500">
	http://www.servicestack.net/mythz_blog/							<span id="dsq-author-user-500">Demis Bellot</span>
							</cite>
					</div>
					<div id="dsq-comment-body-500" class="dsq-comment-body">
						<div id="dsq-comment-message-500" class="dsq-comment-message"><p>Hey awesome response thanks!<br />
Exactly what I was looking for!</p>
<p>As for the nested callbacks comment, I only meant that I am looking into RxJs to try get out of &#8216;nested callback hell&#8217; with my API that is normal with Async JavaScript API&#8217;s. So on the face of it, RxJs didn&#8217;t look like much of an improvement in that area.</p>
<p>And to answer your last Q, yes you should turn this into a post <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> </p>
<p>- Demis</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/matthewpodwysocki/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper/ ';
	var disqus_identifier = '210 /blogs/matthew.podwysocki/archive/2010/03/16/introduction-to-the-reactive-extensions-for-javascript-composing-deeper.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'matthewpodwysocki';
	var disqus_title = "Introduction to the Reactive Extensions for JavaScript – Composing deeper";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=210');
		});
					};
	var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/matthewpodwysocki\/2010\/03\/16\/introduction-to-the-reactive-extensions-for-javascript-composing-deeper\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.250 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 13:48:14 -->
<!-- super cache -->