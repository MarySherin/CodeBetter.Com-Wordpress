<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Paging in a sql result set | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Peter van Ooijen' href='http://codebetter.com/petervanooijen/' />
<link rel='start' title='Hello weblog' href='http://codebetter.com/petervanooijen/2003/06/03/hello-weblog/' />
<link rel='prev' title='Formatting source code in a blog post (revisited)' href='http://codebetter.com/petervanooijen/2009/02/24/formatting-source-code-in-a-blog-post-revisited/' />
<link rel='next' title='The return of CopySourceAsHtml' href='http://codebetter.com/petervanooijen/2009/02/26/the-return-of-copysourceashtml/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/petervanooijen/2009/02/26/paging-in-a-sql-result-set/' />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=555' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetterpetergekkosblog/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-555" class="post-555 post type-post status-publish format-standard hentry category-data">
					<h1 class="entry-title">Paging in a sql result set</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2009/02/26/paging-in-a-sql-result-set/" title="9:28 am" rel="bookmark"><span class="entry-date">February 26, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>This post is based on <a href="http://davidhayden.com/blog/dave/archive/2005/12/30/2652.aspx">a post by fellow CB blogger Dave Hayden</a>.&#160; It deals with paging through a set of sql server data. Dave has a very clear and elegant solution but it did take some puzzling to find out why things have to be done that way. Dave’s solution steered towards a sproc. Trying to stay away from that I want to present a dynamic sql version of the same idea.</p>
<p>Since the 2005 version of MS SQL server has the <a href="http://msdn.microsoft.com/en-us/library/ms186734.aspx">ROW_NUMBER</a> function. This function returns the sequence number of the result set rows. Like this select statement.</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT Id, Name, ROW_NUMBER() OVER (ORDER BY Name) AS Row FROM Fleet</p>
</p></div>
<p>The OVER part determines the sort order of the result set.</p>
<p> This row number is an ideal base for retrieving data in pages. With a page size of 20 the first page will contain row numbers 1 to 21, the second 21 to 40, etc. Alas you cannot use the function result directly in the where clause. To retrieve the first page this sql will not work. </p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT Id, Name, ROW_NUMBER() OVER (ORDER BY Name) AS Row FROM Fleet WHERE ROW &lt; 21 </p>
</p></div>
<p><!--EndFragment-->To get around this you need an outer select to wrap up. Like this:</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT Id, Name FROM </p>
<p style="margin: 0px">(SELECT Id, Name, ROW_NUMBER() OVER (ORDER BY Name) AS Row FROM Fleet) AS tmp </p>
<p style="margin: 0px">WHERE ROW &lt; 21 </p>
</p></div>
<p><!--EndFragment-->There is a pattern in this</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT&#160; <strong>MyCols</strong> FROM</p>
<p style="margin: 0px">(SELECT <strong>MyCols</strong>, ROW_NUMBER() OVER (ORDER BY <strong>MyOrder</strong>) AS Row FROM <strong>MyView</strong>) AS tmp</p>
<p style="margin: 0px">WHERE ROW &lt; <strong>MaxRow</strong></p>
</p></div>
<p><!--EndFragment-->   <br /></font></font>The values for the example query I started with</p>
</p>
<p>MyCols=”Id, Name”</p>
<p>MyView=”Fleet”</p>
<p>MyOrder=”Name”</p>
<p>&#160;</p>
<p>In a more complex scenario the data will be a view on several tables resulting in one result set. Here the list of columns for the result set will not match the list of columns in the view.</p>
<p>Take this query.</p>
<p> <font size="2"><font color="#000000">
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT&#160; Name,Id, City FROM </p>
<p style="margin: 0px">(SELECT Person.Name,Person.Id, City.City , ROW_NUMBER() OVER (ORDER BY Name) AS Row FROM Persons INNER JOIN City On Person.CityId=City.ID) AS tmp&#160; </p>
<p style="margin: 0px">WHERE ROW &lt; 21</p>
</p></div>
<p><!--EndFragment--></p>
</p>
<p> The pattern now evolves to</font><font size="2"><font color="#000000"></font>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT&#160; <strong>MyCols</strong> FROM </p>
<p style="margin: 0px">(SELECT <strong>MyViewCols</strong>, ROW_NUMBER() OVER (ORDER BY <strong>MyOrder</strong>) AS Row FROM <strong>MyView</strong>) AS tmp&#160; </p>
<p style="margin: 0px">WHERE ROW &lt; MaxRow</p>
</p></div>
<p><!--EndFragment--></p>
<p>   </font>The values for the last query </font>
<p>MyCols=”Name, Id, City”</p>
<p>MyViewCols=”<font size="3">Person.Name,Person.Id, City.City </font>”</p>
<p>MyView=”<font size="3">Persons INNER JOIN City On Person.CityId=City.ID</font>”</p>
<p>MyOrder=”Name”</p>
<p>&#160;</p>
<p>To complete the pattern I have to fully parameterize the row numbers. Here I also limit the inner query with a SELECT TOP, no need to retrieve more rows than maxrow.</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px">SELECT <strong>MyCols</strong> FROM </p>
<p style="margin: 0px">(SELECT TOP <strong>MaxRow </strong>ROW_NUMBER OVER (ORDER BY&#160; <strong>MyOrder </strong>) AS Row, <strong>MyViewCols</strong> FROM <strong>MyView</strong>)&#160; AS Tmp </p>
<p style="margin: 0px">WHERE Row &gt; @MinRow AND Row &lt;= @MaxRow</p>
</p></div>
<p><!--EndFragment--> It is cumbersome to assemble this query over and over again.&#160; Having to do all sql myself (more on that in a later post) I have built a small C# function which will assemble the paging query from the fragments passed in. It uses the pattern described,&#160; builds a sqlCommand and is used like this. </p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">const</span> <span style="color: blue">string</span> columns = <span style="color: #a31515">&quot;Code, ExpireDate, Description&quot;</span>;</p>
<p style="margin: 0px"><span style="color: blue">const</span> <span style="color: blue">string</span> view = <span style="color: #a31515">&quot;Permit INNER JOIN ProductCell ON Permit.Code = ProductCell.Code WHERE Permit.LicenceId=@LicenceId&quot;</span>;</p>
<p style="margin: 0px"><span style="color: blue">const</span> <span style="color: blue">string</span> orderBy = <span style="color: #a31515">&quot;Permit.Code&quot;</span>;</p>
<p style="margin: 0px"><span style="color: blue">const</span> <span style="color: blue">string</span> viewColumns = <span style="color: #a31515">&quot;Permit.Code, ExpireDate, Description&quot;</span>;</p>
<p style="margin: 0px"><span style="color: blue">var</span> cmd = BuildPagedSelectCommand(pageNo, columns, view, orderBy, viewColumns, pageSize);</p>
<p style="margin: 0px">cmd.Parameters.AddWithValue(<span style="color: #a31515">&quot;@LicenceId&quot;</span>, licenceId);</p>
</p></div>
<p> <!--EndFragment-->
<p>&#160;</p>
<p><font size="4"></font></p>
<p>The function itself is pretty straightforward</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new"><span style="color: blue">
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">protected</span> <span style="color: #2b91af">SqlCommand</span> BuildPagedSelectCommand(<span style="color: blue">int</span> pageNumber, <span style="color: blue">string</span> columnList, <span style="color: blue">string</span> selectFrom, <span style="color: blue">string</span> orderBy, <span style="color: blue">string</span> columnsAs, <span style="color: blue">int</span> pageSize)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> minRow = (pageNumber &#8211; 1) * pageSize;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> maxRow = minRow + pageSize;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> cmd = <span style="color: blue">new</span> <span style="color: #2b91af">SqlCommand</span>(<span style="color: blue">string</span>.Format(<span style="color: #a31515">&quot;SELECT {0} FROM (SELECT TOP {1} ROW_NUMBER() OVER (ORDER BY {2}) AS Row,{3} FROM {4}) AS tmp WHERE Row &gt; @MinRow AND Row &lt;= @MaxRow&quot;</span>,</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; columnList, maxRow, orderBy, columnsAs, selectFrom), connection);</p>
<p style="margin: 0px">&#160;&#160;&#160; cmd.Parameters.AddWithValue(<span style="color: #a31515">&quot;@MinRow&quot;</span>, minRow);</p>
<p style="margin: 0px">&#160;&#160;&#160; cmd.Parameters.AddWithValue(<span style="color: #a31515">&quot;@MaxRow&quot;</span>, maxRow);</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">return</span> cmd;</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment--></span><!--EndFragment--></div>
<p> All it does is calculate the rownumbers, assemble the sql statement and create the sql command to return. </p>
<p>For the simpler cases where the result columns match the underlying view columns I have created an overload.</p>
<div style="font-size: 12pt;background: white;color: black;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">protected</span> <span style="color: #2b91af">SqlCommand</span> BuildPagedSelectCommand(<span style="color: blue">int</span> pageNumber, <span style="color: blue">string</span> columnList, <span style="color: blue">string</span> selectFrom, <span style="color: blue">string</span> orderBy, <span style="color: blue">int</span> pageSize)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">return</span> BuildPagedSelectCommand(pageNumber, columnList, selectFrom, orderBy, columnList, pageSize);</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>It uses the original overload using the columnlist twice.</p>
<p>Paging data is not that complicated but the syntax of the query required is somewhat confusing. I hope this example helps in clarifying it.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/data/" title="View all posts in Data" rel="category tag">Data</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2009/02/26/paging-in-a-sql-result-set/" title="Permalink to Paging in a sql result set" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2009/02/26/paging-in-a-sql-result-set/feed/" title="Comments RSS to Paging in a sql result set" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-555 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2009/02/24/formatting-source-code-in-a-blog-post-revisited/" rel="prev"><span class="meta-nav">&larr;</span> Formatting source code in a blog post (revisited)</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2009/02/26/the-return-of-copysourceashtml/" rel="next">The return of CopySourceAsHtml <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-2709">
					<div id="dsq-comment-header-2709" class="dsq-comment-header">
						<cite id="dsq-cite-2709">
	http://damieng.com							<span id="dsq-author-user-2709">Damien Guard</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2709" class="dsq-comment-body">
						<div id="dsq-comment-message-2709" class="dsq-comment-message"><p>You also want to ensure that you order by something unique not just something like name otherwise it&#8217;s quite possible that items on page 1 will appear again on page 2 as the query plan takes a different route that results in items expected on page 2 being considered page 1.</p>
<p>Remember item sequence is not guaranteed beyond what is specified in order by and this is especially important in paging.</p>
<p>[)amien</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2710">
					<div id="dsq-comment-header-2710" class="dsq-comment-header">
						<cite id="dsq-cite-2710">
	http://petersgekko.codebetter.com							<span id="dsq-author-user-2710">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2710" class="dsq-comment-body">
						<div id="dsq-comment-message-2710" class="dsq-comment-message"><p>Good point. But as the query is parameterized I don&#8217;t expect a different, or even new, query plan.</p>
<p>It will get rough when the underlying data changes between pages. What if person 1 inserts/deletes data which results in a changed number of rows on page 1 and person 2 pages from page 2 to page 3&#8230; Etc..</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2711">
					<div id="dsq-comment-header-2711" class="dsq-comment-header">
						<cite id="dsq-cite-2711">
	http://weblogs.asp.net/bdill							<span id="dsq-author-user-2711">Ben</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2711" class="dsq-comment-body">
						<div id="dsq-comment-message-2711" class="dsq-comment-message"><p>Nice post, thank you.</p>
<p>@pvanooijen<br />
The execution plan can still get you.  If the code is running inside a clustered environment, you could see different results between servers&#8230;</p>
<p>On top of that/instead of, you&#8217;re still facing recompiling execution plans.  Any of which could introduce inconsistent results.</p>
<p>What I haven&#8217;t seen is a performance analysis of the row_number function.  The example is very basic, its a 1:1 paging of a table.  Typically you&#8217;ll see filtering in a paged result set.  Is SQL able to use hints when executing a run_number function, or must the entire result set be examined to return the firs page of data?  The latter could come at a heafty price in terms of performance.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2712">
					<div id="dsq-comment-header-2712" class="dsq-comment-header">
						<cite id="dsq-cite-2712">
								<span id="dsq-author-user-2712">fschwiet</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2712" class="dsq-comment-body">
						<div id="dsq-comment-message-2712" class="dsq-comment-message"><p>If you&#8217;re using LINQ to SQL with the Skip(n) and Take(n) operators, I&#8217;ve found it will generate queries using row number as you suggested.</p>
<p>Pretty sweet!  I always wondered how this was done.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2713">
					<div id="dsq-comment-header-2713" class="dsq-comment-header">
						<cite id="dsq-cite-2713">
								<span id="dsq-author-user-2713">Andrew</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2713" class="dsq-comment-body">
						<div id="dsq-comment-message-2713" class="dsq-comment-message"><p>Can I get a limit and an offset <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />   Heck no, but at least this works&#8230; 10x as complicated and hard to read as it should be.  There has to be a better way to do this.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2714">
					<div id="dsq-comment-header-2714" class="dsq-comment-header">
						<cite id="dsq-cite-2714">
								<span id="dsq-author-user-2714">Eric T.</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2714" class="dsq-comment-body">
						<div id="dsq-comment-message-2714" class="dsq-comment-message"><p>Perhaps I&#8217;m being overly paranoid, but is there not a danger of SQL injection in the method you created (BuildPagedSelectCommand)?</p>
<p>I understand that you don&#8217;t have to expose this method publicly, but now you have to remember that any time you call it you have to be aware of the values that you are passing in.</p>
<p>Maybe it&#8217;s not an issue today because you&#8217;re just using the method in a very specific instance.  But in a few months you might not remember.  It gets even worse when you&#8217;re sharing this with a team &#8211; not everyone is going to take the time to check what&#8217;s going on inside the method and who knows what might be passed in.</p>
<p>I realize the point of the article was about paging and the ROW_NUMBER function so maybe my remarks are off topic, but then why bother abstracting the SQL statement into a method?</p>
<p>You did mention you have more to say about building the SQL in a later post, so if you&#8217;re planning something that will better handle SQL injection problems please ignore this.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2715">
					<div id="dsq-comment-header-2715" class="dsq-comment-header">
						<cite id="dsq-cite-2715">
	http://petersgekko.codebetter.com							<span id="dsq-author-user-2715">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2715" class="dsq-comment-body">
						<div id="dsq-comment-message-2715" class="dsq-comment-message"><p>@Ben. Right, that makes perfectly sense. I havn&#8217;t timed performance but we are using thise code for paging through pretty big result sets. Actually the code was needed because the pages were faaaar to big.. Anyway, paging is smooth and sweet</p>
<p>@Andrew. I&#8217;m not quite sure what you are pointing at. There is a limit in the TOP x. But you still have to read in all pages which precede the desired one. So there is no offset.</p>
<p>@Eric. This is clearly not a method to expose publicly, just a helper to be use inside a repository. Notice the protected visibillity.<br />
Having to do all sql by hand is a pita. When the queries get really hairy, like these paging things, the method makes the code easier to read. And it saves me from calculating and setting page and rownumbers over and over again.<br />
I will get back on having to do the sql by hand (instead of using an O/R mapper) in the promissed later post.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2716">
					<div id="dsq-comment-header-2716" class="dsq-comment-header">
						<cite id="dsq-cite-2716">
								<span id="dsq-author-user-2716">karl</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2716" class="dsq-comment-body">
						<div id="dsq-comment-message-2716" class="dsq-comment-message"><p>The SQL Server&#8217;s team inability to add a simple syntax for this is disheartening.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2717">
					<div id="dsq-comment-header-2717" class="dsq-comment-header">
						<cite id="dsq-cite-2717">
								<span id="dsq-author-user-2717">itzik shmulewitz</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2717" class="dsq-comment-body">
						<div id="dsq-comment-message-2717" class="dsq-comment-message"><p>the problem using this method is that if you use order by a field which is not indexed or even calculated in query time the query will still sort the whole query and will not tryjust to find the top x rows. this problem is still solvable by using CLR aggregate function to create a binary field containing only the relevant ids but in sql 2005 there is a memory limit of 8K to a CLR aggregate function ( changed in sql 2008) so in string and in the 2000 row this method will not work (in case you are sorting by an int type) but it is still usefull.</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/petervanooijen/2009/02/26/paging-in-a-sql-result-set/ ';
	var disqus_identifier = '555 /blogs/peter.van.ooijen/archive/2009/02/26/paging-in-a-sql-result-set.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetterpetergekkosblog';
	var disqus_title = "Paging in a sql result set";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=555');
		});
					};
	var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2009\/02\/26\/paging-in-a-sql-result-set\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='67 topics' style='font-size: 16.3151515152pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.4848484848pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.2121212121pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='45 topics' style='font-size: 14.8727272727pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.5454545455pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='13 topics' style='font-size: 10.5454545455pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.5454545455pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.8727272727pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='318 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.7515151515pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2011/01/31/c-for-the-iphone-monotouch-is-here-to-stay/" title="C# for the iPhone: Monotouch is here to stay">C# for the iPhone: Monotouch is here to stay</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/12/28/seasons-gifts-from-the-monotouch-iphone-treasure-chest-background-gps-tasks-and-uicontrol/" title="Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl">Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/11/05/kalifescope-and-monotouch-from-idea-to-the-appstore/" title="Kalifescope and Monotouch, from idea to the AppStore">Kalifescope and Monotouch, from idea to the AppStore</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/10/28/monotouch-your-c-app-on-a-real-iphone/" title="Monotouch: your C# app on a real iPhone">Monotouch: your C# app on a real iPhone</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/09/28/monotouch-drawing-an-image-pixel-by-pixel/" title="Monotouch: drawing an image pixel by pixel">Monotouch: drawing an image pixel by pixel</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2011/01/' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.274 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 14:18:48 -->
<!-- super cache -->