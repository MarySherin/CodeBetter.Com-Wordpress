<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Test Driven Development with ASP.Net and the Model View Presenter Pattern | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/jeremymiller/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/jeremymiller/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/jeremymiller/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Jeremy D. Miller' href='http://codebetter.com/jeremymiller/' />
<link rel='start' title='Bypass VSTS and get yourself a &quot;Poor Man&#8217;s IntelliJ&quot;' href='http://codebetter.com/jeremymiller/2005/04/12/bypass-vsts-and-get-yourself-a-poor-mans-intellij/' />
<link rel='prev' title='I thought you said NOT to cross the streams!' href='http://codebetter.com/jeremymiller/2006/02/01/i-thought-you-said-not-to-cross-the-streams/' />
<link rel='next' title='OO, TDD, and Agile processes are all good, but better get the basic things right too' href='http://codebetter.com/jeremymiller/2006/02/08/oo-tdd-and-agile-processes-are-all-good-but-better-get-the-basic-things-right-too/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/jeremymiller/2006/02/02/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern/' />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=126' />
<link rel="stylesheet" href="http://codebetter.com/jeremymiller/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/theshadetreedeveloper/disqus.css?v=2.0" type="text/css" media="screen" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/jeremymiller/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-126" class="post-126 post type-post status-publish format-standard hentry category-design-patterns category-test-driven-development">
					<h1 class="entry-title">Test Driven Development with ASP.Net and the Model View Presenter Pattern</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2006/02/02/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern/" title="3:14 am" rel="bookmark"><span class="entry-date">February 2, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/jeremymiller/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p class="MsoNormal" style="margin: 0in 0in 0pt"><b>DISCLAIMER:&nbsp; This was written all the way&nbsp;back in Feb. 2006 when we thought that MVP with ASP.NET was the only real alternative for somewhat testable web user interfaces.&nbsp;&nbsp;I thank you for the interest, but there have been better articles written since, and I&#8217;d&nbsp;strongly recommend looking at MonoRail or&nbsp;Ruby on Rails or the new MVC framework for ASP.NET if you&#8217;re interested in maintainable, testable&nbsp;web applications. Let me make this even clearer, I think the technique in this article is one giant, smelly hack.&nbsp; The only adequate solution is to dump WebForms, or convince yourself that TDD, Testability, and Separation of Concerns is meaningless&nbsp;<br />
</b></p>
<p><b></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">A friend of mine was asking me a while back about ways to apply the Model View Presenter (the “Humble Dialog Box”) pattern to ASP.Net development to promote easier unit testing of the user interface layer.<span>&nbsp; </span>Two weeks and a major case of writer’s block later, I finally finished the post.<span>&nbsp; </span>I wrote a blog post last spring describing the usage of <a href="/blogs/jeremy.miller/articles/129546.aspx">MVP (“The Humble Dialog Box”) with WinForms</a> clients, but web development in general and ASP.Net in specific comes with a different set of challenges.<span>&nbsp; </span></p>
<p>&nbsp;<b>So what are the problems with ASP.Net that MVP Solves?</b><b>&nbsp;</b> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">If you asked me to name the single most important principle in all of software design, regardless of language, platform, or programming paradigm, I’d say “<a href="/blogs/jeremy.miller/articles/129542.aspx">Separation of Concerns</a>” in a heartbeat.<span>&nbsp; </span>For the sake of maintainability, each piece of code should have one and only one distinct responsibility.<span>&nbsp; </span>Even in the initial act of coding I only want to work on one problem at a time.<span>&nbsp; </span>I want to look at the business logic code without seeing database infrastructure code or HTML construction intermingled with everything else (a huge pet peeve of mine).<span>&nbsp; </span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The traditional approach for building maintainable user interface code is to separate the typical concerns of a user interface with the <a href="http://ootips.org/mvc-pattern.html">Model View Controller</a> (MVC) pattern.<span>&nbsp; </span>Unfortunately, ASP.Net is optimized for <a href="http://memeagora.blogspot.com/2005/08/technology-snake-oil-part-2-rad.html">Rapid Application Development,</a> not for creating maintainable code.<span>&nbsp; </span>A common criticism of the ASP.Net development model (and ASP classic before that) is that it does not enforce or even encourage a clean Model View Controller separation.<span>&nbsp; </span>Many ASP.Net applications seem to be a jumble of data access code, HTML markup, and business logic, but it doesn’t have to be that way.<span>&nbsp; </span>By itself, the “code-behind” model in ASP.Net does not do enough to create a good separation of concerns.<span>&nbsp; </span>Plus it’s difficult to get code-behind code into unit tests.<span>&nbsp; </span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">My preference is to use the <a href="http://www.martinfowler.com/eaaDev/ModelViewPresenter.html">Model View Presenter</a> pattern to structure ASP.Net code to create maintainable and testable solutions.<span>&nbsp; </span>I think of MVP as just a flavor of MVC, but it’s worth stating the differences.<span>&nbsp; </span>The central fact of MVP architectures is that the “view” is a very shallow wrapper around the actual screen.<span>&nbsp; </span>Unlike most traditional MVC implementations, the view classes are entirely passive.<span>&nbsp; </span>The Presenter classes are the active classes that are responsible for initiating the view processing.<span>&nbsp; </span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The big challenge in unit testing ASP.Net code is the tight coupling to the ASP.Net runtime.<span>&nbsp; </span>The web controls are very tightly bound to the underlying HttpContext and the web event pipeline, making the user interface code difficult to work with inside an xUnit test harness.<span>&nbsp; </span>I’ve seen people successfully create fake HttpContext objects in memory, but it really amounts to a hack to test existing legacy ASP.Net code.<span>&nbsp; </span>You can also use tools like NUnitASP or Selenium to test web applications, but those tests are integration tests, not unit tests.<span>&nbsp; </span>The best thing to do in my experience is to isolate as much of the functionality as possible away from the ASP.Net runtime into classes that can be easily tested inside of NUnit, and that’s exactly what the MVP pattern does.<span>&nbsp; </span>Putting this another way, I would suggest that any piece of code that isn’t directly manipulating web controls or parts of the web page should be moved out of the code behind classes and into another class.</p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">A lot of .Net literature describes the “Code-Behind” class as the MVC controller.<span>&nbsp; </span>I think this is dead wrong.<span>&nbsp; </span><b>The code-behind is View code, period</b>.<span>&nbsp; </span>For best results, the presenter should never have any reference to any type in the <span style="font-family: 'Courier New'">System.Web</span> namespace.<span>&nbsp; </span></p>
<p>&nbsp;<b>Class Structure of MVP</b>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The basic concept is simple.<span>&nbsp; </span>Like the classic Model View Controller pattern, you divide the responsibilities of the web page into separate classes.<span>&nbsp; </span>In specific, we want to isolate as much of the functionality as possible away from the ASP.Net runtimes.<span>&nbsp; </span>The functionality of a screen is divided into three parts:</p>
<p>&nbsp; </p>
<ul style="margin-top: 0in" type="disc">
<li class="MsoNormal">View classes:<span>&nbsp; </span>Displays data and relays user input and events to the Presenter.<span>&nbsp; </span></li>
<li class="MsoNormal">Presenter classes:<span>&nbsp; </span>Coordinates communication between the view and the backend service or business layer and is responsible for user interface logic</li>
<li class="MsoNormal">Model classes:<span>&nbsp; </span>The data being displayed or worked on in the screen.<span>&nbsp; </span>This is could be either a business domain object(s), a data transfer object, or a lowly DataSet.<span>&nbsp; </span>The Model is also the state of the user session.<span>&nbsp; </span></li>
</ul>
<p>&nbsp;<b>A Simple Example</b><b>&nbsp;</b> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">Let’s dive into some code.<span>&nbsp; </span>You’re creating a new web screen in a custom workflow application for people to enter and assign “WorkItem’s” to other people.<span>&nbsp; </span>The screen will have dropdown lists for both the WorkItem category and the assigned user.<span>&nbsp; </span>In no particular order, let’s start with the Model class.</p>
<p>&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> WorkItem</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">string</span> _category;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">string</span> _assignedTo;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span> Category</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span> { <span style="color: blue">return</span> _category; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span> { _category = <span style="color: blue">value</span>; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span> AssignedTo</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span> { <span style="color: blue">return</span> _assignedTo; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span> { _assignedTo = <span style="color: blue">value</span>; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;color: green;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* Other stuff */</span><span style="font-size: 10pt;font-family: 'Courier New'"></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The next step is to create an abstracted interface to represent the View class.<span>&nbsp; </span>Note that we’re not yet working with any <span style="font-family: 'Courier New'">System.Web</span> classes, web pages, or web controls.<span>&nbsp; </span>The <span style="font-family: 'Courier New'">IWorkItemView</span> interface encapsulates all interaction with the ASP.Net runtime.</p>
<p>&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Abstracted interface of the WorkItem View screen</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">interface</span> IWorkItemView</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Packs the user input into a new WorkItem class</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WorkItem WorkItem{<span style="color: blue">get</span>;}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Sets the values in the dropdown list for the WorkItem assigned to user</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] AssignmentList {<span style="color: blue">set</span>;}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Sets the values in the dropdown list for the WorkItem categories</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] CategoryList {<span style="color: blue">set</span>;}</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The backend business and workflow system is accessed by a Façade class with an interface called <span style="font-size: 10pt;font-family: 'Courier New'">IWorkItemService.<span>&nbsp; </span></span>The backend might be a call to a web service, a remoted object, or an in-process call.<span>&nbsp; </span>All we’re concerned with in the user interface code is how the presenter interacts with the interface of the service.<span>&nbsp; </span></p>
<p>&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">interface</span> IWorkItemService</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span> ProcessWorkItem(WorkItem entry);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] GetAssignmentListForCategory(<span style="color: blue">string</span> category);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] GetCategoriesForRoles(<span style="color: blue">string</span>[] roles);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The lynchpin of the MVP pattern is the Presenter class, <span style="font-family: 'Courier New'">WorkItemPresenter</span>.<span>&nbsp; </span>In this particular user story there is a requirement that the categories displayed in the dropdown on the screen are limited by the role membership of the logged in user.<span>&nbsp; </span>There is another requirement that the values in the dropdown for the assigned to user are dependent upon the selected category.<span>&nbsp; </span>The logic that determines the topic and category list is completely isolated from the web page machinery for easier unit testing and maintainability.</p>
<p><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> WorkItemPresenter</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">readonly</span> IWorkItemView _view;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">readonly</span> IWorkItemService _service;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Use &#8220;Dependency Injection&#8221; to attach the dependencies for the view</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// and service.</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> WorkItemPresenter(IWorkItemView view, IWorkItemService service)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view = view;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_service = service;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> Initialize()</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] categoryList = <span style="color: blue">this</span>.determineCategoryListFromUserRoles();</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.CategoryList = categoryList;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> Submit()</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WorkItem item = _view.WorkItem;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_service.ProcessWorkItem(item);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> ChangeCategory(<span style="color: blue">string</span> categoryName)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span>[] assignmentList = _service.GetAssignmentListForCategory(categoryName);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.AssignmentList = assignmentList;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span>[] determineCategoryListFromUserRoles()</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// Examine the roles on the IPrincipal object and query IWorkItemService for<span>&nbsp; </span></span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// the possible categories </span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">return</span> <span style="color: blue">new</span> <span style="color: blue">string</span>[0];</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><b>&nbsp;</b> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">The key things to note here are that the <span style="font-family: 'Courier New'">WorkItemPresenter</span> class only depends on the abstracted interfaces for <span style="font-family: 'Courier New'">IWorkItemView</span> and <span style="font-family: 'Courier New'">IWorkItemService</span>.<span>&nbsp; </span>The <span style="font-family: 'Courier New'">WorkItemPresenter</span> class can now be unit tested with mock objects inside of the NUnit.<span>&nbsp; </span><span style="font-family: 'Courier New'">WorkItemPresenter</span> is just a “Plain Old CLR Object” that can run and be tested completely outside of the ASP.Net process.<span>&nbsp; </span>This is strictly personal preference, but I like to build and unit test the Presenter class(es) before I even start to create the ASPX or ASCX’s.<span>&nbsp; </span></p>
<p>&nbsp;&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[TestFixture]</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> WorkItemPresenterTester</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> DynamicMock _serviceMock;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> DynamicMock _viewMock;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> WorkItemPresenter _presenter;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[SetUp]</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> SetUp()</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_serviceMock = <span style="color: blue">new</span> DynamicMock(<span style="color: blue">typeof</span>(IWorkItemService));</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_viewMock = <span style="color: blue">new</span> DynamicMock(<span style="color: blue">typeof</span>(IWorkItemView));</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_presenter = <span style="color: blue">new</span> WorkItemPresenter((IWorkItemView)_viewMock.MockInstance, (IWorkItemService)_serviceMock.MockInstance);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><b>&nbsp;</b> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">Lastly, we’ve got to actually create the web page itself.<span>&nbsp; </span>I’m using a UserControl as an example, but it could easily be a web page instead.<span>&nbsp; </span>The <span style="font-family: 'Courier New'">WorkItemView</span> UserControl implements the <span style="font-family: 'Courier New'">IWorkItemView</span> interface.<span>&nbsp; </span>It has a reference to an instance of the <span style="font-family: 'Courier New'">WorkItemPresenter</span> class with which it communicates.</p>
<p>&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> WorkEntryView : UserControl, IWorkItemView</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> WorkItemPresenter _presenter;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">protected</span> DropDownList assignmentDropdown;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">protected</span> DropDownList categoryDropdown;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// The UserControl has a reference to the presenter class</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> AttachPresenter(WorkItemPresenter presenter)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_presenter = presenter;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">void</span> Page_Load(<span style="color: blue">object</span> sender, EventArgs e)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>categoryDropdown.SelectedIndexChanged += <span style="color: blue">new</span> EventHandler(categoryDropdown_SelectedIndexChanged);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;color: blue;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#region</span><span style="font-size: 10pt;font-family: 'Courier New'"> Web Form Designer generated code</span><span style="font-size: 10pt;color: blue;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> WorkItem WorkItem {…}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: gray">///</span><span style="color: green"> </span><span style="color: gray">&lt;summary&gt;</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: gray">///</span><span style="color: green"> Fill the dropdown list for the possible assignments</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: gray">///</span><span style="color: green"> </span><span style="color: gray">&lt;/summary&gt;</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span>[] AssignmentList</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>assignmentDropdown.Items.Clear();</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">foreach</span> (<span style="color: blue">string</span> assignment <span style="color: blue">in</span> <span style="color: blue">value</span>)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>assignmentDropdown.Items.Add(assignment);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span>[] CategoryList{…}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// The UserControl immediately relays the user selecting a new Category to the </span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">// presenter object.<span>&nbsp; </span>The presenter will decide what to do next</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">void</span> categoryDropdown_SelectedIndexChanged(<span style="color: blue">object</span> sender, EventArgs e)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span> category = categoryDropdown.SelectedValue;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_presenter.ChangeCategory(category);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">In this case I have an ASPX page that contains a <span style="font-family: 'Courier New'">WorkItemView</span> control.<span>&nbsp; </span>In the Page_Load event of the ASPX page I create a new instance of the <span style="font-family: 'Courier New'">WorkItemPresenter</span>, attach it to the user control, and call <span style="font-family: 'Courier New'">Initialize()</span> on the presenter class to start the display.</p>
<p>&nbsp;<span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> WorkItemPage : System.Web.UI.Page</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">protected</span> WorkEntryView workEntryControl;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">void</span> Page_Load(<span style="color: blue">object</span> sender, System.EventArgs e)</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WorkItemPresenter presenter = <span style="color: blue">new</span> WorkItemPresenter(workEntryControl);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>workEntryControl.AttachPresenter(presenter);</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>presenter.Initialize();</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><b>&nbsp;</b><b>State Management</b><b>&nbsp;</b> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">A big challenge in any complex web application is session state.<span>&nbsp; </span>Think of a typical online store like Amazon.<span>&nbsp; </span>On one hand the logic involved in maintaining the session state is important and certainly deserving of isolated unit tests.<span>&nbsp; </span>If I was coding for Amazon, I would certainly want to be writing unit tests around maintaining the state of the “shopping cart” when users select and remove items.<span>&nbsp; </span>The state of the shopping cart will affect the way the page is displayed and the navigation logic after the page.<span>&nbsp; </span>That’s exactly the kind of logic that is hard to test if you don’t loosely couple the logic from the HttpContext.<span>&nbsp; </span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">On the other hand, a lot of web screens are only reachable from a series of user actions on previous pages.<span>&nbsp; </span>The checkout screen can only be reached after working through previous screens.<span>&nbsp; </span>My first TDD project was an ASP.Net project that had some web pages like this.<span>&nbsp; </span>We were using NUnitASP to write automated tests.<span>&nbsp; </span>I didn’t know much about mock objects or MVP (or MVC), so the only way to test my pages and all of their logic was to write tests that progressed through multiple screens just to get to the point where I really wanted to test.<span>&nbsp; </span>Those tests were laborious to write and very brittle.<span>&nbsp; </span>Smaller tests are always easier to write <b>and</b> read.<span>&nbsp; </span>What I’ve learned since then is to either create an abstraction around the state management that the presenter classes depend on, or have another class push the state into the presenter.<span>&nbsp; </span>I touched on this strategy in an <a href="/blogs/jeremy.miller/archive/2006/01/10/136407.aspx">earlier post on mock objects</a>.</p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">At some point you do have to test the actual web screens, and it’s a great thing to have automated testing on the user interfaces.<span>&nbsp; </span>It’s just a theory, but I’d think seriously about creating intermediate integration tests that use stubs for all the backend and state management to isolate the web views.<span>&nbsp; </span>You can use a dynamic service locator like <a href="http://structuremap.sourceforge.net/">StructureMap</a> to substitute stubs for the services with configuration, or create separate ASPX pages to host the UserControl’s and presenter classes, but use the stub objects instead.<span>&nbsp; </span>You could then write much simpler Selenium tests to verify granular parts of the user interface in isolation.<span>&nbsp; </span>You’ve got to maintain loose coupling between the user interface code and the backend to pull it off though.<span>&nbsp; </span>As usual, testability and good design practices are very closely aligned.</p>
<p>&nbsp;<b>User Input Validation</b>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">I’ve had a couple of conversations over the last year on the proper place for the user input validation.<span>&nbsp; </span>I still think you have to take advantage of the built in validation controls in the ASP.Net views if you can do it in a declarative way.<span>&nbsp; </span>Any kind of validation more complicated than “this field is required” or numeric validation should probably be put into some sort of presenter class or the model classes.<span>&nbsp;&nbsp; </span>By and large, you want any kind of code that spawns bugs under automated unit testing.<span>&nbsp; </span>Input validation definitely meets that criterion.<span>&nbsp; </span></p>
<p>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">Something I like to do is use what I think of as “Embedded Controllers.”<span>&nbsp; </span>You need to be cautious in using the MVP pattern to keep the presenter classes from getting too big with too many responsibilities and preventing the bidirectional view-presenter communication from being way too chatty.<span>&nbsp; </span>I try to alleviate the presenter “blob” anti-pattern by moving validation logic into other controller classes that are used from within the views.<span>&nbsp; </span>I also like to move functionality like filtering, paging, and sorting to these secondary controller classes.<span>&nbsp; </span>It’s just a way of keeping the size of the classes down and maintaining class cohesion.<span>&nbsp; </span></p>
<p>&nbsp;<b>Easier NFit/FitNesse Testing</b>&nbsp; </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt">We’ve had some success with writing our <a href="http://fitnesse.org/">FitNesse</a> tests directly against the Presenter classes.<span>&nbsp; </span>We have been making the Fixture class for the screen implement the interface for the view and passing itself into an instance of the Presenter, then letting an <span style="font-family: 'Courier New'">ActionFixture</span> drive the screen.<span>&nbsp; </span>It’s a lot simpler than trying to drive the tests against the screens themselves.<span>&nbsp; </span>Our sister office is using FitNesse to drive Selenium tests to great effect, but they’re doing it because they don’t have a suitable service layer to test business logic through.<span>&nbsp; </span>These Fixtures look something like this:</p>
<p>&nbsp;<span style="font-size: 10pt;color: blue;font-family: 'Courier New'">using</span><span style="font-size: 10pt;font-family: 'Courier New'"> System;</span><span style="font-size: 10pt;color: blue;font-family: 'Courier New'">using</span><span style="font-size: 10pt;font-family: 'Courier New'"> fit;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;color: blue;font-family: 'Courier New'">namespace</span><span style="font-size: 10pt;font-family: 'Courier New'"> WebSample</span><span style="font-size: 10pt;font-family: 'Courier New'">{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> DataEntryFixture : Fixture, IWorkItemView</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">string</span>[] _assignments;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">string</span>[] _categories;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> WorkItemPresenter _presenter;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> DataEntryFixture()</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_presenter = <span style="color: blue">new</span> WorkItemPresenter(<span style="color: blue">this</span>, <span style="color: blue">new</span> WorkItemService());</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> WorkItem WorkItem</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span> { <span style="color: blue">throw</span> <span style="color: blue">new</span> NotImplementedException(); }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span>[] AssignmentList</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span> { _assignments = <span style="color: blue">value</span>; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span>[] CategoryList</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span> { _categories = <span style="color: blue">value</span>; }</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'">&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span> SelectedCategory</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span></span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_presenter.ChangeCategory(<span style="color: blue">value</span>);</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style="font-size: 10pt;font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span> </p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: 'Courier New'">}</span></p>
<p>&nbsp;&nbsp;&nbsp;<b>Related Concepts</b><b>&nbsp;</b> </p>
<ul style="margin-top: 0in" type="disc">
<li class="MsoNormal"><a href="/blogs/jeremy.miller/articles/129543.aspx">Dependency Inversion Principle</a><b></b></li>
<li class="MsoNormal"><a href="http://www.dofactory.com/Patterns/PatternFacade.aspx">Façade Pattern</a><b></b></li>
<li class="MsoNormal">Just go read every single article on Martin Fowler’s <a href="http://www.martinfowler.com/">website</a>, especially the sections on Patterns of Enterprise Application Architecture.<span>&nbsp; </span>It’s worth the time.<b></b></li>
<li class="MsoNormal"><a href="/blogs/jeremy.miller/archive/2005/12/19/135757.aspx">Mock objects</a><b></b></li>
<li class="MsoNormal"><a href="/blogs/jeremy.miller/archive/2005/09/20/132290.aspx">Inversion of Control</a><b></b></li>
<li class="MsoNormal"><a href="/blogs/jeremy.miller/archive/2005/10/06/132825.aspx">Dependency Injection</a><b></b></li>
<li class="MsoNormal">Just in case you’ve been living under a rock the last couple of years, check out the <a href="http://steve.emxsoftware.com/RubyOnRails/Why+all+the+hype+over+Ruby+on+Rails">Ruby on Rails approach to web development</a>.<span>&nbsp; </span>RoR’s structure is built around a solid separation of concerns between model, view, and presentation logic.<span>&nbsp; </span>My shop has way too much invested in .Net to switch anytime soon, but I think the ASP.Net community can glean a lot of ideas from the RoR model.<span>&nbsp; </span>Besides, all the cool kids are using Ruby these days.<b></b></li>
</ul>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/design-patterns/" title="View all posts in Design Patterns" rel="category tag">Design Patterns</a>, <a href="http://codebetter.com/jeremymiller/category/test-driven-development/" title="View all posts in Test Driven Development" rel="category tag">Test Driven Development</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2006/02/02/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern/" title="Permalink to Test Driven Development with ASP.Net and the Model View Presenter Pattern" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2006/02/02/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern/feed/" title="Comments RSS to Test Driven Development with ASP.Net and the Model View Presenter Pattern" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-126 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2006/02/01/i-thought-you-said-not-to-cross-the-streams/" rel="prev"><span class="meta-nav">&larr;</span> I thought you said NOT to cross the streams!</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2006/02/08/oo-tdd-and-agile-processes-are-all-good-but-better-get-the-basic-things-right-too/" rel="next">OO, TDD, and Agile processes are all good, but better get the basic things right too <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-470">
					<div id="dsq-comment-header-470" class="dsq-comment-header">
						<cite id="dsq-cite-470">
	http://substantiality.net							<span id="dsq-author-user-470">Sam</span>
							</cite>
					</div>
					<div id="dsq-comment-body-470" class="dsq-comment-body">
						<div id="dsq-comment-message-470" class="dsq-comment-message"><p>>> &#8220;The code-behind is View code, period.&#8221;</p>
<p>Amen. EXCELLENT post.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-471">
					<div id="dsq-comment-header-471" class="dsq-comment-header">
						<cite id="dsq-cite-471">
								<span id="dsq-author-user-471">Liang</span>
							</cite>
					</div>
					<div id="dsq-comment-body-471" class="dsq-comment-body">
						<div id="dsq-comment-message-471" class="dsq-comment-message"><p>Excellent! Excellent!!<br />
I definitely need to look at StructureMap to find out how to set up stub. I am using MVP in my projects. But I still haven&#8217;t found a goog way to test ASP.NET page. By the way, we should do our validation on presenter or domain layer as well as on presentation layer, since presenter or domain can be used for WinForm as well. so that they have to encapsulate their own logic.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-472">
					<div id="dsq-comment-header-472" class="dsq-comment-header">
						<cite id="dsq-cite-472">
								<span id="dsq-author-user-472">cs</span>
							</cite>
					</div>
					<div id="dsq-comment-body-472" class="dsq-comment-body">
						<div id="dsq-comment-message-472" class="dsq-comment-message"><p>&#8220;A lot of .Net literature describes the “Code-Behind” class as the MVC controller.  I think this is dead wrong.  The code-behind is View code, period.&#8221;</p>
<p>I keep telling people that ASP.Net&#8217;s MVC claims are mostly junk. You&#8217;re posts are always awesome. Where do you work anyway? Sounds like an awesome place.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-473">
					<div id="dsq-comment-header-473" class="dsq-comment-header">
						<cite id="dsq-cite-473">
	http://hrboyceiii.blogspot.com							<span id="dsq-author-user-473">Harris</span>
							</cite>
					</div>
					<div id="dsq-comment-body-473" class="dsq-comment-body">
						<div id="dsq-comment-message-473" class="dsq-comment-message"><p>Jeremy,</p>
<p>Great post!!  I really like how you incorporated the presenter into UserControls.</p>
<p>One comment I have is related to the interface of the view.  A collegue of mine didn&#8217;t like the fact that by &#8220;exposing&#8221; the Model thru the View (i.e., your WorkItem { get; } property), your no longer decoupling the view from the model; or, otherwise put, the UI now knows about the model and if the the UI isn&#8217;t supposed to know intimate, inner workings/knowledge of the model.  I tend to agree with him, but it leads to coarser View interfaces unfortunately&#8230;I guess it&#8217;s all a balancing act&#8230;</p>
<p>Great post, again, regardless.</p>
<p>H</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-474">
					<div id="dsq-comment-header-474" class="dsq-comment-header">
						<cite id="dsq-cite-474">
								<span id="dsq-author-user-474">Michael</span>
							</cite>
					</div>
					<div id="dsq-comment-body-474" class="dsq-comment-body">
						<div id="dsq-comment-message-474" class="dsq-comment-message"><p>Jeremy, that was fantasic.  I&#8217;ve been looking for great MVP examples recently, and that hit the mark.</p>
<p>A somewhat related question&#8230;</p>
<p>Let&#8217;s say I have in coding the Presenter, I&#8217;ve created an interface to a back-end service and mocked it, such as you have with the WorkItemService.  During this process, the code in the Presenter has come to shpae not only the interface of the service, but the behavior as well, such as expected return values, exceptions, parameter handling, etc.</p>
<p>Now when it comes time to develop the real implementation of the service interface, there&#8217;s always the chance that you don&#8217;t exacly recreate the behaviors the Presenter depended on.  Maybe you throw throw the wrong exception, or return an empty list in cases where the Presenter was coded against the expectation of null, or some other such quirk.</p>
<p>How do you either resolve or avoid this?</p>
<p>Another problem (I&#8217;ll just throw stuff out there&#8230; comment, blog about it, ignore it&#8230; <img src='http://codebetter.com/jeremymiller/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' />  is dependencies.  Do you ever find that excessive constructor dependencies becomes a problem in cases where the Presenter takes a service, and the service takes a data gateway, and the gateway takes a session manager, and the session manager takes a cache manager, etc.  That&#8217;s just a contrived example, but you get the idea.  Essentially, because the dependencies must be injected for the benefit of TDD, you&#8217;re now faced with top-level objects having to build a cache manager to build a session manager to build a gateway to build a service, when all it really cares about is the service interface.  Do you just ignore it and rely on DI container config files to do it for you, or are there other techniques, or am I missing something and this never happens?</p>
<p>Anyway, thanks for everything, and keep blogging!</p>
<p>Michael</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-475">
					<div id="dsq-comment-header-475" class="dsq-comment-header">
						<cite id="dsq-cite-475">
								<span id="dsq-author-user-475">Jeremy D. Miller</span>
							</cite>
					</div>
					<div id="dsq-comment-body-475" class="dsq-comment-body">
						<div id="dsq-comment-message-475" class="dsq-comment-message"><p>Harris &#038; Michael,</p>
<p>I&#8217;ll put out a followup post in the next couple of days to address both questions/objections</p>
<p>Jeremy</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-476">
					<div id="dsq-comment-header-476" class="dsq-comment-header">
						<cite id="dsq-cite-476">
								<span id="dsq-author-user-476">Carlton</span>
							</cite>
					</div>
					<div id="dsq-comment-body-476" class="dsq-comment-body">
						<div id="dsq-comment-message-476" class="dsq-comment-message"><p>I know this is old, but I just had the time to print this up and read it &#8211; I like this article.  </p>
<p>One quick question: isn&#8217;t the Presenter in MVP just an expression, or a usage, of a Mediator pattern from GOF?  Not that I am knocking your article or MVP, just want to clarify my own understanding.  Thank you.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-477">
					<div id="dsq-comment-header-477" class="dsq-comment-header">
						<cite id="dsq-cite-477">
								<span id="dsq-author-user-477">matt d</span>
							</cite>
					</div>
					<div id="dsq-comment-body-477" class="dsq-comment-body">
						<div id="dsq-comment-message-477" class="dsq-comment-message"><p>For unit testing your asp.net apps you might check out RUnit:</p>
<p><a href="http://www.ruxp.net/runit.asp" rel="nofollow">http://www.ruxp.net/runit.asp</a></p>
<p>it allows you to run your NUnit tests under the asp.net process.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-478">
					<div id="dsq-comment-header-478" class="dsq-comment-header">
						<cite id="dsq-cite-478">
	http://alexfurman.net							<span id="dsq-author-user-478">Alex</span>
							</cite>
					</div>
					<div id="dsq-comment-body-478" class="dsq-comment-body">
						<div id="dsq-comment-message-478" class="dsq-comment-message"><p>Look at SWExplorerAutomation<br />
(<a href="http://home.comcast.net/~furmana/SWIEAutomation.htm" rel="nofollow">http://home.comcast.net/~furmana/SWIEAutomation.htm</a>). The program creates automation API for any Web application based on HTML and DHTML The API is used to visually  record the test scripts. </p>
<p>Example links: </p>
<p>1) Testing your web UI using SWExplorerAutomation and<br />
NUnit:http://www.testingreflections.com/node/view/2763 </p>
<p>2)Automating Web UI testing with SWEA, C#, &#038; NUnit (part<br />
<a href="http://qainsight.net/PermaLink,guid,de5297ad-53de-4a9d-a78f-bb580afefb5b.aspx" rel="nofollow">http://qainsight.net/PermaLink,guid,de5297ad-53de-4a9d-a78f-bb580afefb5b.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-479">
					<div id="dsq-comment-header-479" class="dsq-comment-header">
						<cite id="dsq-cite-479">
	http://www.geekswithblogs.com/billy							<span id="dsq-author-user-479">Billy McCafferty</span>
							</cite>
					</div>
					<div id="dsq-comment-body-479" class="dsq-comment-body">
						<div id="dsq-comment-message-479" class="dsq-comment-message"><p>Awesome awesome awesome&#8230;thank you!</p>
<p>ASP.NET MVC has been a perplexing problem&#8230;this tackles it wonderfully.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-480">
					<div id="dsq-comment-header-480" class="dsq-comment-header">
						<cite id="dsq-cite-480">
								<span id="dsq-author-user-480">Amy Baker</span>
							</cite>
					</div>
					<div id="dsq-comment-body-480" class="dsq-comment-body">
						<div id="dsq-comment-message-480" class="dsq-comment-message"><p>Questions:<br />
1. How does MVP handle validation when using the built in .Net validators? Custom validators? Is the presenter involved in that at all or does the view take care of everything? It would be nice to have the validation be testable through the presenter, but it may have to be done through the View. </p>
<p>2. General question: How to build up text in the presenter to give to the view if the text varies along many different concepts. Example: Simple heading text. We have an inordinate amount of variation in the text for a heading. There are 4 words in our heading. What to display for each word varies on a different concept. You could either have a lot of if statements in your presenter, or have your presenter contain strategies for each different concept and build up the heading that way. Using the strategies seems like better OO design, but almost seems overkill and seems like it would be hard to maintain. Any suggestions? </p>
<p>3. How do you handle variations in layout? If one layout has three columns, 4 rows and another has 2 colums, 3 rows, do you make a second ascx and code behind even though 90% of the layout is the same? Or does the presenter set a LayoutState on the view and the view then writes out the appropriate html from the code behind based on that LayoutState? I don&#8217;t like making a second view that has so much duplication, but I also don&#8217;t like writing out html from the code behind. Any ideas?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-481">
					<div id="dsq-comment-header-481" class="dsq-comment-header">
						<cite id="dsq-cite-481">
								<span id="dsq-author-user-481">mk</span>
							</cite>
					</div>
					<div id="dsq-comment-body-481" class="dsq-comment-body">
						<div id="dsq-comment-message-481" class="dsq-comment-message"><p>some people pull their code out of their asses , if you want to be smart<br />
make sure your code compiles first. If not you&#8217;re not differnet than M$ developers.</p>
<p>&#8211;constructor, class WorkItemPresenter<br />
public WorkItemPresenter(IWorkItemView view, IWorkItemService service)</p>
<p>&#8211;class WorkItemPage<br />
WorkItemPresenter presenter = new WorkItemPresenter(workEntryControl);</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-482">
					<div id="dsq-comment-header-482" class="dsq-comment-header">
						<cite id="dsq-cite-482">
								<span id="dsq-author-user-482">jmiller</span>
							</cite>
					</div>
					<div id="dsq-comment-body-482" class="dsq-comment-body">
						<div id="dsq-comment-message-482" class="dsq-comment-message"><p>Um, MK -</p>
<p>Can you say &#8220;contrived example?&#8221;  I cut it out of the example in the page for brevity, but I simply used a second constructor that only takes in an IWorkItemView and constructs the default instance of the IWorkItemService.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-483">
					<div id="dsq-comment-header-483" class="dsq-comment-header">
						<cite id="dsq-cite-483">
								<span id="dsq-author-user-483">Don Cameron</span>
							</cite>
					</div>
					<div id="dsq-comment-body-483" class="dsq-comment-body">
						<div id="dsq-comment-message-483" class="dsq-comment-message"><p>Jeremey, nice work.</p>
<p>It is working well, but I am having a bit of conceptual struggle implementing the User Interface Application Block with MVP.  The UIP maintains state in the controller, and has a single controller per business thread, or business group.  Any work done in this area?</p>
<p>Don</p>
<p>P.S.  As for MK:  I would like to see critics like this post their work on the net for all to see.  I really detest people who pick at little wrong things in light of all this good.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-484">
					<div id="dsq-comment-header-484" class="dsq-comment-header">
						<cite id="dsq-cite-484">
	http://codebetter.com/blogs/jeremy.miller							<span id="dsq-author-user-484">jmiller</span>
							</cite>
					</div>
					<div id="dsq-comment-body-484" class="dsq-comment-body">
						<div id="dsq-comment-message-484" class="dsq-comment-message"><p>Don,</p>
<p>As far as I know, the UIP is effectively dead.</p>
<p>Jeremy</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-485">
					<div id="dsq-comment-header-485" class="dsq-comment-header">
						<cite id="dsq-cite-485">
								<span id="dsq-author-user-485">Daryn</span>
							</cite>
					</div>
					<div id="dsq-comment-body-485" class="dsq-comment-body">
						<div id="dsq-comment-message-485" class="dsq-comment-message"><p>MVP is a wonderful design pattern.<br />
Thanks for this great post.</p>
<p>I have the following questions:</p>
<p>How can you use the MVP when creating a wizard type interface?<br />
I want the user to be able to click ‘next’ then the current triad changes to the next triad, and updates the view.   I have an implementation, but it does not seem that ‘clean’.</p>
<p>1. So how do you change triads/views?</p>
<p>In MVC a model could have multiple views.   As far as my understanding of MVP, each presenter has no more than one view – a model can have multiple presenters.</p>
<p>2. Are these thoughts correct?</p>
<p>Thank you!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-486">
					<div id="dsq-comment-header-486" class="dsq-comment-header">
						<cite id="dsq-cite-486">
	http://www.cattechnologies.com							<span id="dsq-author-user-486">Imran Ahmedc </span>
							</cite>
					</div>
					<div id="dsq-comment-body-486" class="dsq-comment-body">
						<div id="dsq-comment-message-486" class="dsq-comment-message"><p>Dear Manager,  </p>
<p>Hope you are doing great! </p>
<p>The purpose of this letter is to introduce you to CAT Technology Inc and our Offshore Development services. We are the leading Offshore Development service company in INDIA. We align ourselves with our customers as partners to assist them in achieving their goals and objectives. We would be delighted to demonstrate our offshore Development services to you. Please let me know if you have any software Development work to Outsource? </p>
<p>Out Team size in INDIA:<br />
.Net/C# Developers: 90 Members<br />
Delphi Programmers: 18  Members<br />
Web developers: 50  Members<br />
JSP/ Java Programmers: 45 Members<br />
PHP Programmers: 30 Members<br />
System/Network Administrators (MCSE) (CCNA) (CCNP):30 Members</p>
<p>Visit us at&#8212; <a href="http://www.cattechnologies.com" rel="nofollow">http://www.cattechnologies.com</a></p>
<p>View our development office in INDIA :<br />
You can view our development office in INDIA through this camera.<br />
Camera Server URL: <a href="http://203.197.241.56" rel="nofollow">http://203.197.241.56</a><br />
Login: cat<br />
Password: techno</p>
<p>Dedicated Staff:<br />
When you set up an offshore development center with CAT, you get the following:<br />
All hardware, software licensing and office infrastructure already in place A dedicated team of professionals who will learn your business and become a part of your team. Seamless collaboration between offshore office and client project staff through live chat / email / voice / video .U.S. based contact point to manage all issues throughout the relationship and insure success of all projects. All staff assigned to your team will report directly to you or your project manager and follow your directives and timelines.</p>
<p>Maintenance Projects:<br />
Just because your project is complete does not mean you dont need professional technical support for your existing applications.  Our staff are available to you on a dedicated basis to review your existing applications and provide you the support and technical updates that are needed to maintain the competitiveness of your applications. If you are a new customer to CAT, ask us about our maintenance plans that enable you to take care of your application beyond the major development phase.  Maintenance Services are available to your regardless where you had your application developed</p>
<p>Project Based:<br />
Are you looking for professionals to help you build your projects?  If so, consider CAT as your world class partner. We will work closely with you to understand your project&#8217;s requirements, deadlines, technologies and needs to determine the best team to make your project a success. Also, you can decide whether you plan to manage the project internally and utilize our development and testing resources, or prefer to have one of our project managers lead the team. </p>
<p>Wide range of PHP Services we provide:<br />
1.  PHP Programming<br />
2.  Database development (php/mysql,)<br />
3.  MYSQL PHP Programming, script installing, modification, and PHP Script repairs.<br />
4.  Custom web site design/redesign and development<br />
5.  Custom PHP and MYSQL web programming<br />
6.  PHP shopping cart<br />
7.  PHP forum<br />
8.  PHP content management system</p>
<p>Wide range of .Net Services we provide:<br />
1.  Application Development using .NET<br />
2.  Designing and Programming using .NET<br />
3.  Migration web based and other applications to .NET<br />
4.  Porting of Legacy applications to .NET based applications<br />
5.  Support and Enhancement of existing applications in .NET<br />
6.  User needs assessment / functional spec writing<br />
7.  Website architecture design<br />
8.  User Interface design<br />
9.  Graphic artwork development with Photoshop &#038; ImageReady<br />
10. Database design<br />
11. Stored procedure development<br />
12. OO Design and development of middle tier objects<br />
13. ASP.Net development with C# or VB.Net<br />
14. .Net desktop application development<br />
15. JavaScript development &#038; cross browser issues<br />
16. Ajax/Atlas Development<br />
17. IIS setup &#038; security issues<br />
18. Website hosting<br />
19. E-Commerce development<br />
20. Conversion of legacy system data<br />
21. Web Marketing / Search Engine Optimization / SEM<br />
22. Software Testing &#038; QA<br />
23. Web based report development<br />
24. Adobe PDF file generation<br />
25. Integration with existing systems</p>
<p>Wide range of Web Development Services we provide:<br />
We have designed websites of various styles, sizes and purposes. We have a team of 50 Web designers and Developers in our office in INDIA.<br />
1.  Custom Website Design<br />
2.  Template Website Design<br />
3.  Custom E-commerce Design<br />
4.  Website Re-Design<br />
5.  Macromedia Flash Design<br />
6.  Graphic Design</p>
<p>Wide range of Network Support / System Administration Services we provide:<br />
1.  Onsite server support (upgrades, security patches, migrations)<br />
2.  Remote management and administration<br />
3.  Configure and maintain Windows 2000, 2003 servers and services (Active Directory, DHCP, DNS, IIS, RAS, NAT, VPN )<br />
4.  Install, configure and Maintain Microsoft ISA 2004 server<br />
5.  Installing &#038; Administrating, Managing of Domain Controllers.<br />
6.  Installing, Configuring &#038; Administering the following<br />
7.  Microsoft Exchange Servers<br />
8.  Securing your Linux Server with Firewall / Troubleshooting your Linux System<br />
9.  Server installation and configuration<br />
10. Security analysis and policy development<br />
11. Firewall firmware upgrades/Firewall policy implementation and management<br />
12. LAN Administration<br />
13. Microsoft Certified Systems Engineers (MCSE)<br />
14. Cisco Certified Network Associate ( CCNA ) ( CCNP)<br />
15. Network Installation<br />
16. Network Management<br />
17. Network Security and quality monitoring<br />
18. Network Maintenance<br />
19. Security Firewalls</p>
<p>Wide range of Java Services we provide:<br />
1.  Web Application Development in Java<br />
2.  Systems Programming in C, C++, VC++, C-Sharp (C#) and Java<br />
3.  Web Hosting services in JSP and Servlets<br />
4.  Web application maintenance like bug fixing and adding new features<br />
5.  Life cycle testing for web based application and client server products<br />
6.  J2EE Design Patterns<br />
7.  Design and development of applications on J2EE compliant framework<br />
8.  Projects related to Java CORBA and Java XML</p>
<p>Wide range of Delphi Services we provide:<br />
1.  Delphi application re-engineering<br />
2.  Delphi application development<br />
3.  Delphi .net development<br />
4.  Delphi 7 development<br />
5.  Delphi 2006 development<br />
6.  Delphi 6 development<br />
7.  Delphi application maintenance<br />
8.  Delphi 5 development</p>
<p>Our reputation for service is second to none, and our entire staff stands ready to work with you and your staff in any way we can be of assistance. </p>
<p>Eagerly looking for your update</p>
<p>Imran Ahmed<br />
Business Development Manager</p>
<p>CAT Technology Inc<br />
&#8221; Committed to Human Excellence Through IT &#8221;</p>
<p>Phone: 201 255 0319 x 224</p>
<p>Visit us at&#8212;<br />
<a href="http://www.cattechnologies.com" rel="nofollow">http://www.cattechnologies.com</a></p>
<p>Note: We respect your on-line privacy. This is not an unsolicited mail.Under Bill 1618 Title III passed by the 105th US Congress this mail cannot be considered Spam as long as we include contact information and a method to be removed from our mailing list. If you are not interested in receiving our e-mails then please reply with a &#8220;REMOVE&#8221; to <a href="mailto:Mohammed.Masood@cattechnologies.com">Mohammed.Masood@cattechnologies.com</a> in the subject line. I am sorry for the inconvenience caused to you.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-487">
					<div id="dsq-comment-header-487" class="dsq-comment-header">
						<cite id="dsq-cite-487">
	http://www.gigfodder.com							<span id="dsq-author-user-487">mike</span>
							</cite>
					</div>
					<div id="dsq-comment-body-487" class="dsq-comment-body">
						<div id="dsq-comment-message-487" class="dsq-comment-message"><p>CAT Tech you have convinced me!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-488">
					<div id="dsq-comment-header-488" class="dsq-comment-header">
						<cite id="dsq-cite-488">
								<span id="dsq-author-user-488">Mohammad Azam</span>
							</cite>
					</div>
					<div id="dsq-comment-body-488" class="dsq-comment-body">
						<div id="dsq-comment-message-488" class="dsq-comment-message"><p>Hi, </p>
<p>Nice article! One thing is bugging me that in the Page_Load of the page you create a presenter and displays the appropriate view on the page. What will happen when you want to display 10-20 views on the same page? Will you use the same approach of creating the views using presenter. These can be small views like </p>
<p>1) List Customers<br />
2) Show Current Time<br />
3) Show LogName<br />
5) Show Menu</p>
<p>Let me know what you think!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-489">
					<div id="dsq-comment-header-489" class="dsq-comment-header">
						<cite id="dsq-cite-489">
	http://www.portraitkingdom.com							<span id="dsq-author-user-489">oil portraits</span>
							</cite>
					</div>
					<div id="dsq-comment-body-489" class="dsq-comment-body">
						<div id="dsq-comment-message-489" class="dsq-comment-message"><p>I really wonder why way back in college we were never introduced to the advanced knowledge of ASP.net.  I noticed that most job hirings lately require knowledge on ASP and it just feels so bad that I can do everything except for the one that requires ASP.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-490">
					<div id="dsq-comment-header-490" class="dsq-comment-header">
						<cite id="dsq-cite-490">
								<span id="dsq-author-user-490">Pratik Panchal</span>
							</cite>
					</div>
					<div id="dsq-comment-body-490" class="dsq-comment-body">
						<div id="dsq-comment-message-490" class="dsq-comment-message"><p>Hi,</p>
<p>I want to test WCSF ( Web Client Software Factory ) using NUnit Mock objects.</p>
<p>Can you please help me out?</p>
<p>Pratik</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-491">
					<div id="dsq-comment-header-491" class="dsq-comment-header">
						<cite id="dsq-cite-491">
	http://www.cerquit.com/blogs							<span id="dsq-author-user-491">Rod</span>
							</cite>
					</div>
					<div id="dsq-comment-body-491" class="dsq-comment-body">
						<div id="dsq-comment-message-491" class="dsq-comment-message"><p>Hi Jeremy,</p>
<p>This is a great post. You really rock!</p>
<p>Btw, I created an MVP article (just yesterday) with sample solution on my site. I think this is very helpfull to MVP fantaics out there besides the advantages you mentioned above it also demonstrate how MVP can be reused in differen presenter (web, web form, mobile, etc)&#8230;  It also has a sample project to demonstrate mock testing.</p>
<p>URL: <a href="http://www.cerquit.com/blogs/post/MVP-Part-I-e28093-Building-it-from-Scratch.aspx" rel="nofollow">http://www.cerquit.com/blogs/post/MVP-Part-I-e28093-Building-it-from-Scratch.aspx</a></p>
<p>In our country MVC is more popular than MVP. I think I&#8217;m the only MVP evangelist here.. hehehe&#8230; In my previous company I conduct and train engineers on how to use MVP and gradualy they really feel the power&#8230;</p>
<p>This is my first blog after 4 years. Its payback time. </p>
<p>Cheers,<br />
Rod</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-492">
					<div id="dsq-comment-header-492" class="dsq-comment-header">
						<cite id="dsq-cite-492">
	http://sm-art.biz							<span id="dsq-author-user-492">ulu</span>
							</cite>
					</div>
					<div id="dsq-comment-body-492" class="dsq-comment-body">
						<div id="dsq-comment-message-492" class="dsq-comment-message"><p>This, and several other articles, are great examples of what can be done within the Webforms framework. The question is, do we really need to throw it away and switch to MS MVC or MonoRail? The &#8220;complex event model&#8221; and &#8220;you can&#8217;t control the html output&#8221; arguments are not really convincing. The testability issue is still there: you can&#8217;t test a View in MonoRail, right? (You *can* test WebForms views with Ivonna though).</p>
<p>Sometimes I have user controls so simple that they can be implemented declaratively. Refactoring such a simple thing into MVP would be hell. However, I can always do that in case the control gets more complex. Having no predefined MV* pattern makes it more flexible, even, I dare say, agile.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-493">
					<div id="dsq-comment-header-493" class="dsq-comment-header">
						<cite id="dsq-cite-493">
								<span id="dsq-author-user-493">Kaba</span>
							</cite>
					</div>
					<div id="dsq-comment-body-493" class="dsq-comment-body">
						<div id="dsq-comment-message-493" class="dsq-comment-message"><p>Hey, the newlines in the code examples aren&#8217;t showing. Makes it very hard to read. <img src='http://codebetter.com/jeremymiller/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  </p>
<p>(tested in fx3 &#038; ie7)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-494">
					<div id="dsq-comment-header-494" class="dsq-comment-header">
						<cite id="dsq-cite-494">
								<span id="dsq-author-user-494">rookie</span>
							</cite>
					</div>
					<div id="dsq-comment-body-494" class="dsq-comment-body">
						<div id="dsq-comment-message-494" class="dsq-comment-message"><p>public class WorkItem<br />
{<br />
    private string _category;<br />
    private string _assignedTo;<br />
    public string Category<br />
    {<br />
        get { return _category; }<br />
        set { _category = value; }<br />
    }<br />
    public string AssignedTo<br />
    {<br />
        get { return _assignedTo; }<br />
        set { _assignedTo = value; }<br />
    }             /* Other stuff */<br />
}</p>
<p>// Abstracted interface of the WorkItem View screen<br />
public interface IWorkItemView<br />
{<br />
    // Packs the user input into a new WorkItem class<br />
    WorkItem WorkItem { get;}<br />
    // Sets the values in the dropdown list for the WorkItem assigned to user<br />
    string[] AssignmentList { set;}<br />
    // Sets the values in the dropdown list for the WorkItem categories<br />
    string[] CategoryList { set;}<br />
}</p>
<p>public interface IWorkItemService<br />
{<br />
    void ProcessWorkItem(WorkItem entry);<br />
    string[] GetAssignmentListForCategory(string category);<br />
    string[] GetCategoriesForRoles(string[] roles);<br />
}</p>
<p>public class WorkItemPresenter<br />
{<br />
    private readonly IWorkItemView _view;<br />
    private readonly IWorkItemService _service;<br />
    // Use &#8220;Dependency Injection&#8221; to attach the dependencies for the view<br />
    // and service.<br />
    public WorkItemPresenter(IWorkItemView view, IWorkItemService service)<br />
    {<br />
        _view = view;<br />
        _service = service;<br />
    }<br />
    public void Initialize()<br />
    {<br />
        string[] categoryList = this.determineCategoryListFromUserRoles();<br />
        _view.CategoryList = categoryList;<br />
    }<br />
    public void Submit()<br />
    {<br />
        WorkItem item = _view.WorkItem;<br />
        _service.ProcessWorkItem(item);<br />
    }<br />
    public void ChangeCategory(string categoryName)<br />
    {<br />
        string[] assignmentList = _service.GetAssignmentListForCategory(categoryName);<br />
        _view.AssignmentList = assignmentList;<br />
    }<br />
    public string[] determineCategoryListFromUserRoles()<br />
    {<br />
        // Examine the roles on the IPrincipal object and query IWorkItemService for<br />
        // the possible categories                   return new string[0];<br />
    }</p>
<p>}</p>
<p>[TestFixture]<br />
public class WorkItemPresenterTester<br />
{<br />
    private DynamicMock _serviceMock;<br />
    private DynamicMock _viewMock;<br />
    private WorkItemPresenter _presenter;<br />
    [SetUp]<br />
    public void SetUp()<br />
    {<br />
        _serviceMock = new DynamicMock(typeof(IWorkItemService));<br />
        _viewMock = new DynamicMock(typeof(IWorkItemView));<br />
        _presenter = new WorkItemPresenter((IWorkItemView)_viewMock.MockInstance, (IWorkItemService)_serviceMock.MockInstance);<br />
    }</p>
<p>}<br />
public class WorkEntryView : UserControl, IWorkItemView<br />
{<br />
    private WorkItemPresenter _presenter;<br />
    protected DropDownList assignmentDropdown;<br />
    protected DropDownList categoryDropdown;</p>
<p>    // The UserControl has a reference to the presenter class<br />
    public void AttachPresenter(WorkItemPresenter presenter)<br />
    {<br />
        _presenter = presenter;<br />
    }<br />
    private void Page_Load(object sender, EventArgs e)<br />
    {<br />
        categoryDropdown.SelectedIndexChanged += new EventHandler(categoryDropdown_SelectedIndexChanged);<br />
    }<br />
    #region Web Form Designer generated code<br />
    public WorkItem WorkItem;<br />
    ///<br />
<summary>
    /// Fill the dropdown list for the possible assignments<br />
    /// </summary>
<p>    ///<br />
    public string[] AssignmentList<br />
    {<br />
        set<br />
        {<br />
            assignmentDropdown.Items.Clear();<br />
            foreach (string assignment in value)<br />
            {<br />
                assignmentDropdown.Items.Add(assignment);<br />
            }<br />
        }<br />
    }<br />
    public string[] CategoryList;<br />
    // The UserControl immediately relays the user selecting a new Category to the<br />
    // presenter object.  The presenter will decide what to do next<br />
    private void categoryDropdown_SelectedIndexChanged(object sender, EventArgs e)<br />
    {<br />
        string category = categoryDropdown.SelectedValue;<br />
        _presenter.ChangeCategory(category);<br />
    }</p>
<p>}</p>
<p>public class WorkItemPage : System.Web.UI.Page<br />
{<br />
    protected WorkEntryView workEntryControl;<br />
    private void Page_Load(object sender, System.EventArgs e)<br />
    {<br />
        WorkItemPresenter presenter = new WorkItemPresenter(workEntryControl);<br />
        workEntryControl.AttachPresenter(presenter);<br />
        presenter.Initialize();<br />
    }</p>
<p>}</p>
<p>using System;<br />
using fit;<br />
namespace WebSample{<br />
public class DataEntryFixture : Fixture, IWorkItemView<br />
{<br />
    private string[] _assignments;<br />
    private string[] _categories;<br />
    private WorkItemPresenter _presenter;<br />
    public DataEntryFixture()<br />
    {<br />
        _presenter = new WorkItemPresenter(this, new WorkItemService());<br />
    }<br />
    public WorkItem WorkItem<br />
    {<br />
        get { throw new NotImplementedException(); }<br />
    }<br />
    public string[] AssignmentList<br />
    {<br />
        set { _assignments = value; }<br />
    }<br />
    public string[] CategoryList<br />
    {<br />
        set { _categories = value; }<br />
    }<br />
    public string SelectedCategory<br />
    {<br />
        set<br />
        { _presenter.ChangeCategory(value); }<br />
    }<br />
}<br />
}</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-495">
					<div id="dsq-comment-header-495" class="dsq-comment-header">
						<cite id="dsq-cite-495">
	http://www.solicitorslawyers.com.au/Piora/Lawyers_Piora.html							<span id="dsq-author-user-495">Lawyers Piora  </span>
							</cite>
					</div>
					<div id="dsq-comment-body-495" class="dsq-comment-body">
						<div id="dsq-comment-message-495" class="dsq-comment-message"><p>Very difficult to understand. Actually I am a newbie. Thanks for sharing.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-496">
					<div id="dsq-comment-header-496" class="dsq-comment-header">
						<cite id="dsq-cite-496">
								<span id="dsq-author-user-496">Roman</span>
							</cite>
					</div>
					<div id="dsq-comment-body-496" class="dsq-comment-body">
						<div id="dsq-comment-message-496" class="dsq-comment-message"><p>The code formatting is very broken (probably due to some site migration or other). While the comment above shows the code with newlines, here&#8217;s a better formatted version: <a href="http://pastie.org/724114" rel="nofollow">http://pastie.org/724114</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-497">
					<div id="dsq-comment-header-497" class="dsq-comment-header">
						<cite id="dsq-cite-497">
	http://pastie.org/724114							<span id="dsq-author-user-497">Muhammad.Jaelani</span>
							</cite>
					</div>
					<div id="dsq-comment-body-497" class="dsq-comment-body">
						<div id="dsq-comment-message-497" class="dsq-comment-message"><p>I think MVP it&#8217;s good for “Separation of Concerns&#8221;<br />
But , When I want to use State Management in ASP.net.<br />
Is MVP can do it ??</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/jeremymiller/2006/02/02/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern/ ';
	var disqus_identifier = '126 /blogs/jeremy.miller/archive/2006/02/01/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'theshadetreedeveloper';
	var disqus_title = "Test Driven Development with ASP.Net and the Model View Presenter Pattern";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=126');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/jeremymiller/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2006\/02\/02\/test-driven-development-with-asp-net-and-the-model-view-presenter-pattern\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://weblogs.asp.net/thangchung' rel='external nofollow' class='url'>thangchung</a> on <a href="http://codebetter.com/jeremymiller/2009/01/16/quot-buildup-quot-existing-objects-with-structuremap/#comment-6764">&quot;BuildUp&quot; Existing Objects with StructureMap</a></li><li class="recentcomments">Steven Gentile on <a href="http://codebetter.com/jeremymiller/2011/01/23/if-you-are-using-structuremap-with-mvc3-please-read-this/#comment-6763">If you are using StructureMap with MVC3, please read this:</a></li><li class="recentcomments">jabits on <a href="http://codebetter.com/jeremymiller/2011/01/16/a-train-of-thought-wrapping-up-codemash-2011/#comment-6761">A Train of Thought &ndash; Wrapping up CodeMash 2011</a></li><li class="recentcomments">Michael Meadows on <a href="http://codebetter.com/jeremymiller/2011/01/16/a-train-of-thought-wrapping-up-codemash-2011/#comment-6754">A Train of Thought &ndash; Wrapping up CodeMash 2011</a></li><li class="recentcomments">InspiringCode on <a href="http://codebetter.com/jeremymiller/2011/01/16/a-train-of-thought-wrapping-up-codemash-2011/#comment-6753">A Train of Thought &ndash; Wrapping up CodeMash 2011</a></li></ul></li>				</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.373 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-27 05:56:28 -->
<!-- super cache -->