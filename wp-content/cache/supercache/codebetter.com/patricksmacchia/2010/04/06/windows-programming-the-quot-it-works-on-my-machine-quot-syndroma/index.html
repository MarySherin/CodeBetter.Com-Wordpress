<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Windows programming: The &quot;it works on my machine&quot; syndroma | Patrick Smacchia</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/patricksmacchia/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/patricksmacchia/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/patricksmacchia/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/patricksmacchia/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/patricksmacchia/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Patrick Smacchia' href='http://codebetter.com/patricksmacchia/' />
<link rel='start' title='Benefit from the C# and VB.NET compilers perf' href='http://codebetter.com/patricksmacchia/2007/06/20/benefit-from-the-c-and-vb-net-compilers-perf/' />
<link rel='prev' title='Visual Studio Addin failed to load' href='http://codebetter.com/patricksmacchia/2010/03/12/visual-studio-addin-failed-to-load/' />
<link rel='next' title='Measuring an Interesting Fact' href='http://codebetter.com/patricksmacchia/2010/04/13/measuring-an-interesting-fact/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/patricksmacchia/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma/' />
<link rel='shortlink' href='http://codebetter.com/patricksmacchia/?p=160' />
<link rel="stylesheet" href="http://codebetter.com/patricksmacchia/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetter/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/patricksmacchia/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-160" class="post-160 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">Windows programming: The &quot;it works on my machine&quot; syndroma</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/patricksmacchia/author/patricksmacchia/" title="View all posts by patricksmacchia">patricksmacchia</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/patricksmacchia/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma/" title="6:34 am" rel="bookmark"><span class="entry-date">April 6, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/patricksmacchia/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/patricksmacchia/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/patricksmacchia/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><a class="a2a_dd" href="http://www.addtoany.com/share_save"><img src="http://static.addtoany.com/buttons/share_save_171_16.png" border="0" alt="Share/Bookmark" width="171" height="16" /></a></p>
<p>As a .NET programmers, you might feel free from OS<br />
specific issues. After all, isn&#8217;t the CLR a runtime engine that<br />
abstracts the OS? Well that&#8217;s the theory, in practice, when deploying<br />
over several years a desktop application on tens of thousands of<br />
Windows machines, we discovered (the hard way) that there can be some<br />
significant environment diff from one machine to another. Here are<br />
some issues we discovered the hard way while developing <a href="http://www.NDepend.com">NDepend</a>. This list is by no mean exhaustive but I hope this will help you anticipate these potential source of problems.</p>
<h3>%ProgramFiles% folder protection</h3>
<p>Since Vista, program configuration files shouldn’t live side-by-side under the folder <em>%ProgramFiles%\MyProgram</em>. This folder is protected by Windows and cannot be written seamlessly. Configuration files must exist in the dedicated <em>%AppData%</em> folder. While this seems obvious once you get the knowledge, transitioning configuration files from <em>%ProgramFiles%</em> to <em>%AppData%</em> can be painful. For NDepend we did the transition 2 years ago.</p>
<h3>UAC protection (User Account Control)</h3>
<p>When you programatically start a process or access network or do<br />
anything else OS sensitive, you must verify that your program won’t enter<br />
in a corrupted state because the Windows UAC requests made to the user might freeze it<br />
temporarily.</p>
<h3>File</h3>
<p>If you are dealing with file system you must be prepared to ALL<br />
sorts of problems. Internally, for NDepend, we had to develop a full<br />
file handling library. For example before writing a file you should<br />
make sure that it is not read-only and that you have Windows user<br />
permissions. Some developers might say that this sort of issue can be<br />
handled with exception management. Personally I prefer to forecast and<br />
prevent problems instead remedy problems effect. If you don’t<br />
rationalize file access issue with a custom library, you will be<br />
reported bugs again and again because of read-only files, missing<br />
files, protected files, blocked files etc.</p>
<p>Btw, concerning the debate<em> exception vs. prevention</em> putting<br />
simply we favor the pattern <em>bool XXX.TryParse()</em> over the pattern<em> try { XXX.Parse() } catch {}. </em>I wrote my stance here: <a href="http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx" target="_blank">Exception Handling Best Practice</a>s.<br />
In our team, we try to prevent all problems before they happen through<br />
some custom libraries. If we forget a case, a user ends up reporting a<br />
bug and we fix it as soon as possible. We then obtain rock-solid<br />
libraries over time that treats properly all exception case. <em></em></p>
<h3>Path</h3>
<p>IMHO one of the most flawed API (both win32 and .NET) is the path<br />
API. With this API, it is very hard to handle basic operation involving<br />
for example relative paths, or file to directory conversion, not even<br />
mentioning problems that happens with path longer than 256 char. The<br />
main problem is that for both win32 and .NET APIs, a path is<br />
represented through a simple string. But in fact a path is a pretty<br />
complex artifact that comes with forbidden char, absolute/relative<br />
mode, numerous standard scheme, directory/file path, file name and file<br />
extension, UNC path, normalization… Such complexity can only be handled<br />
properly with a set of collaborative classes that consider paths as<br />
they should be: something much more subtle than a raw string . Even<br />
worth, through win32 and .NET API, some standard path operations needs<br />
the underlying file or directory to exist while there is no valid<br />
reason for that! We developed a library to handle common paths<br />
operations and we made it <a href="/blogs/patricksmacchia/archive/2007/10/18/a-free-library-to-handle-common-path-operation.aspx" target="_blank">free</a>.  Its main flaw is that strict UNC path aren’t handled so far. We hope to fix that in the mid-term.</p>
<h3>Windows 64bits</h3>
<p>Most of .NET programmers thing that compiling with the AnyCPU<br />
options will make their .NET program works on both 32bits and 64bits<br />
Windows. This is true only if you are not using unsafe code (i.e<br />
pointers). If you are using unsafe code the options are twofold:<br />
1) Compile under x86 mode only or<br />
2) Compile under x86 mode and x64, then you have 2 redistributables one 32bits one for 64bits<br />
Option<br />
1) forces Windows 64 bits to trigger Wow64 (Windows on Windows 64),<br />
i.e, to run in 32 bits mode on a 64bits processor. For example<br />
VisualStudio runs on Wow64 and this is why there is only one<br />
installation that suits both 32bits and 64bits Windows.<br />
With<br />
option 2) the JIT compiler can target faster 64bits instructions. Thus<br />
option 2) is recommended to harness the 64bits CPU architecture power.<br />
Note that I am not a 64bits expert and what I wrote is my understanding<br />
of the concern after crawling a lot of resources and doing plenty of<br />
experiments on many machines.</p>
<h3>Windows Compatibility Application Manifest</h3>
<p>Windows Vista and 7 comes with a special compatibility mode,<br />
execution compatibility to older versions of Window. Concretely<br />
right-click an executable, click properties, click compatibility tab,<br />
and choose your compatibility mode. The compatibility mode of each<br />
executable is stored in the registry. Compatibility can be a source of<br />
problems for .NET programmers that want to target XP, Vista and 7.<br />
Windows might popup a pesky &#8220;<em>This program might not have installed correctly</em>&#8221;<br />
popup windows each time your program run. To avoid any problem, you can<br />
declare your application compatible with Vista and 7. The declaration<br />
is made in the app.manifest file as described here <a href="http://www.codenamewindows.com/?p=58" target="_blank">Windows 7 Application Compatibility Manifest Will Impact Windows 8</a>. Notice that only executable assemblies can have an <em>app.manifest</em> file, library assemblies cannot have an <em>app.manifest </em>file. As explained, there is not yet any way to prevent the pesky popup on future versions of Windows.</p>
<h3>Font</h3>
<p>You shouldn’t rely on any font family in your code, unless you check<br />
its availability and have code that can run well even if the font<br />
family is not available. You can also install the targeted font family<br />
at install time (beware here, many Font family are patented). One<br />
problem is that most of developer machine have Office installed and<br />
Office comes with a lot of installed font. We tend to forget that on a<br />
naked Windows machine (without Office) most of font families are not<br />
available. In our team, we used to rely on the very convenient Arial<br />
Narrow that is only installed with Office. Arial Narrow is convenient<br />
because it displays smoothly more text on less width. So far, using <a href="http://en.wikipedia.org/wiki/MS_Sans_Serif" target="_blank">MS sans serif </a>as default font family if another font family is N/A seems a seamless choice.</p>
<h3>Environment Variable</h3>
<p>We discovered the hard way that even the most basic environment<br />
variable such as Application Data aren’t rock solid. Some of NDepend<br />
users reported bugs about non-defined mainstream environment variable.<br />
So don’t assert that such code will return you a non-empty string.</p>
<h3>DPI</h3>
<p>This one concerns GDI+ and WinForm developers. WPF handles<br />
that nicely. Windows has a customizable DPI mode (Dot Per Inch). The<br />
setting 96 DPI is the default one and all applications work fine with<br />
96 DPI. However, some laptop users prefer having a higher DPI value,<br />
120 typically. And here comes problem because then there are chances<br />
that your Window Forms and GDI+ code displays poorly. So think about<br />
testing your code. Unfortunately, you’ll figure out that some third<br />
party Window Forms and GDI+ library doesn’t handle well higher DPI<br />
mode, and then you’ll feel pretty stuck if you already invested too<br />
much in such library! Btw, more info on DPI mode are available here <a href="http://blogs.msdn.com/fontblog/archive/2005/11/08/490490.aspx" target="_blank">Where does 96 DPI come from in Windows</a>?</p>
<h3>Blocked DLL and EXE</h3>
<p>The last unexpected problems we discover is described here: <a href="/blogs/patricksmacchia/archive/2010/03/12/visual-studio-addin-failed-to-load.aspx" target="_blank">Visual Studio Addin failed to load</a>.<br />
On Windows 7 if you download a zip file with Internet Explorer and<br />
unzip it with Windows zip, dll and exe files unzipped will be marked as<br />
blocked by Windows. Starting a blocked exe lead to a Windows popup<br />
asking the user if she confirms that this exe is harmless. But when it comes<br />
to a blocked VS addin DLL, VS 2010 just cannot load the addin and<br />
display a completely non-informative error popup. Hopefully we found this<br />
convenient library that shows how to unblock a dll or exe<br />
programatically <a href="http://www.codeproject.com/KB/cs/ntfsstreams.aspx" target="_blank">NtfsStream</a>.</p>
<p><a class="a2a_dd" href="http://www.addtoany.com/share_save"><img src="http://static.addtoany.com/buttons/share_save_171_16.png" border="0" alt="Share/Bookmark" width="171" height="16" /></a></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/patricksmacchia/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/patricksmacchia/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma/" title="Permalink to Windows programming: The &quot;it works on my machine&quot; syndroma" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/patricksmacchia/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma/feed/" title="Comments RSS to Windows programming: The &quot;it works on my machine&quot; syndroma" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-160 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/patricksmacchia/2010/03/12/visual-studio-addin-failed-to-load/" rel="prev"><span class="meta-nav">&larr;</span> Visual Studio Addin failed to load</a></div>
					<div class="nav-next"><a href="http://codebetter.com/patricksmacchia/2010/04/13/measuring-an-interesting-fact/" rel="next">Measuring an Interesting Fact <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-927">
					<div id="dsq-comment-header-927" class="dsq-comment-header">
						<cite id="dsq-cite-927">
	http://www.partario.com/blog/							<span id="dsq-author-user-927">Tim Robinson</span>
							</cite>
					</div>
					<div id="dsq-comment-body-927" class="dsq-comment-body">
						<div id="dsq-comment-message-927" class="dsq-comment-message"><p>&#8220;Since Vista, program configuration files shouldn’t live side-by-side under the folder %ProgramFiles%\MyProgram&#8221; &#8211; the rule was the same on NT/2000/XP. What changed in Vista was that users stopped running as admins by default.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-928">
					<div id="dsq-comment-header-928" class="dsq-comment-header">
						<cite id="dsq-cite-928">
	http://codebetter.com/members/JeremyJeanson/default.aspx							<span id="dsq-author-user-928">JeremyJeanson</span>
							</cite>
					</div>
					<div id="dsq-comment-body-928" class="dsq-comment-body">
						<div id="dsq-comment-message-928" class="dsq-comment-message"><p>100% agree with you,</p>
<p>Same combat with &#8220;it works on my network&#8221;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-929">
					<div id="dsq-comment-header-929" class="dsq-comment-header">
						<cite id="dsq-cite-929">
	http://kozmic.pl							<span id="dsq-author-user-929">Krzysztof Kozmic</span>
							</cite>
					</div>
					<div id="dsq-comment-body-929" class="dsq-comment-body">
						<div id="dsq-comment-message-929" class="dsq-comment-message"><p>Very nice post, touching very important issues.</p>
<p>I would also mention all kinds of l10n/i18n issues. As someone living in Poland, I often encounter issues with software that does not take input in correct format (for example we use comma as decimal separator, not a dot) or does not accept standard Polish date format etc. Thing is .NET support for l10n is not that bad &#8211; awareness on the other hand, is very low.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-930">
					<div id="dsq-comment-header-930" class="dsq-comment-header">
						<cite id="dsq-cite-930">
	http://codebetter.com/members/Patrick-Smacchia/default.aspx							<span id="dsq-author-user-930">Patrick Smacchia</span>
							</cite>
					</div>
					<div id="dsq-comment-body-930" class="dsq-comment-body">
						<div id="dsq-comment-message-930" class="dsq-comment-message"><p>Krzysztof , sure localization is also a big pain relative to &#8216;it works on my machine&#8217;. I avoid mentionning it since:</p>
<p>1) it is a vast topic in itself that I hope most of .NET programmer are somehow aware of</p>
<p>2) .NEt Fx has (IMHO) pretty good support for  localization, this was taken account since its inception</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-931">
					<div id="dsq-comment-header-931" class="dsq-comment-header">
						<cite id="dsq-cite-931">
	http://www.sadev.co.za							<span id="dsq-author-user-931">Robert MacLean</span>
							</cite>
					</div>
					<div id="dsq-comment-body-931" class="dsq-comment-body">
						<div id="dsq-comment-message-931" class="dsq-comment-message"><p>Excellent post &#8211; this should really become a cheat sheet that can be printed out and put on the wall to remind people.</p>
<p>The file library you mentioned, will that ever be made publicly available?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-932">
					<div id="dsq-comment-header-932" class="dsq-comment-header">
						<cite id="dsq-cite-932">
								<span id="dsq-author-user-932">Mike Lawton</span>
							</cite>
					</div>
					<div id="dsq-comment-body-932" class="dsq-comment-body">
						<div id="dsq-comment-message-932" class="dsq-comment-message"><p>Excellent summation.  I&#8217;d also add a hybrid of the folder protection and the 64 bit items:  silent redirection by the OS.  </p>
<p>Sometimes files that purport to be in subdirectories of Program Files, don&#8217;t actually exist there&#8230; they just appear to.  They actually exist under the user&#8217;s appdata folder, unless you physically move them. </p>
<p>The OS lies to you, ostensibly for your own good.  This caused me no end of pain in dealing with storing application-wide settings for windows services, until I finally got wise and moved the file locations.  </p>
<p>There are also some registry redirections too&#8230;. but I&#8217;ve mostly seen them in x64 scenarios.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-933">
					<div id="dsq-comment-header-933" class="dsq-comment-header">
						<cite id="dsq-cite-933">
	http://codebetter.com/members/Patrick-Smacchia/default.aspx							<span id="dsq-author-user-933">Patrick Smacchia</span>
							</cite>
					</div>
					<div id="dsq-comment-body-933" class="dsq-comment-body">
						<div id="dsq-comment-message-933" class="dsq-comment-message"><p>Robert, so far we kept the file access library private, mostly because we haven&#8217;t taken the time yet to pack it nicely as we did for the path API. But this will certainly happen in the future.</p>
<p>Mike, I didn&#8217;t talk about registry because we don&#8217;t use it and I would recommend to not use it to any .NET programmer. I am not surprised that Windows does odd redirections on registry.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-934">
					<div id="dsq-comment-header-934" class="dsq-comment-header">
						<cite id="dsq-cite-934">
	http://sergiopereira.com/blog							<span id="dsq-author-user-934">Sergio Pereira</span>
							</cite>
					</div>
					<div id="dsq-comment-body-934" class="dsq-comment-body">
						<div id="dsq-comment-message-934" class="dsq-comment-message"><p>Registry redirection can definitely be painful. It has bitten me at least twice: <a href="http://devlicio.us/blogs/sergio_pereira/archive/2010/03/12/dottrace-3-1-64-bit-disabled-inside-visual-studio-2008.aspx" rel="nofollow">http://devlicio.us/blogs/sergio_pereira/archive/2010/03/12/dottrace-3-1-64-bit-disabled-inside-visual-studio-2008.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-935">
					<div id="dsq-comment-header-935" class="dsq-comment-header">
						<cite id="dsq-cite-935">
	http://www.tavaresstudios.com							<span id="dsq-author-user-935">Chris Tavares</span>
							</cite>
					</div>
					<div id="dsq-comment-body-935" class="dsq-comment-body">
						<div id="dsq-comment-message-935" class="dsq-comment-message"><p>You have to be careful about the TryParse analogy when dealing with files. The file system is a global resource, and the state can and will change between the time you check and the time you try something. So you can do the File.Exists check first, of course, but if you really want to be bulletproof you need to handle the FileNotFoundException anyway &#8211; some other process could have deleted the file out from under you or locked it or something.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-936">
					<div id="dsq-comment-header-936" class="dsq-comment-header">
						<cite id="dsq-cite-936">
	http://codebetter.com/members/Patrick-Smacchia/default.aspx							<span id="dsq-author-user-936">Patrick Smacchia</span>
							</cite>
					</div>
					<div id="dsq-comment-body-936" class="dsq-comment-body">
						<div id="dsq-comment-message-936" class="dsq-comment-message"><p>Chris, indeed you are right. Our strategy is to have accurate controls over the TryXXX and we also have a coarse strategy for exception handling. This works well since we experiment that files changing in the middle of an operation is something that almost never happen (in the context of what NDepend does).</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-937">
					<div id="dsq-comment-header-937" class="dsq-comment-header">
						<cite id="dsq-cite-937">
								<span id="dsq-author-user-937">Alan McFarlane</span>
							</cite>
					</div>
					<div id="dsq-comment-body-937" class="dsq-comment-body">
						<div id="dsq-comment-message-937" class="dsq-comment-message"><p>Very good list.</p>
<p>BTW a space has crept into the fontblog hyperlink, it needs removed (s/%20&#8243;/&#8221;/) to not be 404.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-938">
					<div id="dsq-comment-header-938" class="dsq-comment-header">
						<cite id="dsq-cite-938">
	http://www.mariopareja.com/blog							<span id="dsq-author-user-938">Mario Pareja</span>
							</cite>
					</div>
					<div id="dsq-comment-body-938" class="dsq-comment-body">
						<div id="dsq-comment-message-938" class="dsq-comment-message"><p>Patrick,</p>
<p>This is a great list of gotchas.  I&#8217;m glad you took the time to recall and put up such valuable information.</p>
<p>Mario</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-939">
					<div id="dsq-comment-header-939" class="dsq-comment-header">
						<cite id="dsq-cite-939">
	http://codebetter.com/members/Patrick-Smacchia/default.aspx							<span id="dsq-author-user-939">Patrick Smacchia</span>
							</cite>
					</div>
					<div id="dsq-comment-body-939" class="dsq-comment-body">
						<div id="dsq-comment-message-939" class="dsq-comment-message"><p>Link fixed, thanks Alan!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-1124">
					<div id="dsq-comment-header-1124" class="dsq-comment-header">
						<cite id="dsq-cite-1124">
	http://www.best-registrycleaner.net							<span id="dsq-author-user-1124">Best Registry Cleaner</span>
							</cite>
					</div>
					<div id="dsq-comment-body-1124" class="dsq-comment-body">
						<div id="dsq-comment-message-1124" class="dsq-comment-message"><p>Excellent post &#8211; this should really become a cheat sheet that can be printed out and put on the wall to remind people.</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/patricksmacchia/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma/ ';
	var disqus_identifier = '160 /blogs/patricksmacchia/archive/2010/04/06/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetter';
	var disqus_title = "Windows programming: The &quot;it works on my machine&quot; syndroma";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=160');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/patricksmacchia/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/patricksmacchia\/2010\/04\/06\/windows-programming-the-quot-it-works-on-my-machine-quot-syndroma\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.271 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-26 18:52:38 -->
<!-- super cache -->