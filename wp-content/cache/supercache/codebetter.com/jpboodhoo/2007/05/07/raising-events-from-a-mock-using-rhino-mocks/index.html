<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Raising events (from a mock) using Rhino Mocks | Jean-Paul S. Boodhoo</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jpboodhoo/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jpboodhoo/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Jean-Paul S. Boodhoo' href='http://codebetter.com/jpboodhoo/' />
<link rel='start' title='Greetings' href='http://codebetter.com/jpboodhoo/2007/03/20/greetings/' />
<link rel='prev' title='Nothin But .Net &#8211; The destination is the journey' href='http://codebetter.com/jpboodhoo/2007/05/02/nothin-but-net-the-destination-is-the-journey/' />
<link rel='next' title='It&#8217;s comments like this that just make your day!!' href='http://codebetter.com/jpboodhoo/2007/05/10/it-s-comments-like-this-that-just-make-your-day/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/' />
<link rel='shortlink' href='http://codebetter.com/jpboodhoo/?p=23' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-23" class="post-23 post type-post status-publish format-standard hentry category-net-2-0 category-c category-featured">
					<h1 class="entry-title">Raising events (from a mock) using Rhino Mocks</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jpboodhoo/author/jpboodhoo/" title="View all posts by jpboodhoo">jpboodhoo</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/" title="5:09 pm" rel="bookmark"><span class="entry-date">May 7, 2007</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jpboodhoo/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jpboodhoo/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>I was just asked a question that I thought I would share with everyone in the event that it actually might help anyone else out.</p>
<p>The question was in regards to how (in a unit test) I can have a mock object raise an event when using Rhino Mocks. The particular case in question is to verify that a presenter actually consumes and handles&nbsp;an event published and broadcasted by a view.</p>
<p>Let&rsquo;s write a test to first encapsulate the requirement that a presenter should subscribe to a particular event of the view interface in the presenters constructor. I have a ReSharper file template that sets me up a MockTestFixture with the following structure:&nbsp;</p>
<pre>
<div><span>using</span><span> MbUnit.Framework;
</span><span>using</span><span> Rhino.Mocks;

</span><span>namespace</span><span><font color="#0000ff"> </font>NothinButDotNetStore.Test.Presentation
{
    [TestFixture]
    </span><span>public</span><span> </span><span>class</span><span> EmployeeBrowserPresenterTest
    {
        </span><span>private</span><span> MockRepository mockery;

        [SetUp]
        </span><span>public</span><span> </span><span>void</span><span> Setup()
        {
            mockery </span><span>=</span><span> </span><span>new</span><span> MockRepository();
        }

        [TearDown]
        </span><span>public</span><span> </span><span>void</span><span> TearDown()
        {
            mockery.VerifyAll();
        }

    }
}</span></div>
</pre>
<p>I am making use of MbUnit and Rhino Mocks. MbUnit for unit testing and Rhino Mocks as my mock object framework. You&rsquo;ll notice that I create a MockRepository in the SetUp method and I call VerifyAll in the teardown method. This ensures that I never forget to make the call to VerifyAll as I never need to explicitly call it in any of my test methods.</p>
<p>Let&rsquo;s get to that first test:</p>
<pre>
<div><span>        [Test]
        </span><span>public</span><span> </span><span>void</span><span> Construction_ShouldSubscribeToEventsOnView()
        {
            IEmployeeBrowserView mockView </span><span>=</span><span> mockery.CreateMock</span><span>&lt;</span><span>IEmployeeBrowserView</span><span>&gt;</span><span>();
            mockView.Initialize </span><span>+=</span><span> </span><span>null</span><span>;
            LastCall.Constraints(Is.NotNull());
            mockery.ReplayAll();

            </span><span>new</span><span> EmployeeBrowserPresenter(mockView);
        }
</span></div>
</pre>
<p>The 2 most important lines in this test are the following:&nbsp;</p>
<pre>
<div><span>mockView.Initialize </span><span>+=</span><span> </span><span>null</span><span>;
LastCall.Constraints(Is.NotNull());
</span></div>
</pre>
<p>These two lines make up the requirement that:</p>
<ul>
<li>At some point in running this test, the object under test better subscribe to the Initialize event on the view with a Non-Null event handler.</li>
</ul>
<p>Here is the initial code for the EmployeeBrowserPresenter:&nbsp;</p>
<pre>
<div><span>    </span><span>public</span><span> </span><span>class</span><span> EmployeeBrowserPresenter : IEmployeeBrowserPresenter
    {
        </span><span>private</span><span> IEmployeeBrowserView view;

        </span><span>public</span><span> EmployeeBrowserPresenter(IEmployeeBrowserView view)
        {

        }

    }
</span></div>
</pre>
<p>The view interface looks as follows:&nbsp;</p>
<pre>
<div><span>    </span><span>public</span><span> </span><span>interface</span><span> IEmployeeBrowserView
    {
        </span><span>event</span><span> EventHandler Initialize;
    }
</span></div>
</pre>
<p>If I were to run this test right now it would fail, because there is nowhere in the constructor of the presenter that it is subscribing to the events exposed by the view. To get the test running and passing I&rsquo;ll have to add the following code:</p>
<p>&nbsp;</p>
<pre>
<div><span>    </span><span>public</span><span> </span><span>class</span><span> EmployeeBrowserPresenter : IEmployeeBrowserPresenter
    {
        </span><span>private</span><span> IEmployeeBrowserView view;

        </span><span>public</span><span> EmployeeBrowserPresenter(IEmployeeBrowserView view)
        {
            </span><span>this</span><span>.view </span><span>=</span><span> view;
            HookupEventHandlersTo(view);
        }

        </span><span>private</span><span> </span><span>void</span><span> HookupEventHandlersTo(IEmployeeBrowserView view)
        {
            view.Initialize </span><span>+=</span><span> </span><span>delegate</span><span> { };
        }
    }
</span></div>
</pre>
<p>You can see that in the constructor, the presenter now subscribes to the Initialize method with a non null event handler (in this case an empty anonymous method). This gets my test passing. Now I need to write a separate test to verify that the presenter actually does something when the event is raised. Because I will be creating the presenter for each test, each test would need to setup the expecation for the event subscription. I don&rsquo;t want to duplicate my efforts so I will move some code to the setup method. This will cause my test class to look as follows:</p>
<p>&nbsp;</p>
<pre>
<div><span>    [TestFixture]
    </span><span>public</span><span> </span><span>class</span><span> EmployeeBrowserPresenterTest
    {
        </span><span>private</span><span> MockRepository mockery;
        </span><span>private</span><span> IEmployeeBrowserView mockView;

        [SetUp]
        </span><span>public</span><span> </span><span>void</span><span> Setup()
        {
            mockery </span><span>=</span><span> </span><span>new</span><span> MockRepository();
            mockView </span><span>=</span><span> mockery.CreateMock</span><span>&lt;</span><span>IEmployeeBrowserView</span><span>&gt;</span><span>();
            mockView.Initialize </span><span>+=</span><span> </span><span>null</span><span>;
            LastCall.Constraints(Is.NotNull());
        }

        [TearDown]
        </span><span>public</span><span> </span><span>void</span><span> TearDown()
        {
            mockery.VerifyAll();
        }

        [Test]
        </span><span>public</span><span> </span><span>void</span><span> Construction_ShouldSubscribeToEventsOnView()
        {
            mockery.ReplayAll();
            </span><span>new</span><span> EmployeeBrowserPresenter(</span><span>this</span><span>.mockView);
        }
    }
</span></div>
</pre>
<p>Now I can write the test to ensure that the presenter does something when the view raises its Initialized event. For arguments sake, let&rsquo;s have the presenter Invoke a method on the view in response to handling the Initialize event:</p>
<pre>
<div><span>        [Test]
        </span><span>public</span><span> </span><span>void</span><span> ViewInitializationHandler_PresenterShouldPushMessageToView()
        {
            mockView.DisplayMessage(</span><span>null</span><span>);
            LastCall.Constraints(Is.NotNull());
            mockery.ReplayAll();

            IEmployeeBrowserPresenter presenter </span><span>=</span><span> </span><span>new</span><span> EmployeeBrowserPresenter(mockView);
            IEventRaiser eventRaiser </span><span>=</span><span> </span><span>new</span><span> EventRaiser((IMockedObject) mockView, </span><span>"</SPAN><SPAN style="color: #000000">Initialize</SPAN><SPAN style="color: #000000">"</span><span>);
            eventRaiser.Raise(</span><span>null</span><span>,</span><span>null</span><span>);
        }
</span></div>
</pre>
<p>Notice how I am leveraging the EventRaiser class to simulate the mock object raising an event. Unfortunately, using this approach defeats the purpose for using Rhino over NMock2 in the sense that you have to resort to providing the name of the event as a string. No good. Let&rsquo;s refactor this to eliminate the need for the string. I&rsquo;ll make a change to the Setup method as follows:</p>
<pre>
<div><span>        </span><span>private</span><span> IEventRaiser initializeEventRaiser;

        [SetUp]
        </span><span>public</span><span> </span><span>void</span><span> Setup()
        {
            mockery </span><span>=</span><span> </span><span>new</span><span> MockRepository();
            mockView </span><span>=</span><span> mockery.CreateMock</span><span>&lt;</span><span>IEmployeeBrowserView</span><span>&gt;</span><span>();
            mockView.Initialize </span><span>+=</span><span> </span><span>null</span><span>;
            LastCall.Constraints(Is.NotNull());
            initializeEventRaiser </span><span>=</span><span> LastCall.GetEventRaiser();
        }
</span></div>
</pre>
<p>Using LastCall.GetEventRaiser provides me a way to get access to an event raiser bound to a particular event on a mock object. The caveat is that you have to ensure that the previous mock object expectation (in this call mockView.Initialize += null) was an expectation on an event exposed by the interface. With this IEventRaiser in hand I can refactor my test as follows:</p>
<p>&nbsp;</p>
<pre>
<div><span>        [Test]
        </span><span>public</span><span> </span><span>void</span><span> ViewInitializationHandler_PresenterShouldPushMessageToView()
        {
            mockView.DisplayMessage(</span><span>null</span><span>);
            LastCall.Constraints(Is.NotNull());
            mockery.ReplayAll();

            IEmployeeBrowserPresenter presenter </span><span>=</span><span> </span><span>new</span><span> EmployeeBrowserPresenter(mockView);
            initializeEventRaiser.Raise(</span><span>null</span><span>,</span><span>null</span><span>);
        }
</span></div>
</pre>
<p>The Raise method expects a set of parameters that match up with the signature for the delegate type of the event. In this case the Initialize event on the view interface is an EventHandler delegate type. The EventHandler delegate is the basic event handler signature in the framework that takes a sender and an EventArgs. In this scenario, because my presenter does not care about either, I pass null for both. To get this test to pass I can write the following code on my presenter:</p>
<p>&nbsp;</p>
<pre>
<div><span>        </span><span>private</span><span> </span><span>void</span><span> HookupEventHandlersTo(IEmployeeBrowserView view)
        {
            view.Initialize </span><span>+=</span><span> </span><span>delegate</span><span> { view.DisplayMessage(DateTime.Now.ToString());};
        }
</span></div>
</pre>
<p>In the anonymous event handler, I have the presenter invoke the DisplayMessage method on the view, passing it the current time as a string. This satisfies the new requirement in the test:</p>
<pre>
<div><span>    mockView.DisplayMessage(</span><span>null</span><span>);
    LastCall.Constraints(Is.NotNull());</span></div>
</pre>
<p>Now you know how to raise events in a refactorable way using Rhino Mocks.</p>
<p>&nbsp;</p>
<p>Develop with passion!!</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jpboodhoo/category/net-2-0/" title="View all posts in .Net 2.0" rel="category tag">.Net 2.0</a>, <a href="http://codebetter.com/jpboodhoo/category/c/" title="View all posts in C#" rel="category tag">C#</a>, <a href="http://codebetter.com/jpboodhoo/category/featured/" title="View all posts in Featured" rel="category tag">Featured</a>. Bookmark the <a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/" title="Permalink to Raising events (from a mock) using Rhino Mocks" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/feed/" title="Comments RSS to Raising events (from a mock) using Rhino Mocks" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-23 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jpboodhoo/2007/05/02/nothin-but-net-the-destination-is-the-journey/" rel="prev"><span class="meta-nav">&larr;</span> Nothin But .Net &#8211; The destination is the journey</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jpboodhoo/2007/05/10/it-s-comments-like-this-that-just-make-your-day/" rel="next">It&#8217;s comments like this that just make your day!! <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">6 Responses to <em>Raising events (from a mock) using Rhino Mocks</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-36">
		<div id="comment-36">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://snarfy.joshua@gmail.com' rel='external nofollow' class='url'>Joshua Ramirez</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-36">October 13, 2008 at 7:08 pm</a></div>

		<div class="comment-body"><p>Thank you very much for the well written article. I&#8217;ve been learning mocking for an MVP web project I&#8217;m working on, and this was very helpful.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-35">
		<div id="comment-35">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">B-Rain</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-35">January 11, 2008 at 2:44 pm</a></div>

		<div class="comment-body"><p>Maybe a stupid question but what to do if i have multiple events to test. For example Initialize and,say, PostInitialize. How to test it. LastCall contains the last</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-34">
		<div id="comment-34">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Joakim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-34">June 22, 2007 at 2:21 pm</a></div>

		<div class="comment-body"><p>Just in case anyone is still wondering about what using&#8217;s are needed:</p>
<p>using Rhino.Mocks;<br />
using Rhino.Mocks.Constraints;<br />
using Rhino.Mocks.Interfaces;</p>
<p>However it crashed and burned quite well when I tried to run the test <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> </p>
<p>TestCase &#8216;PresentationLayer.Tests.MainPresenterFixture.Test&#8217;<br />
failed: System.Reflection.TargetParameterCountException : Parameter count mismatch.<br />
TearDown : System.Reflection.TargetInvocationException : Exception has been thrown by the target of an invocation.<br />
  &#8212;-> Rhino.Mocks.Exceptions.ExpectationViolationException : IMainView.set_Title(not equal to ); Expected #1, Actual #0.<br />
^Anyone know why?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-33">
		<div id="comment-33">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">irfan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-33">June 13, 2007 at 2:03 am</a></div>

		<div class="comment-body"><p>I downloaded the rhino mock. and tried to test my events.<br />
But could find the Interface of IEventRaiser.<br />
What could be the prob.<br />
the version of DLL is 3.1.0.584</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-32">
		<div id="comment-32">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jpboodhoo.com' rel='external nofollow' class='url'>Jean-Paul S. Boodhoo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-32">May 7, 2007 at 7:29 pm</a></div>

		<div class="comment-body"><p>Joshua, thanks for the tip. I usually explicitly call mocker.ReplayAll() in the tests that don&#8217;t leverage the MockRepository. This makes it a lot cleaner!!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31">
		<div id="comment-31">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://flimflan.com/blog' rel='external nofollow' class='url'>Joshua Flanagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#comment-31">May 7, 2007 at 7:02 pm</a></div>

		<div class="comment-body"><p>I picked up a nice tip from the first Hibernating Rhinos episode that Ayende put up: Add mockery.ReplayAll() just before the VerifyAll() in your Teardown. You still want to add the ReplayAll in the appropriate place in your test. Calling it twice does not hurt anything. However, if you fail to call ReplayAll (maybe one of your tests doesn&#8217;t use mocks), before calling VerifyAll, it will throw an exception (causing your test to fail).</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/jpboodhoo/2007/05/07/raising-events-from-a-mock-using-rhino-mocks/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/jpboodhoo/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fjpboodhoo%2F2007%2F05%2F07%2Fraising-events-from-a-mock-using-rhino-mocks%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.283 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 12:40:36 -->
<!-- super cache -->