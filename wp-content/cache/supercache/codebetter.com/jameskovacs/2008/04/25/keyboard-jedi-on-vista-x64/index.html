<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Keyboard Jedi on Vista x64 | James Kovacs</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jameskovacs/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/jameskovacs/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/jameskovacs/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jameskovacs/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/jameskovacs/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='James Kovacs' href='http://codebetter.com/jameskovacs/' />
<link rel='start' title='Cannucks Storm CodeBetter &#8211; News at Eleven' href='http://codebetter.com/jameskovacs/2007/12/19/cannucks-storm-codebetter-news-at-eleven/' />
<link rel='prev' title='altnetpedia Back in Business' href='http://codebetter.com/jameskovacs/2008/04/22/altnetpedia-back-in-business/' />
<link rel='next' title='DevTeach Toronto Coming Up Fast' href='http://codebetter.com/jameskovacs/2008/04/29/devteach-toronto-coming-up-fast/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/jameskovacs/2008/04/25/keyboard-jedi-on-vista-x64/' />
<link rel='shortlink' href='http://codebetter.com/jameskovacs/?p=15' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/jameskovacs/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetterjameskovacs/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/jameskovacs/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-15" class="post-15 post type-post status-publish format-standard hentry category-net category-featured">
					<h1 class="entry-title">Keyboard Jedi on Vista x64</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jameskovacs/author/jameskovacs/" title="View all posts by James Kovacs">James Kovacs</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jameskovacs/2008/04/25/keyboard-jedi-on-vista-x64/" title="11:53 am" rel="bookmark"><span class="entry-date">2008/04/25</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jameskovacs/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/jameskovacs/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jameskovacs/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>This morning I was getting ready to record a screencast about ReSharper 4 EAP. To make it easier for people to follow along, I launched <a href="http://weblogs.asp.net/rosherove/">Roy Osherove&#8217;s</a> excellent utility, <a href="http://weblogs.asp.net/rosherove/archive/2007/06/03/train-to-be-a-keyboard-master-with-keyboard-jedi.aspx">Keyboard Jedi</a>. Rather than the expected result, this friendly dialog box greeted me:</p>
<p><img style="border-bottom: 0px;border-left: 0px;border-top: 0px;border-right: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/james/kovacs/image_7C376881.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919992074&amp;Signature=UliTXIPB%2fkZfbUsw9Pxxmd4pJHU%3d" width="408" height="215" /> </p>
<h3>Living La Vida x64</h3>
<p>My main development machine is running Vista x64. I&#8217;ve used KeyJedi frequently on my Vista x86 laptop and never had a problem. So I immediately suspected a 64-bit compatibility issue. KeyJedi is a .NET 2.0 application, which means that it will execute on the 64-bit CLR if available. (The 64-bit CLR was introduced with .NET 2.0. You don&#8217;t have to do anything special. If you install .NET 2.0 or higher on 64-bit Windows, the 64-bit CLR is installed automatically.) The 64-bit CLR uses a 64-bit JIT compiler, which produces x64 (or IA64)* machine code. This is why things like Paint.NET&#8217;s Gaussian Blur, which involves a lot of 64-bit arithmetic, run faster on 64-bit Windows. The MSIL is identical, but on 64-bit platforms, the JIT produces 64-bit optimized code. For example, a 64-bit ADD can be done in a single instruction on 64-bit hardware, but requires multiple instructions on 32-bit. (N.B. If you&#8217;re running 32-bit Windows on 64-bit hardware, there is no way to access the 64-bit capabilities of the chip as the OS thinks it&#8217;s running on a 32-bit chip.)</p>
<p>* x64 is the 64-bit enhanced, x86-compatible instruction set introduced by AMD. IA64 is used by Intel&#8217;s Itanium processors and is incompatible with x86. So you have to recompile the world to use IA64. Once Intel realized that not everyone on the planet was willing to recompile their programs, they introduced EMT64 for the Pentiums and Core chips. EMT64 is functionally identical to x64 from AMD.</p>
<h3>WoW</h3>
<p>So on Vista x64, KeyJedi is running on the 64-bit CLR. But that doesn&#8217;t explain why it fails. Most programs, like Paint.NET, just work. What is KeyJedi doing that is special and incompatible with 64-bit Windows? It is registering global system hooks to capture keyboard and mouse messages. Registering hooks and receiving messages involves Win32 calls, which are handled by Michael Kennedy&#8217;s <a href="http://www.codeproject.com/KB/system/globalsystemhook.aspx">Global System Hooks in .NET library</a>. This library includes both managed (Kennedy.ManagedHooks.dll) and unmanaged (SystemHookCore.dll) code. SystemHookCore.dll makes 32-bit Win32 calls and receives 32-bit callbacks. You cannot make 32-bit Win32 calls directly to the 64-bit Windows kernel. You need a translation layer, which is the Windows-on-Windows or WoW layer.</p>
<p>The WoW layer marshals 32-bit Win32 calls to and from their 64-bit equivalent, translating data structures on the way in and out. This marvelous piece of magic is built into 64-bit Windows and allows most 32-bit programs to execute on 64-bit Windows without problem. The WoW layer sits below all 32-bit processes happily marshalling system calls back and forth. If you&#8217;re running in a 64-bit process, such as the 64-bit CLR host, there is no WoW layer beneath you. So you cannot load 32-bit DLL, such as SystemHookCore.dll. (This is also why 32-bit kernel-mode drivers don&#8217;t work on 64-bit Windows. There is no WoW layer in the kernel. It exists between user and kernel mode.)</p>
<p>Now we know the problem. The question is how to fix it. We could create a 64-bit version of SystemHookCore.dll, but that would involve a lot of spelunking and debugging of unmanaged C++ code. Not exactly how I want to spend my morning. The other option is to force KeyJedi to run on the 32-bit CLR even on 64-bit Windows. Then we would have the WoW layer beneath us and SystemHookCore.dll could merrily assume that it is running on 32-bit Windows while the WoW layer takes care of all the 32-bit to 64-bit Win32 marshalling. So how do we force a managed application to run on the 32-bit CLR&#8230;</p>
<h3>Any CPU vs. x86</h3>
<p>The easiest technique is to modify your project settings in Visual Studio. Just go to Project Properties&#8230; Build&#8230; Platform target and change it from Any CPU to x86.</p>
<p><img style="border-bottom: 0px;border-left: 0px;border-top: 0px;border-right: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/james/kovacs/image_743FC61F.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919992074&amp;Signature=170ojPVjiNBiDfMS32f6%2fZG0Kak%3d" width="609" height="468" /> </p>
<p>Now you might think, &quot;Wait a second. I&#8217;m compiling to MSIL, which is processor independent.&quot; Yes, you are, but when you select Any CPU (the default), your program will load on the 64-bit CLR if available. By selecting x86, you are forcing the program to run on the 32-bit CLR. Then just recompile your program and problem solved. Just one problem&#8230; Roy never released the source. (Yes, I&#8217;ve emailed Roy and asked him to do recompile with x86 as the target platform.)</p>
<h3>No Source, No Problem</h3>
<p>We don&#8217;t want to modify the application, just ask it to run on the 32-bit CLR. Turns out that the project settings above just twiddle the CORFLAGS inside the PE file header of the executable. The .NET Framework SDK ships with a program called corflags.exe for just this purpose:</p>
<p><img style="border-bottom: 0px;border-left: 0px;border-top: 0px;border-right: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/james/kovacs/image_2DE2600A.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919992074&amp;Signature=oKvHXhonLhTTJFeqAeqakLnnBvk%3d" width="673" height="228" /> </p>
<p>You&#8217;ll notice that 32BIT has a value of 0, which means Any CPU. We want to twiddle this to 1. One little problem. The assembly is signed. Twiddling even a single bit will invalidate the signature and the CLR loader will prevent the application from loading. If the assembly weren&#8217;t signed, you could just execute:</p>
<p>corflags KeyJedi.exe /32BIT+</p>
<h3>ILDASM to the Rescue</h3>
<p>Time to bring out the big guns. We&#8217;re going to disassemble KeyJedi.exe into MSIL. Hold onto your hats&#8230;</p>
<p>ildasm /all KeyJedi.exe /out=KeyJedi.il</p>
<p>This produces three files:</p>
<p>KeyJedi.il</p>
<p>KeyJedi.res</p>
<p>Osherove.KeyJedi.MainForm.resources</p>
<p>Time to hack some MSIL&#8230; Open KeyJedi.il in your text editor of choice and search for &quot;.corflags&quot;. Change the line to:</p>
<p>.corflags 0x0000000b&#160;&#160;&#160; //&#160; ILONLY 32BITREQUIRED</p>
<p>We can&#8217;t compile the code yet because we don&#8217;t have the private key that matches the public key embedded in the MSIL. Search for .publickey and delete it. (You could change it to your own public key generated with sn -k, but there&#8217;s no reason that we need to sign the assembly.) Now we can re-compile the MSIL using ilasm:</p>
<p>ilasm /res:KeyJedi.res KeyJedi.il /output:KeyJedi-x86.exe</p>
<p>If we execute KeyJedi-x86.exe, we get:</p>
<p><img style="border-bottom: 0px;border-left: 0px;border-top: 0px;border-right: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/james/kovacs/image_452D647B.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919992074&amp;Signature=Pcp5tx1h6eQEUEvj%2fM9AwWJyoOQ%3d" width="248" height="232" /> </p>
<p>Success!!! KeyJedi is now running on Vista x64.</p>
<h3>Postscript</h3>
<p>I&#8217;m not going to redistribute the recompiled binary because KeyJedi is Roy&#8217;s baby and the fix is really straightforward for him to make. Look to his blog for an update. My main purpose was to help people better understand 64-bit compatibility issues and some tricks that 64-bit Windows does so that, in most cases, you aren&#8217;t forced to recompile the world to run the programs you&#8217;ve come to depend on.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jameskovacs/category/net/" title="View all posts in .NET" rel="category tag">.NET</a>, <a href="http://codebetter.com/jameskovacs/category/featured/" title="View all posts in featured" rel="category tag">featured</a>. Bookmark the <a href="http://codebetter.com/jameskovacs/2008/04/25/keyboard-jedi-on-vista-x64/" title="Permalink to Keyboard Jedi on Vista x64" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jameskovacs/2008/04/25/keyboard-jedi-on-vista-x64/feed/" title="Comments RSS to Keyboard Jedi on Vista x64" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-15 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jameskovacs/2008/04/22/altnetpedia-back-in-business/" rel="prev"><span class="meta-nav">&larr;</span> altnetpedia Back in Business</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jameskovacs/2008/04/29/devteach-toronto-coming-up-fast/" rel="next">DevTeach Toronto Coming Up Fast <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-36">
					<div id="dsq-comment-header-36" class="dsq-comment-header">
						<cite id="dsq-cite-36">
	http://www.andrewvos.com							<span id="dsq-author-user-36">AndrewVos</span>
							</cite>
					</div>
					<div id="dsq-comment-body-36" class="dsq-comment-body">
						<div id="dsq-comment-message-36" class="dsq-comment-message"><p>Hmmm. Problem is, the hook will only work for 32bit apps now, or is that just the CALLWNDPROC hook?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-37">
					<div id="dsq-comment-header-37" class="dsq-comment-header">
						<cite id="dsq-cite-37">
	http://diditwith.net							<span id="dsq-author-user-37">Dustin Campbell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-37" class="dsq-comment-body">
						<div id="dsq-comment-message-37" class="dsq-comment-message"><p>This is great James, thanks! These instructions got me up and running in time for my presentation.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-38">
					<div id="dsq-comment-header-38" class="dsq-comment-header">
						<cite id="dsq-cite-38">
	http://www.andrewvos.com							<span id="dsq-author-user-38">AndrewVos</span>
							</cite>
					</div>
					<div id="dsq-comment-body-38" class="dsq-comment-body">
						<div id="dsq-comment-message-38" class="dsq-comment-message"><p>Sorry, maybe I should elaborate&#8230;</p>
<p>The library is compiled to 32 bit native, so:<br />
SetWindowsHookEx can be used to inject a DLL into another process. A 32-bit DLL cannot be injected into a 64-bit process, and a 64-bit DLL cannot be injected into a 32-bit process. If an application requires the use of hooks in other processes, a 32-bit application must call SetWindowsHookEx to inject a 32-bit DLL into 32-bit processes, and a 64-bit application must call SetWindowsHookEx to inject a 64-bit DLL into 64-bit processes. Also, the 32-bit and 64-bit DLLs must have different names.</p>
<p>Maybe I&#8217;m missing something?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-39">
					<div id="dsq-comment-header-39" class="dsq-comment-header">
						<cite id="dsq-cite-39">
	http://www.jameskovacs.com							<span id="dsq-author-user-39">james.kovacs</span>
							</cite>
					</div>
					<div id="dsq-comment-body-39" class="dsq-comment-body">
						<div id="dsq-comment-message-39" class="dsq-comment-message"><p>@Andrew &#8211; KeyJedi registers a global Windows hook for keyboard events. The quote from MSDN that you mention is applicable if you&#8217;re registering a hook DLL in another process. After registering the hook, we have the user press a key combination, which causes 64-bit Windows to execute a callback, which is intercepted by the WoW layer (since it&#8217;s a 32-bit process), which is received by the 32-bit SystemHookCore.dll (Kennedy), which is relayed to the registered callback function in KeyJedi. To verify that KeyJedi can receive keystrokes destined for 64-bit apps, I launched Paint.NET, which ran in a 64-bit process (confirmed with sysinternals&#8217; Process Explorer), and then typed while Paint.NET had focus. KeyJedi displayed the keystrokes as expected.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-40">
					<div id="dsq-comment-header-40" class="dsq-comment-header">
						<cite id="dsq-cite-40">
	http://www.andrewvos.com							<span id="dsq-author-user-40">AndrewVos</span>
							</cite>
					</div>
					<div id="dsq-comment-body-40" class="dsq-comment-body">
						<div id="dsq-comment-message-40" class="dsq-comment-message"><p>Ahh ok, so it&#8217;s using a low level keyboard hook then.<br />
Wonder why they used a native c++ hook library then, this can be done in pure .net.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-41">
					<div id="dsq-comment-header-41" class="dsq-comment-header">
						<cite id="dsq-cite-41">
	http://www.jameskovacs.com							<span id="dsq-author-user-41">james.kovacs</span>
							</cite>
					</div>
					<div id="dsq-comment-body-41" class="dsq-comment-body">
						<div id="dsq-comment-message-41" class="dsq-comment-message"><p>@Andrew &#8211; As far as I know, you can hook keyboard events within your process, but not globally from .NET. If you can hook the keyboard globally just from .NET, how do you do it? I might have missed that addition to the BCL as it has grown rather large in recent years. (I&#8217;m always willing to learn a new trick!)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-42">
					<div id="dsq-comment-header-42" class="dsq-comment-header">
						<cite id="dsq-cite-42">
	http://www.andrewvos.com							<span id="dsq-author-user-42">AndrewVos</span>
							</cite>
					</div>
					<div id="dsq-comment-body-42" class="dsq-comment-body">
						<div id="dsq-comment-message-42" class="dsq-comment-message"><p>Sorry, by &#8220;pure .net&#8221; I mean with the use of PInvoke <img src='http://codebetter.com/jameskovacs/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>A MOUSE_LL or keyboard_LL hook can be used in .net. Plenty of code samples online, if you want to have a look.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-43">
					<div id="dsq-comment-header-43" class="dsq-comment-header">
						<cite id="dsq-cite-43">
	http://www.jameskovacs.com							<span id="dsq-author-user-43">james.kovacs</span>
							</cite>
					</div>
					<div id="dsq-comment-body-43" class="dsq-comment-body">
						<div id="dsq-comment-message-43" class="dsq-comment-message"><p>@Andrew &#8211; Michael Kennedy&#8217;s &#8220;Global System Hooks in .NET library&#8221; article (linked to above) explains why he needs the unmanaged C++ code. (cf. 2nd paragraph of &#8220;Building the Library&#8221;) I haven&#8217;t looked into it enough to know whether you can do it solely from managed code using just P/Invoke.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-44">
					<div id="dsq-comment-header-44" class="dsq-comment-header">
						<cite id="dsq-cite-44">
								<span id="dsq-author-user-44">Tom Waltz</span>
							</cite>
					</div>
					<div id="dsq-comment-body-44" class="dsq-comment-body">
						<div id="dsq-comment-message-44" class="dsq-comment-message"><p>Thanks for the great information James.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-45">
					<div id="dsq-comment-header-45" class="dsq-comment-header">
						<cite id="dsq-cite-45">
	http://www.ring3circus.com							<span id="dsq-author-user-45">Greg Jenkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-45" class="dsq-comment-body">
						<div id="dsq-comment-message-45" class="dsq-comment-message"><p>Excellent article &#8211; sorted out my Qliner hotkeys in no time <img src='http://codebetter.com/jameskovacs/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-46">
					<div id="dsq-comment-header-46" class="dsq-comment-header">
						<cite id="dsq-cite-46">
	http://www.michaelckennedy.net/							<span id="dsq-author-user-46">Michael Kennedy</span>
							</cite>
					</div>
					<div id="dsq-comment-body-46" class="dsq-comment-body">
						<div id="dsq-comment-message-46" class="dsq-comment-message"><p>Hey James! Good job tracking that issue down. When I wrote that library back in 2004, 64-bit was this weird thing that happened on high-end servers. It&#8217;s certainly becoming more of an issue. Thanks for the detailed info for all the users of Keyboard Jedi and my hook library.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-47">
					<div id="dsq-comment-header-47" class="dsq-comment-header">
						<cite id="dsq-cite-47">
								<span id="dsq-author-user-47">Maksymilian Majer</span>
							</cite>
					</div>
					<div id="dsq-comment-body-47" class="dsq-comment-body">
						<div id="dsq-comment-message-47" class="dsq-comment-message"><p>Simple and brilliant solution. Thanks for this <img src='http://codebetter.com/jameskovacs/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/jameskovacs/2008/04/25/keyboard-jedi-on-vista-x64/ ';
	var disqus_identifier = '15 /blogs/james.kovacs/archive/2008/04/25/keyboard-jedi-on-vista-x64.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetterjameskovacs';
	var disqus_title = "Keyboard Jedi on Vista x64";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=15');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/jameskovacs/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/jameskovacs\/2008\/04\/25\/keyboard-jedi-on-vista-x64\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.256 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-24 13:02:40 -->
<!-- super cache -->