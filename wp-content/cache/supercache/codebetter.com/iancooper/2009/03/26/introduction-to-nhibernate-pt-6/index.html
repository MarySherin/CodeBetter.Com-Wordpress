<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Introduction to NHibernate, pt. 6 | Ian Cooper</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/iancooper/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/iancooper/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/iancooper/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/iancooper/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/iancooper/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Ian Cooper' href='http://codebetter.com/iancooper/' />
<link rel='start' title='Hello World' href='http://codebetter.com/iancooper/2007/11/17/hello-world-2/' />
<link rel='prev' title='Introduction to NHibernate, pt.5' href='http://codebetter.com/iancooper/2009/03/22/introduction-to-nhibernate-pt-5/' />
<link rel='next' title='Seizing the BDD Nettle' href='http://codebetter.com/iancooper/2009/03/31/seizing-the-bdd-nettle/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/iancooper/2009/03/26/introduction-to-nhibernate-pt-6/' />
<link rel='shortlink' href='http://codebetter.com/iancooper/?p=59' />
<link rel="stylesheet" href="http://codebetter.com/iancooper/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetteriancooper/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/iancooper/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-59" class="post-59 post type-post status-publish format-standard hentry category-nhibernate category-orm">
					<h1 class="entry-title">Introduction to NHibernate, pt. 6</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/iancooper/author/iancooper/" title="View all posts by Ian Cooper">Ian Cooper</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/iancooper/2009/03/26/introduction-to-nhibernate-pt-6/" title="8:55 am" rel="bookmark"><span class="entry-date">March 26, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/iancooper/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/iancooper/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/iancooper/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>Last time we looked at <a href="/blogs/ian_cooper/archive/2009/03/22/introduction-to-nhibernate-pt-5.aspx">mapping value types and user defined types</a>. This time I want to look at sessions. Understanding sessions is one of the challenges for any developers approaching ORMs for the first time, because they can represent a new way of thinking about interaction with the Db.</p>
<p><!--[if gte mso 9]&gt;--></p>
<p>  Normal<br />
  0</p>
<p>  false<br />
  false<br />
  false</p>
<p>  EN-GB<br />
  X-NONE<br />
  X-NONE</p>
<p>  MicrosoftInternetExplorer4</p>
<p><!--[if gte mso 9]&gt;--></p>
<p><!--[if !mso]&gt;--></p>
<p>st1\:*{behavior:url(#ieooui) }</p>
<p>&lt;!&#8211;<br />
 /* Font Definitions */<br />
 @font-face<br />
	{font-family:Wingdings;<br />
	panose-1:5 0 0 0 0 0 0 0 0 0;<br />
	mso-font-charset:2;<br />
	mso-generic-font-family:auto;<br />
	mso-font-pitch:variable;<br />
	mso-font-signature:0 268435456 0 0 -2147483648 0;}<br />
@font-face<br />
	{font-family:&#8221;Cambria Math&#8221;;<br />
	panose-1:2 4 5 3 5 4 6 3 2 4;<br />
	mso-font-charset:0;<br />
	mso-generic-font-family:roman;<br />
	mso-font-pitch:variable;<br />
	mso-font-signature:-1610611985 1107304683 0 0 159 0;}<br />
@font-face<br />
	{font-family:Calibri;<br />
	panose-1:2 15 5 2 2 2 4 3 2 4;<br />
	mso-font-charset:0;<br />
	mso-generic-font-family:swiss;<br />
	mso-font-pitch:variable;<br />
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}<br />
 /* Style Definitions */<br />
 p.MsoNormal, li.MsoNormal, div.MsoNormal<br />
	{mso-style-update:auto;<br />
	mso-style-unhide:no;<br />
	mso-style-qformat:yes;<br />
	mso-style-parent:&#8221;";<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	mso-outline-level:3;<br />
	font-size:10.0pt;<br />
	mso-bidi-font-size:12.0pt;<br />
	font-family:&#8221;Calibri&#8221;,&#8221;sans-serif&#8221;;<br />
	mso-fareast-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-weight:bold;}<br />
h3<br />
	{mso-style-update:auto;<br />
	mso-style-unhide:no;<br />
	mso-style-qformat:yes;<br />
	mso-style-link:&#8221;Heading 3 Char&#8221;;<br />
	mso-style-next:Normal;<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	page-break-after:avoid;<br />
	mso-outline-level:3;<br />
	font-size:11.0pt;<br />
	mso-bidi-font-size:13.0pt;<br />
	font-family:&#8221;Arial&#8221;,&#8221;sans-serif&#8221;;<br />
	mso-ansi-language:EN-US;<br />
	mso-fareast-language:EN-US;<br />
	mso-bidi-font-weight:normal;}<br />
h4<br />
	{mso-style-update:auto;<br />
	mso-style-unhide:no;<br />
	mso-style-qformat:yes;<br />
	mso-style-link:&#8221;Heading 4 Char&#8221;;<br />
	mso-style-next:Normal;<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	page-break-after:avoid;<br />
	mso-outline-level:4;<br />
	font-size:10.0pt;<br />
	mso-bidi-font-size:14.0pt;<br />
	font-family:&#8221;Arial&#8221;,&#8221;sans-serif&#8221;;<br />
	mso-bidi-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-ansi-language:EN-US;<br />
	mso-fareast-language:EN-US;<br />
	mso-bidi-font-weight:normal;<br />
	text-decoration:underline;<br />
	text-underline:single;}<br />
span.Heading3Char<br />
	{mso-style-name:&#8221;Heading 3 Char&#8221;;<br />
	mso-style-unhide:no;<br />
	mso-style-locked:yes;<br />
	mso-style-link:&#8221;Heading 3&#8243;;<br />
	mso-ansi-font-size:11.0pt;<br />
	mso-bidi-font-size:13.0pt;<br />
	font-family:&#8221;Arial&#8221;,&#8221;sans-serif&#8221;;<br />
	mso-ascii-font-family:Arial;<br />
	mso-hansi-font-family:Arial;<br />
	mso-bidi-font-family:Arial;<br />
	mso-ansi-language:EN-US;<br />
	mso-fareast-language:EN-US;<br />
	font-weight:bold;<br />
	mso-bidi-font-weight:normal;}<br />
span.Heading4Char<br />
	{mso-style-name:&#8221;Heading 4 Char&#8221;;<br />
	mso-style-unhide:no;<br />
	mso-style-locked:yes;<br />
	mso-style-link:&#8221;Heading 4&#8243;;<br />
	mso-bidi-font-size:14.0pt;<br />
	font-family:&#8221;Arial&#8221;,&#8221;sans-serif&#8221;;<br />
	mso-ascii-font-family:Arial;<br />
	mso-hansi-font-family:Arial;<br />
	mso-ansi-language:EN-US;<br />
	mso-fareast-language:EN-US;<br />
	font-weight:bold;<br />
	mso-bidi-font-weight:normal;<br />
	text-decoration:underline;<br />
	text-underline:single;}<br />
.MsoChpDefault<br />
	{mso-style-type:export-only;<br />
	mso-default-props:yes;<br />
	font-size:10.0pt;<br />
	mso-ansi-font-size:10.0pt;<br />
	mso-bidi-font-size:10.0pt;}<br />
@page Section1<br />
	{size:612.0pt 792.0pt;<br />
	margin:72.0pt 72.0pt 72.0pt 72.0pt;<br />
	mso-header-margin:36.0pt;<br />
	mso-footer-margin:36.0pt;<br />
	mso-paper-source:0;}<br />
div.Section1<br />
	{page:Section1;}<br />
 /* List Definitions */<br />
 @list l0<br />
	{mso-list-id:313804499;<br />
	mso-list-type:hybrid;<br />
	mso-list-template-ids:-1442514464 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}<br />
@list l0:level1<br />
	{mso-level-number-format:bullet;<br />
	mso-level-text:;<br />
	mso-level-tab-stop:none;<br />
	mso-level-number-position:left;<br />
	text-indent:-18.0pt;<br />
	font-family:Symbol;}<br />
@list l0:level2<br />
	{mso-level-number-format:bullet;<br />
	mso-level-text:o;<br />
	mso-level-tab-stop:none;<br />
	mso-level-number-position:left;<br />
	text-indent:-18.0pt;<br />
	font-family:&#8221;Courier New&#8221;;}<br />
@list l1<br />
	{mso-list-id:842478050;<br />
	mso-list-type:hybrid;<br />
	mso-list-template-ids:-509051268 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}<br />
@list l1:level1<br />
	{mso-level-number-format:bullet;<br />
	mso-level-text:;<br />
	mso-level-tab-stop:none;<br />
	mso-level-number-position:left;<br />
	text-indent:-18.0pt;<br />
	font-family:Symbol;}<br />
@list l1:level2<br />
	{mso-level-number-format:bullet;<br />
	mso-level-text:o;<br />
	mso-level-tab-stop:none;<br />
	mso-level-number-position:left;<br />
	text-indent:-18.0pt;<br />
	font-family:&#8221;Courier New&#8221;;}<br />
@list l1:level3<br />
	{mso-level-number-format:bullet;<br />
	mso-level-text:;<br />
	mso-level-tab-stop:none;<br />
	mso-level-number-position:left;<br />
	text-indent:-18.0pt;<br />
	font-family:Wingdings;}<br />
&#8211;&gt;</p>
<p><!--[if gte mso 10]&gt;--></p>
<p> /* Style Definitions */<br />
 table.MsoNormalTable<br />
	{mso-style-name:&#8221;Table Normal&#8221;;<br />
	mso-tstyle-rowband-size:0;<br />
	mso-tstyle-colband-size:0;<br />
	mso-style-noshow:yes;<br />
	mso-style-priority:99;<br />
	mso-style-qformat:yes;<br />
	mso-style-parent:&#8221;";<br />
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;<br />
	mso-para-margin:0cm;<br />
	mso-para-margin-bottom:.0001pt;<br />
	mso-pagination:widow-orphan;<br />
	font-size:10.0pt;<br />
	font-family:&#8221;Times New Roman&#8221;,&#8221;serif&#8221;;}</p>
<h4><span lang="EN-US">Working with Sessions</span></h4>
<p class="MsoNormal">We need to use a session when we work with NHibernate. We<br />
will talk later about managing entity lifetime, but the short version is that<br />
you should avoid accessing an entity outside of the context of the session that<br />
loaded it.</p>
<p class="MsoNormal">We obtain sessions from the session factory. The session<br />
factory is an expensive resource, you want to create it once at application<br />
startup. The factory gives you instances of sessions, which are cheap and you<br />
should create and destroy as your business transactions require (see transient<br />
and persistent entities below).</p>
<h4><span lang="EN-US">Entity Lifetime Management</span></h4>
<p class="MsoNormal">It is important to understand the lifetime issues around<br />
entities when working with an ORM. Clarity here helps prevent many of the<br />
issues people have when working within an ORM.</p>
<h4><span lang="EN-US">Identity Map</span></h4>
<p class="MsoNormal">The <a target="_blank" href="http://martinfowler.com/eaaCatalog/identityMap.html">identity map</a> is a cache of all of the entities loaded<br />
from the Db during the session. We need an identity map because we want to<br />
ensure that if we have made changes to an entity within the session i.e.<br />
updated some of its data, new queries against the Db that returns a set of<br />
entities keep our changes. As a corollary to this when working with an identity<br />
map, we always get the same instance of an entity within a session, and they<br />
can be compared by reference. Note that the identity map also functions as a<br />
first-level cache, because it has our entities loaded. However, we will only go<br />
to the first level cache in preference to querying the Db when using Get or Load to retrieve our entities. This is because only when we issue a query, through HQL for example, we do not know what entities will be returned, so it is only after the query is executed that we can look into the cache to se if we have that entity already, and return the copy there.</p>
<h4><span lang="EN-US">Unit of Work</span></h4>
<p class="MsoNormal">NHibernate stores the old and new values of entities within<br />
the identity map. The unit of work also stores new entities that have been<br />
added with Save and are waiting to be flushed to the Db. NHibernate flushes<br />
these changes to the Db both on demand and automatically. Automatic flushing happens when you perform<br />
certain operations. For example if you are about to query NHIbernate will flush to make sure that your query results will be consistent with the modified data. You can<br />
also explicitly flush a session either by calling Flush() on the session or by<br />
using a transaction. The principle here is that you want to optimize when updates occur, instead of them happening piecemeal.</p>
<p class="MsoNormal">So when does NHibernate Flush?</p>
<ul type="disc">
<li>&nbsp;
<ul type="circle">
<li class="MsoNormal">When you explicitly call<br />
      Flush.</li>
<li class="MsoNormal">When you commit a<br />
      transaction.</li>
<li class="MsoNormal">Before some Find or<br />
      Enumerable method calls</li>
<li class="MsoNormal">When an object using<br />
      native ID generation is saved, the entity will be inserted</li>
<li class="MsoNormal">Whe&nbsp; you close a Session</li>
</ul>
</li>
</ul>
<p class="MsoNormal">We can set the session FlushMode to restrict those to Commit<br />
or Flush if we need to be explicit about when a flush occurs. One common reason for setting the FlushMode to Commit is the issue of what happens when an exception is thrown. It is common to have a using statement control your Session, so that it is closed when and flushed automatically. The problem becomes that if you throw an exception, the Dispose still runs as you exit the implicit try..finally block created by the using statement, flushing and pending writes. Given that an exception was thrown this might result in an incosistent or undesired state. Setting the session FlushMode to Commit and always using a transaction helps prevent this: the changes don&#8217;t get persisted until you commit. The side-affect to watch for is the issue that until your changes are flushed, queries will not report on any pending changes.</p>
<h4><span lang="EN-US">Transient and Persistent Entities</span></h4>
<p class="MsoNormal">We need to distinguish between transient and persistent entities.<br />
A persistent entity is one that the session knows about. The session knows<br />
about an entity that has been loaded through it, using get, load, or one of the<br />
query APIs. A transient entity is one that the session does not know about i.e.<br />
has been created with new in the application. A transient entity is made<br />
persistent by calling Save() on the session passing the new entity as a<br />
parameter, or by adding it to the graph of an existing persistent entity. In<br />
the latter case we will persist the new entity if we have set the cascade<br />
options in the mapping to pickup children. </p>
<p class="MsoNormal">&nbsp;We need to remember that an entity has its changes tracked<br />
by the unit of work held by the session which loads it. In addition, if we have<br />
lazy loaded associations on an entity, those will be loaded via a proxy that<br />
calls out to the original session. So we should not access an entity outside<br />
the scope of a session. The model in NHibernate is:</p>
<ul type="disc">
<li class="MsoNormal">Open Session
<ul type="circle">
<li class="MsoNormal">Begin a transaction on<br />
      the session</p>
<ul type="square">
<li class="MsoNormal">Retrieve any required<br />
       entities</li>
<li class="MsoNormal">Save any transient<br />
       entities or add to graph</li>
<li class="MsoNormal">Make any updates to the<br />
       graph required</li>
</ul>
</li>
<li class="MsoNormal">Commit the transaction</li>
</ul>
</li>
<li class="MsoNormal">Close the session</li>
</ul>
<p class="MsoNormal">If we have a detached entity, one that we loaded via a<br />
transaction that is no longer extant (remember we don&#8217;t want any lazy loaded<br />
associations on it), because we have loaded it within a different context, then<br />
we can re-attach it to a session using Update(). Update tells the session that<br />
the entity it thinks is transient, because it is not in its identity map, is<br />
actually persistent. In that case NHibernate adds it to its list of persistent<br />
entities.</p>
<p class="MsoNormal">NHibernate also supports SaveOrUpdate() which is useful if<br />
are not sure if the entity is detached or transient. In this case it uses the<br />
unsaved-value attribute of the primary key mapping to determine whether or not<br />
we have a transient entity or a detached one.</p>
<p class="MsoNormal">A common early mistake is to assume that the Update method needs to be called to amend a persitent (i.e. existing object). In fact you do not need to explicilty ask for changes to persistent objects to be saved. NHibernate looks in the Unit of Work to figure out which objects are &#8216;dirty&#8217; and flushes any changes to them.</p>
<p class="MsoNormal">Although there is support for detached entities, prefer to<br />
work within the context of a session where possible as it prevents issues with<br />
needing to fully materialize the object graph.</p>
<p class="MsoNormal">If we have a transient object which is in the reachable from the graph of a persistent object, then we do not need to explicitly save it. NHibernate will pick up the transient object and save it for us when it saves the persistent object provided that we have set the association between the persistent object and the transient one to cascade saves or updates. This works well with an aggregate strategy where your repository laods and saves aggregates (via the aggregate root) as you only ever need to save the root object to persist the graph.</p>
<h3><span lang="EN-US">CRUD</span></h3>
<h4><span lang="EN-US">Insert, and Retrieve</span></h4>
<p class="MsoNormal">&nbsp;Inserting a new object is straightforward. Create it, and<br />
make it persistent with Save. We use flush here to persist it instead of using<br />
a transaction:</p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Company<br />
company = new Company();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>company.Name = companyName;</b></p>
<p class="MsoNormal"><b><span>&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Customer customer = new Customer();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>customer.FirstName = &#8220;Neil&#8221;;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>customer.Surname = &#8220;Jordan&#8221;;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>customer.DateOfBirth = new DateTime(1950, 2, 25);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>customer.Company = company;</b></p>
<p class="MsoNormal"><b>&nbsp;<span></span></b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>company.Customers.Add(customer);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>using<br />
(ISession session = sessionFactory.OpenSession())</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>session.Save(company);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>session.Flush();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Once we have saved our entity we can retrieve it. If we do<br />
not know the id of the entity then we need to use one of NHibernate&#8217;s query<br />
languages, HQL or ICriteria to find it. </p>
<p class="MsoNormal">HQL is a SQL like query language that works against the<br />
domain model instead of the relational model. Queries have the form &#8220;from<br />
Customer as cust where cust.FirstName = :name&#8221;. &#8220;:name&#8221; is a<br />
named parameter, you can also use &#8220;?&#8221;, but then you have to refer to<br />
parameters by position when setting them, so by name is usually more readable. </p>
<p class="MsoNormal">The Find method on session has been deprecated, so use the<br />
CreateQuery on the Session to create an IQuery, set your parameters and<br />
retrieve matching results.</p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>using<br />
(ISession session = sessionFactory.OpenSession())</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IQuery<br />
query = session.CreateQuery(&#8220;from Company org where Name = :name&#8221;);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>query.SetString(&#8220;name&#8221;, companyName);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>IList&lt;Company&gt; companies = query.List&lt;Company&gt;();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if<br />
(companies.Count &gt; 0)</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine(companies[0].Name);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>foreach (Customer customer in companies[0].Customers)</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.Write(&#8220;First Name: &#8220;);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine(customer.FirstName);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.Write(&#8220;Surname: &#8220;);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine(customer.Surname);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return<br />
companies[0].Id;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal">In addition NHibernate also provides the ICriteria API</p>
<p class="MsoNormal">If we know the Id we can use Get or Load. The primary<br />
difference is that Get returns null if the entity cannot be found, whereas Load<br />
throws an exception. However, also note that if the object exists as a proxy in<br />
the session&#8217;s identity map then Load will return that proxy, Get will always<br />
retrieve the entity.</p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>using<br />
(ISession session = sessionFactory.OpenSession())</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Company company = session.Load&lt;Company&gt;(companyId);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.Write(&#8220;Company Name: &#8220;);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Console.Out.WriteLine(company.Name);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</b></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Delete and Update</p>
<p class="MsoNormal">Updating an entity is straightforward, any entity that is in<br />
the identity map that we then update will have those changes persisted when<br />
NHibernate flushes to the Db.</p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>string<br />
companyName = string.Empty;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>using (ISession session =<br />
sessionFactory.OpenSession())</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Company company = session.Load&lt;Company&gt;(companyId);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>companyName = company.Name;</b></p>
<p class="MsoNormal"><b>&nbsp;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>ITransaction trans = session.BeginTransaction();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Customer newCustomer = new<br />
Customer();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>newCustomer.FirstName = &#8220;Angela&#8221;;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>newCustomer.Surname = &#8220;Carter&#8221;;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>newCustomer.DateOfBirth = new DateTime(1940, 5, 7);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>newCustomer.Company = company;</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>trans.Commit();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal"><b>&nbsp;</b></p>
<p class="MsoNormal">Deleting an existing company is straightforward too, we<br />
simply call the Delete method of the Session to remove it.</p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>using<br />
(ISession session = sessionFactory.OpenSession())</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>session.Delete(&#8220;from Company<br />
org where Id = :id&#8221;, companyId, NHibernate.NHibernateUtil.Int32);</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>session.Flush();</b></p>
<p class="MsoNormal"><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</b></p>
<p class="MsoNormal">
<p class="MsoNormal">&nbsp;How long to keep the session around?</p>
</p>
<p>
<span style="font-size: 10pt;font-family: 'Calibri','sans-serif'">Sessions are lightweight resources and designed to<br />
be &#8216;kept around&#8217; as long as you need them.&nbsp; For example, the session<br />
only opens and closes a Db Connection when it flushes changes in the unit of<br />
work to the Db. A session is also easy to create, so you should create them as<br />
you need them.&nbsp; By contrast the SessionFactory from which we get our sessions is a heavyweight object. It does all the work to generate code from the mappings, and generally you want to create this once, at application startup. The usual pattern is to create a session for each<br />
business transaction, for which you may be collating changes in a unit of work.<br />
On the web, it is common to use Http request affinity for a session, opening&nbsp; a session as the request comes in and closing it once you have returned the response.</span></p>
<p><span style="font-size: 10pt;font-family: 'Calibri','sans-serif'"><br /></span></p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/b033a6c1af4ee8d7a734f3684225ea8a?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Ian Cooper</h2>
							Ian Cooper has over 18 years of experience delivering Microsoft platform solutions in government, healthcare, and finance. During that time he has worked for the DTi, Reuters, Sungard, Misys and Beazley delivering everything from bespoke enterpise solutions to 'shrink-wrapped' products to thousands of customers. Ian is a passionate exponent of the benefits of OO and Agile. He is test-infected and contagious. When he is not writing C# code he is also the and founder of the London .NET user group. http://www.dnug.org.uk							<div id="author-link">
								<a href="http://codebetter.com/iancooper/author/iancooper/" title="View all posts by Ian Cooper">View all posts by Ian Cooper &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/iancooper/category/nhibernate/" title="View all posts in NHibernate" rel="category tag">NHibernate</a>, <a href="http://codebetter.com/iancooper/category/orm/" title="View all posts in ORM" rel="category tag">ORM</a>. Bookmark the <a href="http://codebetter.com/iancooper/2009/03/26/introduction-to-nhibernate-pt-6/" title="Permalink to Introduction to NHibernate, pt. 6" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/iancooper/2009/03/26/introduction-to-nhibernate-pt-6/feed/" title="Comments RSS to Introduction to NHibernate, pt. 6" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-59 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/iancooper/2009/03/22/introduction-to-nhibernate-pt-5/" rel="prev"><span class="meta-nav">&larr;</span> Introduction to NHibernate, pt.5</a></div>
					<div class="nav-next"><a href="http://codebetter.com/iancooper/2009/03/31/seizing-the-bdd-nettle/" rel="next">Seizing the BDD Nettle <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/iancooper/2009/03/26/introduction-to-nhibernate-pt-6/ ';
	var disqus_identifier = '59 /blogs/ian_cooper/archive/2009/03/26/introduction-to-nhibernate-pt-6.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetteriancooper';
	var disqus_title = "Introduction to NHibernate, pt. 6";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=59');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/iancooper/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/iancooper\/2009\/03\/26\/introduction-to-nhibernate-pt-6\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.265 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-27 08:31:45 -->
<!-- super cache -->