<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Introduction to NHibernate, Part 1 | Ian Cooper</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/iancooper/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/iancooper/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/iancooper/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/iancooper/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/iancooper/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Ian Cooper' href='http://codebetter.com/iancooper/' />
<link rel='start' title='Hello World' href='http://codebetter.com/iancooper/2007/11/17/hello-world-2/' />
<link rel='prev' title='LINQ to SQL, EF, and the Thunderdome Solution' href='http://codebetter.com/iancooper/2008/11/03/linq-to-sql-ef-and-the-thunderdome-solution/' />
<link rel='next' title='The Fat Controller' href='http://codebetter.com/iancooper/2008/12/03/the-fat-controller/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/iancooper/2008/12/01/introduction-to-nhibernate-part-1/' />
<link rel='shortlink' href='http://codebetter.com/iancooper/?p=47' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/iancooper/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetteriancooper/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/iancooper/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-47" class="post-47 post type-post status-publish format-standard hentry category-nhibernate category-object-orientation category-orm">
					<h1 class="entry-title">Introduction to NHibernate, Part 1</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/iancooper/author/iancooper/" title="View all posts by Ian Cooper">Ian Cooper</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/iancooper/2008/12/01/introduction-to-nhibernate-part-1/" title="1:40 pm" rel="bookmark"><span class="entry-date">December 1, 2008</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/iancooper/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/iancooper/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/iancooper/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>To go alongside my set of posts on LINQ To SQL I wanted to post an Introduction to NHibernate. These posts are not intended as any kind of masterclass, so experienced NHibernate hands might want to skip them. They are intended for folks who are new to the framework to help get them started.</p>
<p>In this first session we will introduce NHIbernate and the basics of mapping.* Font Definitions */<br />
 @font-face<br />
	{font-family:Calibri;<br />
	panose-1:2 15 5 2 2 2 4 3 2 4;<br />
	mso-font-charset:0;<br />
	mso-generic-font-family:swiss;<br />
	mso-font-pitch:variable;<br />
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}<br />
 /* Style Definitions */<br />
 p.MsoNormal, li.MsoNormal, div.MsoNormal<br />
	{mso-style-update:auto;<br />
	mso-style-parent:&#8221;";<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	mso-outline-level:3;<br />
	font-size:10.0pt;<br />
	mso-bidi-font-size:12.0pt;<br />
	font-family:Calibri;<br />
	mso-fareast-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-weight:bold;}<br />
h1<br />
	{mso-style-name:&#8221;Heading 1\,min1&#8243;;<br />
	mso-style-update:auto;<br />
	mso-style-next:&#8221;Body Text Indent&#8221;;<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:2.0cm;<br />
	text-indent:-2.0cm;<br />
	mso-pagination:widow-orphan lines-together;<br />
	page-break-after:avoid;<br />
	mso-outline-level:1;<br />
	mso-list:l0 level1 lfo1;<br />
	tab-stops:36.0pt list 2.0cm;<br />
	font-size:18.0pt;<br />
	mso-bidi-font-size:10.0pt;<br />
	font-family:Arial;<br />
	mso-bidi-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-font-kerning:0pt;<br />
	mso-fareast-language:EN-US;}<br />
h2<br />
	{mso-style-update:auto;<br />
	mso-style-next:Normal;<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	page-break-after:avoid;<br />
	mso-outline-level:2;<br />
	font-size:14.0pt;<br />
	font-family:Arial;<br />
	mso-bidi-font-weight:normal;<br />
	mso-bidi-font-style:italic;}<br />
h3<br />
	{mso-style-update:auto;<br />
	mso-style-next:Normal;<br />
	mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:0cm;<br />
	mso-pagination:widow-orphan;<br />
	page-break-after:avoid;<br />
	mso-outline-level:3;<br />
	font-size:11.0pt;<br />
	mso-bidi-font-size:13.0pt;<br />
	font-family:Arial;<br />
	mso-ansi-language:EN-US;<br />
	mso-fareast-language:EN-US;<br />
	mso-bidi-font-weight:normal;}<br />
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent<br />
	{mso-margin-top-alt:auto;<br />
	margin-right:0cm;<br />
	mso-margin-bottom-alt:auto;<br />
	margin-left:14.15pt;<br />
	mso-pagination:widow-orphan;<br />
	mso-outline-level:3;<br />
	font-size:10.0pt;<br />
	mso-bidi-font-size:12.0pt;<br />
	font-family:Calibri;<br />
	mso-fareast-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-family:&#8221;Times New Roman&#8221;;<br />
	mso-bidi-font-weight:bold;}<br />
@page Section1<br />
	{size:612.0pt 792.0pt;<br />
	margin:72.0pt 90.0pt 72.0pt 90.0pt;<br />
	mso-header-margin:36.0pt;<br />
	mso-footer-margin:36.0pt;<br />
	mso-paper-source:0;}<br />
div.Section1<br />
	{page:Section1;}<br />
 /* List Definitions */<br />
 @list l0<br />
	{mso-list-id:887691598;<br />
	mso-list-template-ids:-1967875248;}<br />
@list l0:level1<br />
	{mso-level-start-at:0;<br />
	mso-level-style-link:&#8221;Heading 1&#8243;;<br />
	mso-level-text:%1;<br />
	mso-level-tab-stop:2.0cm;<br />
	mso-level-number-position:left;<br />
	margin-left:2.0cm;<br />
	text-indent:-2.0cm;}<br />
@list l0:level2<br />
	{mso-level-text:&#8221;%1\.%2&#8243;;<br />
	mso-level-tab-stop:2.0cm;<br />
	mso-level-number-position:left;<br />
	margin-left:2.0cm;<br />
	text-indent:-2.0cm;}<br />
@list l0:level3<br />
	{mso-level-text:&#8221;%1\.%2\.%3&#8243;;<br />
	mso-level-tab-stop:2.0cm;<br />
	mso-level-number-position:left;<br />
	margin-left:2.0cm;<br />
	text-indent:-2.0cm;}<br />
@list l0:level4<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4&#8243;;<br />
	mso-level-tab-stop:72.0pt;<br />
	mso-level-number-position:left;<br />
	margin-left:53.85pt;<br />
	text-indent:-53.85pt;}<br />
@list l0:level5<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4\.%5&#8243;;<br />
	mso-level-tab-stop:50.4pt;<br />
	mso-level-number-position:left;<br />
	margin-left:50.4pt;<br />
	text-indent:-50.4pt;}<br />
@list l0:level6<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4\.%5\.%6&#8243;;<br />
	mso-level-tab-stop:57.6pt;<br />
	mso-level-number-position:left;<br />
	margin-left:57.6pt;<br />
	text-indent:-57.6pt;}<br />
@list l0:level7<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4\.%5\.%6\.%7&#8243;;<br />
	mso-level-tab-stop:64.8pt;<br />
	mso-level-number-position:left;<br />
	margin-left:64.8pt;<br />
	text-indent:-64.8pt;}<br />
@list l0:level8<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8&#8243;;<br />
	mso-level-tab-stop:72.0pt;<br />
	mso-level-number-position:left;<br />
	margin-left:72.0pt;<br />
	text-indent:-72.0pt;}<br />
@list l0:level9<br />
	{mso-level-text:&#8221;%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9&#8243;;<br />
	mso-level-tab-stop:79.2pt;<br />
	mso-level-number-position:left;<br />
	margin-left:79.2pt;<br />
	text-indent:-79.2pt;}<br />
&#8211;&gt;<br />
<!--[if gte mso 10]&gt;--></p>
<p> /* Style Definitions */<br />
 table.MsoNormalTable<br />
	{mso-style-name:&#8221;Table Normal&#8221;;<br />
	mso-tstyle-rowband-size:0;<br />
	mso-tstyle-colband-size:0;<br />
	mso-style-noshow:yes;<br />
	mso-style-parent:&#8221;";<br />
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;<br />
	mso-para-margin:0cm;<br />
	mso-para-margin-bottom:.0001pt;<br />
	mso-pagination:widow-orphan;<br />
	font-size:10.0pt;<br />
	font-family:&#8221;Times New Roman&#8221;;<br />
	mso-ansi-language:#0400;<br />
	mso-fareast-language:#0400;<br />
	mso-bidi-language:#0400;}</p>
<h2>Where, who what, when, why?</h2>
<p class="MsoNormal"><a href="http://www.hibernate.org/343.html">NHibernate</a> is an open source ORM, derived initially from the<br />
Hibernate project. NHibernate supports persistence ignorance, your object<br />
classes don&#8217;t have to follow a restrictive programming model. Persistent<br />
classes do not need to implement any interface or inherit from a special base<br />
class.Hibernate was developed by a team of Java software<br />
developers around the world led by Gavin King. </p>
<p class="MsoNormal"><a href="http://sourceforge.net/project/showfiles.php?group_id=73818">NHibernate 2.0.1GA</a> is the current version of NHIbernate.</p>
<h2>Building NHibernate</h2>
<p class="MsoNormal">You can just download the binaries that you need, especially<br />
if you have no appetite for un-released versions, however if you want the<br />
latest features then you need to download the latest version of the source and<br />
build it.</p>
<p class="MsoNormal">The NHibernate source code can be found on sourceforge. The<br />
easiest way to get hold of it is to use a Subversion (SVN) client such as<br />
TortoiseSVN to download the code from the repository. NHibernate lives at:</p>
<p>https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/</p>
<p class="MsoNormal">Just run Nant in trunk/NHibernate directory to build. Check<br />
the options file if you want to see different ways of building.</p>
<h3><span lang="EN-US">Working with Visual Studio</span></h3>
<p class="MsoNormal">You can also open the source using the supplied Visual<br />
Studio solution file; this allows you to run tests, submit patches etc. Ignore<br />
the &#8216;customized project&#8217; warning as this is a trusted source.</p>
<h2>Mapping with NHibernate</h2>
<h3><span lang="EN-US">Initialization</span></h3>
<p class="MsoNormal">There are four steps to getting NHibernate working:</p>
<p class="MsoNormal">Provide information to access the database</p>
<p class="MsoNormal">Configure log4net</p>
<p class="MsoNormal">Provide the mapping information of the entities and value<br />
types</p>
<p class="MsoNormal">Build the session factory</p>
<h3><span lang="EN-US">Accessing the Db</span></h3>
<p class="MsoNormal">We need to modify our config file to tell our application<br />
how to initialize NHibernate. We can do this in a separate config file, or, my<br />
preferred option, from within the app.config file. You can copy the<br />
nhibernate-configuration.xsd file into the visual studio<br />
common7/packages/schemas/xml file to get intellisense for writing NHibernate<br />
configuration information.</p>
<p class="MsoNormal">We set four properties to access the database:</p>
<p class="MsoNormal">ConnectionProvider: This value never changes.</p>
<p class="MsoNormal">Dialect: This depends on your database</p>
<p class="MsoNormal">ConnectionDriver: This depends on your database.</p>
<p class="MsoNormal">ConnectionString: The string used to create a database<br />
connection.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span lang="EN-US">&lt;?<span>xml</span> <span style="color: red">version</span>=&#8221;1.0&#8243; <span style="color: red">encoding</span>=&#8221;utf-8&#8243;<br />
?&gt;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US">&lt;</span><span lang="EN-US">configuration<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;<br />
</span>&lt;</span><span lang="EN-US">configSections<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;<span>section</span> <span style="color: red">name</span>=&#8221;hibernate-configuration&#8221;<br />
<span style="color: red">type</span>=&#8221;NHibernate.Cfg.ConfigurationSectionHandler,NHibernate&#8221;<br />
/&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;<span>section</span> <span style="color: red">name</span>=&#8221;log4net&#8221;<br />
<span style="color: red">type</span>=&#8221;log4net.Config.Log4NetConfigurationSectionHandler,log4net&#8221;<br />
/&gt;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;<br />
</span>&lt;/</span><span lang="EN-US">configSections<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp; </span>&lt;<span>hibernate-configuration</span> <span style="color: red">xmlns</span>=&#8221;urn:nhibernate-configuration-2.2&#8243;&gt;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;&nbsp;&nbsp;<br />
</span>&lt;</span><span lang="EN-US">session-factory<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>property</span> <span style="color: red">name</span>=&#8221;connection.provider&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>NHibernate.Connection.DriverConnectionProvider</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/<span>property</span>&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>property</span> <span style="color: red">name</span>=&#8221;dialect&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>NHibernate.Dialect.MsSql2000Dialect </span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/<span>property</span>&gt; </span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>property</span> <span style="color: red">name</span>=&#8221;connection.driver_class&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>NHibernate.Driver.SqlClientDriver </span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/<span>property</span>&gt; </span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>property</span> <span style="color: red">name</span>=&#8221;connection.connection_string&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Initial<br />
Catalog=nhibernate;Integrated Security=SSPI </span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/<span>property</span>&gt; </span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;&nbsp;&nbsp;<br />
</span>&lt;/</span><span lang="EN-US">session-factory<span style="color: blue">&gt; </span></span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;<br />
</span>&lt;/</span><span lang="EN-US">hibernate-configuration<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US">&lt;/</span><span lang="EN-US">configuration<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal">This allows us to create a NHibernate SessionFactory. The SessionFactory<br />
is an expensive resource to initialize, so we only want one. Crudely for this<br />
example we just make it a static member of the class. But the key is to<br />
understand that you create the SessionFactory once, at start up, and then<br />
create sessions from the factory when you need to interact with persistent<br />
entities.</p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp; </span>public class <span>Program</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span> <span style="color: blue">static</span> <span>ISessionFactory</span> sessionFactory = <span style="color: blue">null</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> Main(<span style="color: blue">string</span>[] args)</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>log4net.Config.<span>XmlConfigurator</span>.Configure();</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>Configuration cfg = <span style="color: blue">new</span> Configuration();</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>cfg.Configure();</span></p>
<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>sessionFactory = cfg.BuildSessionFactory();</span></p>
<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<h3><span lang="EN-US">Configuring log4net</span></h3>
<p class="MsoNormal">NHibernate uses log4net for logging so it is worth setting<br />
up log4net so that you can see any errors that are generated. Configuration in<br />
NHibernate can be a little painful and frustrating so its worth getting all the<br />
feedback you can to help you through it. Again you configure log4net by adding<br />
to your applications&#8217;s configuration file.</p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US">&lt;</span><span lang="EN-US">configSections<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;<span>section</span> <span style="color: red">name</span>=&#8221;log4net&#8221;<br />
<span style="color: red">type</span>=&#8221;log4net.Config.Log4NetConfigurationSectionHandler,log4net&#8221;<br />
/&gt;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;<br />
</span>&lt;/</span><span lang="EN-US">configSections<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US">&lt;</span><span lang="EN-US">log4net<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;<span>appender</span> <span style="color: red">name</span>=&#8221;ConsoleAppender&#8221;<br />
<span style="color: red">type</span>=&#8221;log4net.Appender.ConsoleAppender,<br />
log4net&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>layout</span> <span style="color: red">type</span>=&#8221;log4net.Layout.PatternLayout,<br />
log4net&#8221;&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>param</span> <span style="color: red">name</span>=&#8221;ConversionPattern&#8221;<br />
<span style="color: red">value</span>=&#8221;%m&#8221; /&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/<span>layout</span>&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;/<span>appender</span>&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;<span>root</span>&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>priority</span> <span style="color: red">value</span>=&#8221;WARN&#8221;<br />
/&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;<span>appender-ref</span> <span style="color: red">ref</span>=&#8221;ConsoleAppender&#8221;<br />
/&gt;</span></p>
<p class="MsoNormal"><span lang="EN-US"><span>&nbsp;&nbsp;&nbsp; </span>&lt;/<span>root</span>&gt;</span></p>
<p class="MsoNormal"><span style="color: blue" lang="EN-US"><span>&nbsp;<br />
</span>&lt;/</span><span lang="EN-US">log4net<span style="color: blue">&gt;</span></span></p>
<p class="MsoNormal">Adding the following line to the application means that you<br />
do not need to re-start the application to make configuration changes:</p>
<p class="MsoNormal">[assembly: log4net.Config.XmlConfigurator(Watch=true)]</p>
<p class="MsoNormal">We must add a reference to the library log4net.dll (it is<br />
available with the binaries of NHibernate).</p>
<p class="MsoNormal">We call log4net.Config.XmlConfigurator.Configure() before<br />
starting to configure NHibernate. This call activates log4net.</p>
<p class="MsoNormal"><span lang="EN-US">log4net.Config.<span>XmlConfigurator</span>.Configure();</span></p>
<h3><span lang="EN-US">Next Time<br /></span></h3>
<p>We will look at how we map entities </p>
<p>&nbsp;</p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/b033a6c1af4ee8d7a734f3684225ea8a?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Ian Cooper</h2>
							Ian Cooper has over 18 years of experience delivering Microsoft platform solutions in government, healthcare, and finance. During that time he has worked for the DTi, Reuters, Sungard, Misys and Beazley delivering everything from bespoke enterpise solutions to 'shrink-wrapped' products to thousands of customers. Ian is a passionate exponent of the benefits of OO and Agile. He is test-infected and contagious. When he is not writing C# code he is also the and founder of the London .NET user group. http://www.dnug.org.uk							<div id="author-link">
								<a href="http://codebetter.com/iancooper/author/iancooper/" title="View all posts by Ian Cooper">View all posts by Ian Cooper &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/iancooper/category/nhibernate/" title="View all posts in NHibernate" rel="category tag">NHibernate</a>, <a href="http://codebetter.com/iancooper/category/object-orientation/" title="View all posts in Object-Orientation" rel="category tag">Object-Orientation</a>, <a href="http://codebetter.com/iancooper/category/orm/" title="View all posts in ORM" rel="category tag">ORM</a>. Bookmark the <a href="http://codebetter.com/iancooper/2008/12/01/introduction-to-nhibernate-part-1/" title="Permalink to Introduction to NHibernate, Part 1" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/iancooper/2008/12/01/introduction-to-nhibernate-part-1/feed/" title="Comments RSS to Introduction to NHibernate, Part 1" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-47 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/iancooper/2008/11/03/linq-to-sql-ef-and-the-thunderdome-solution/" rel="prev"><span class="meta-nav">&larr;</span> LINQ to SQL, EF, and the Thunderdome Solution</a></div>
					<div class="nav-next"><a href="http://codebetter.com/iancooper/2008/12/03/the-fat-controller/" rel="next">The Fat Controller <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-484">
					<div id="dsq-comment-header-484" class="dsq-comment-header">
						<cite id="dsq-cite-484">
								<span id="dsq-author-user-484">Tuna Toksoz</span>
							</cite>
					</div>
					<div id="dsq-comment-body-484" class="dsq-comment-body">
						<div id="dsq-comment-message-484" class="dsq-comment-message"><p>Ian, you also need to specify the proxyfactory for trunk.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-485">
					<div id="dsq-comment-header-485" class="dsq-comment-header">
						<cite id="dsq-cite-485">
	http://emcpadden.wordpress.com/							<span id="dsq-author-user-485">Ed McPadden</span>
							</cite>
					</div>
					<div id="dsq-comment-body-485" class="dsq-comment-body">
						<div id="dsq-comment-message-485" class="dsq-comment-message"><p>Thanks Ian&#8230;I am just starting to look at evaluating NHibernate so I find this post (and hopefully future posts) very useful!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-486">
					<div id="dsq-comment-header-486" class="dsq-comment-header">
						<cite id="dsq-cite-486">
								<span id="dsq-author-user-486">Ryan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-486" class="dsq-comment-body">
						<div id="dsq-comment-message-486" class="dsq-comment-message"><p>Ed be sure to check out Steve Bohlen&#8217;s <a href="http://www.summerofnhibernate.com" rel="nofollow">http://www.summerofnhibernate.com</a> too.  It&#8217;s a very exhaustive look at Nhibernate in a screencast series&#8230;it&#8217;s presented in a style that really lends itself to a fairly deep understanding of different Nhibernate patterns and theory.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-487">
					<div id="dsq-comment-header-487" class="dsq-comment-header">
						<cite id="dsq-cite-487">
	http://www.eknacks.com/SingleListView.aspx?li=122							<span id="dsq-author-user-487">eKnacks</span>
							</cite>
					</div>
					<div id="dsq-comment-body-487" class="dsq-comment-body">
						<div id="dsq-comment-message-487" class="dsq-comment-message"><p>You&#8217;ve been knacked. Keep up the good work.</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/iancooper/2008/12/01/introduction-to-nhibernate-part-1/ ';
	var disqus_identifier = '47 /blogs/ian_cooper/archive/2008/12/01/introduction-to-nhibernate-part-1.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetteriancooper';
	var disqus_title = "Introduction to NHibernate, Part 1";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=47');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/iancooper/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/iancooper\/2008\/12\/01\/introduction-to-nhibernate-part-1\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.273 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-18 15:56:14 -->
<!-- super cache -->