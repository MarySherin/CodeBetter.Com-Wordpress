<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Windows Forms Tip: Ensure only one instance of your application is running at a time | Paul Laudeman</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/paullaudeman/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/paullaudeman/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Paul Laudeman' href='http://codebetter.com/paullaudeman/' />
<link rel='start' title='The future of Microsoft Visual SourceSafe' href='http://codebetter.com/paullaudeman/2003/08/14/the-future-of-microsoft-visual-sourcesafe/' />
<link rel='prev' title='WeProgram.NET User Group Meeting Tonight (Hampton Roads, VA)' href='http://codebetter.com/paullaudeman/2004/07/13/weprogram-net-user-group-meeting-tonight-hampton-roads-va/' />
<link rel='next' title='ReSharper Reflections' href='http://codebetter.com/paullaudeman/2004/09/18/resharper-reflections/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/' />
<link rel='shortlink' href='http://codebetter.com/paullaudeman/?p=80' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-80" class="post-80 post type-post status-publish format-standard hentry category-windows-forms">
					<h1 class="entry-title">Windows Forms Tip: Ensure only one instance of your application is running at a time</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/paullaudeman/author/paullaudeman/" title="View all posts by paullaudeman">paullaudeman</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/" title="1:15 pm" rel="bookmark"><span class="entry-date">July 17, 2004</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/paullaudeman/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/paullaudeman/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>In some scenarios, you may wish to ensure that a user can run only one instance of your application at a time. Besides ensuring that only a single instance of your application is running, you may also want to bring the instance already running to the front and restore it, if it is minimized.</p>
<p>First, to ensure that only one instance of your application is running at a time, the best method I&#039;ve found is to create a mutex that is held by the operating system (thanks to <a href="http://www.ai.uga.edu/~mc/SingleInstance.html">Michael Covington</a>). This will put a request to the operating system that a mutex be created if one does not already exist. Only one mutex can ever be created at a time, so if you request a new one and it cannot be created, you can safely assume that your application is already running.</p>
<p><font size="2"><br />
</font>
<p><font size="2"><font color="#0000ff">using </font>System.Threading<br /><font size="2"><font color="#0000ff">using</font>&nbsp;</font>System.Runtime.InteropServices;</font><font color="#0000ff" size="2"></font></p>
<p><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">class</font><font size="2"> Form1 : Form<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; <font size="2">[STAThread]<br />&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">void</font><font size="2"> Main() <br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff" size="2">bool</font><font size="2"> createdNew;</font></font></font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mutex m = <font color="#0000ff">new</font> Mutex(<font color="#0000ff">true</font>, <font color="#800000">&quot;YourAppName&quot;</font>, <font color="#0000ff">out</font> createdNew);</font></p>
<p><font size="2"><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</font> (! createdNew)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2">{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000" size="2">// app is already running&#8230;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000000" size="2">MessageBox.Show(</font><font color="#800000" size="2">&quot;Only one instance of this application is allowed at a time.&quot;</font><font color="#000000" size="2">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff" size="2">return</font>;</font></font></font><font size="2"><font color="#008000" size="2"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000000">}</font></font></font></p>
<p><font size="2"><br />
</font>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Run(</font><font color="#0000ff" size="2">new</font><font size="2"> Form1());</font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2"><br />
</font></font></font></font>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#008000" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // keep the mutex reference alive until the normal termination of the program<br /></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GC.KeepAlive(m);</font><br /></font></font></font><font size="2"><font color="#008000" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; }<br />}</font></font></font></p>
<p>The above code will work for the vast majority of your needs. It will also run under scenarios where your code is executing with less than FullTrust permissions (see Code Access Security in MSDN for further information).</p>
<p>If your application can run with Full Trust permissions, we can take this a step further and find the window of the application instnace already running and bring it to the front for the user:</p>
<p><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">class</font><font size="2"> Form1 : Form<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; <font size="2">[STAThread]<br />&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">void</font><font size="2"> Main() <br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff" size="2">bool</font><font size="2"> createdNew;</font></font></font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Threading.Mutex m = <font color="#0000ff">new</font> System.Threading.Mutex(<font color="#0000ff">true</font>, <font color="#800000">&quot;YourAppName&quot;</font>, <font color="#0000ff">out</font> createdNew);</font></p>
<p><font size="2"><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</font> (! createdNew)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2">{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000" size="2"><font size="2"></font><font color="#008000" size="2">// see if we can find the other app and Bring it to front<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#000000" size="2">IntPtr hWnd = FindWindow(</font><font color="#800000" size="2">&quot;WindowsForms10.Window.8.app3&quot;</font><font size="2">, </font><font color="#800000" size="2">&quot;YourAppName&quot;</font><font size="2"><font color="#000000">);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#0000ff" size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>if</font><font size="2"><font color="#000000">(hWnd != IntPtr.Zero)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000000">{</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2">&nbsp;&nbsp; <font color="#000000">Form1.WINDOWPLACEMENT placement = </font></font><font color="#0000ff" size="2">new</font><font size="2"><font color="#000000"> Form1.WINDOWPLACEMENT();<br /></font><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; placement.length = Marshal.SizeOf(placement);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetWindowPlacement(hWnd, </font></font><font color="#0000ff" size="2">ref</font><font size="2"> <font color="#000000">placement);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#0000ff" size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>if</font><font color="#000000" size="2">(placement.showCmd != SW_NORMAL)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; placement.showCmd = SW_RESTORE;</font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetWindowPlacement(hWnd, </font><font color="#0000ff" size="2">ref</font><font size="2"> <font color="#000000">placement);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetForegroundWindow(hWnd);&nbsp;</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#0000ff" size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>return</font><font size="2">;</font></font></font><font size="2"><font color="#008000" size="2"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000000">}</font></font></font></p>
<p><font size="2"><br />
</font>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Run(</font><font color="#0000ff" size="2">new</font><font size="2"> Form1());</font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2"><br />
</font></font></font></font>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#008000" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // keep the mutex reference alive until the normal termination of the program<br /></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GC.KeepAlive(m);</font><br /></font></font></font><font size="2"><font color="#008000" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; }</font></font></font><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2"></font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">const</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> SW_NORMAL = 1; <font color="#008000">//&nbsp;see WinUser.h for definitions</font><br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">const</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> SW_RESTORE = 9;</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; [DllImport(<font color="#800000" size="2">&quot;User32&quot;</font><font size="2">,EntryPoint=</font><font color="#800000" size="2">&quot;FindWindow&quot;</font><font size="2">)]<br /></font></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>static</font><font size="2"> </font><font color="#0000ff" size="2">extern</font><font size="2"> IntPtr FindWindow(</font><font color="#0000ff" size="2">string</font><font size="2"> className, </font><font color="#0000ff" size="2">string</font><font size="2"> windowName);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; [DllImport(<font color="#800000" size="2">&quot;User32&quot;</font><font size="2">,EntryPoint=</font><font color="#800000" size="2">&quot;SendMessage&quot;</font><font size="2">)]<br /></font></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">extern</font><font size="2"> IntPtr SendMessage(IntPtr hWnd, </font><font color="#0000ff" size="2">uint</font><font size="2"> Msg, IntPtr wParam, IntPtr lParam);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; [DllImport(</font><font color="#800000" size="2">&quot;User32&quot;</font><font size="2">,EntryPoint=</font><font color="#800000" size="2">&quot;SetForegroundWindow&quot;</font><font size="2">)]<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">extern</font><font size="2"> </font><font color="#0000ff" size="2">bool</font><font size="2"> SetForegroundWindow(IntPtr hWnd);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; [DllImport(</font><font color="#800000" size="2">&quot;User32&quot;</font><font size="2">,EntryPoint=</font><font color="#800000" size="2">&quot;SetWindowPlacement&quot;</font><font size="2">)]<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">extern</font><font size="2"> </font><font color="#0000ff" size="2">bool</font><font size="2"> SetWindowPlacement(IntPtr hWnd, [In] </font><font color="#0000ff" size="2">ref</font><font size="2"> WINDOWPLACEMENT lpwndpl);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; [DllImport(</font><font color="#800000" size="2">&quot;User32&quot;</font><font size="2">,EntryPoint=</font><font color="#800000" size="2">&quot;GetWindowPlacement&quot;</font><font size="2">)]<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">static</font><font size="2"> </font><font color="#0000ff" size="2">extern</font><font size="2"> </font><font color="#0000ff" size="2">bool</font><font size="2"> GetWindowPlacement(IntPtr hWnd, [In] </font><font color="#0000ff" size="2">ref</font><font size="2"> WINDOWPLACEMENT lpwndpl);</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">struct</font><font size="2"> POINTAPI<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> x;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> y;<br />&nbsp;&nbsp;&nbsp;&nbsp; }</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">struct</font><font size="2"> RECT<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> left;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> top;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> right;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> bottom;<br />&nbsp;&nbsp;&nbsp;&nbsp; }</font></font></font></font></p>
<p><font size="2"><font color="#008000" size="2"><font color="#000000"><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font>private</font><font size="2"> </font><font color="#0000ff" size="2">struct</font><font size="2"> WINDOWPLACEMENT<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> length;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> flags;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> </font><font color="#0000ff" size="2">int</font><font size="2"> showCmd;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> POINTAPI ptMinPosition;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> POINTAPI ptMaxPosition;<br /></font><font color="#0000ff" size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>public</font><font size="2"> RECT rcNormalPosition;<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br /></font>}</font></font></font></p>
<p>As you can see, with minimal effort, you can easily add a polished touch to your application. This might even help you avoid some extra legwork in ensuring that there are no issues with running multiple instances of your app at the same time that you might have to address.</p>
<p>For more information about the Platform Invoke mechanisms to call Win32 API functions, I recommend that you check out <a href="http://www.amazon.com/exec/obidos/tg/detail/-/078214134X/qid=1090080628/sr=8-4/ref=pd_ka_4/104-0606379-7548728?v=glance&amp;s=books&amp;n=507846">.NET Framework Solutions: In Search of the Lost Win32 API</a> by John Mueller and Charles Petzold&#039;s seminal classic <a href="http://www.amazon.com/exec/obidos/tg/detail/-/157231995X/qid=1090080691/sr=8-1/ref=sr_8_xs_ap_i1_xgl14/104-0606379-7548728?v=glance&amp;s=books&amp;n=507846">Programming Windows</a>. </p>
<p>Until Longhorn comes out and more of the Windows platform becomes managed, platform invokes and interop will remain a key technology to understand and use to your advantage to fill the gaps left by the Windows Forms framework.</p>
<p><strong>UPDATE:</strong><br />Visual Studio .NET 2005 (aka. &ldquo;Whidbey&rdquo;) will let you specify Single Instance behavior for Visual Basic .NET projects through the Project Properties page. Curious as to why this option is available for VB projects and not for C# projects, as this seems to instruct the runtime or some framework library not to load more than one instance.</p>
<p>[tags:windows forms,single instance]&nbsp;</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/paullaudeman/category/windows-forms/" title="View all posts in Windows Forms" rel="category tag">Windows Forms</a>. Bookmark the <a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/" title="Permalink to Windows Forms Tip: Ensure only one instance of your application is running at a time" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/feed/" title="Comments RSS to Windows Forms Tip: Ensure only one instance of your application is running at a time" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-80 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/paullaudeman/2004/07/13/weprogram-net-user-group-meeting-tonight-hampton-roads-va/" rel="prev"><span class="meta-nav">&larr;</span> WeProgram.NET User Group Meeting Tonight (Hampton Roads, VA)</a></div>
					<div class="nav-next"><a href="http://codebetter.com/paullaudeman/2004/09/18/resharper-reflections/" rel="next">ReSharper Reflections <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">18 Responses to <em>Windows Forms Tip: Ensure only one instance of your application is running at a time</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-118">
		<div id="comment-118">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">frauhotelmann</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-118">August 18, 2008 at 10:17 am</a></div>

		<div class="comment-body"><p>For C# in VS2008 I had to modify the first method a little bit. It&#8217;s still pretty short:<br />
static void Main()<br />
            {<br />
            bool createdNew;<br />
            System.Threading.Mutex m = new System.Threading.Mutex(true, &#8220;Your App here&#8221;, out createdNew);</p>
<p>        if (!createdNew)<br />
        {<br />
            MessageBox.Show(&#8220;Another instance is already running.&#8221;);<br />
            return;<br />
        }</p>
<p>        {<br />
            Application.EnableVisualStyles();<br />
            Application.SetCompatibleTextRenderingDefault(false);<br />
            Application.Run(new Form1());<br />
        } GC.KeepAlive(m);                // important!<br />
    }</p>
<p>Works pretty good!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-117">
		<div id="comment-117">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">mehdi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-117">August 2, 2008 at 10:21 am</a></div>

		<div class="comment-body"><p>thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-116">
		<div id="comment-116">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-116">December 4, 2006 at 1:51 pm</a></div>

		<div class="comment-body"><p>Hello,</p>
<p>this is gonna not working on CF.<br />
Do you have a solution for Compact Framework 2.0?</p>
<p>Regards<br />
Sven</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-115">
		<div id="comment-115">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Steve Naughton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-115">August 29, 2006 at 8:41 pm</a></div>

		<div class="comment-body"><p>You can also move SetForegroundWindow(hWnd) to outside the if block.  This brings the app to the front whether or not it&#8217;s normally sized.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-114">
		<div id="comment-114">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-114">April 4, 2006 at 11:03 pm</a></div>

		<div class="comment-body"><p>What about command line arguments? Is there some way to pass those to the running application?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-113">
		<div id="comment-113">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.mynicemailat.com' rel='external nofollow' class='url'>Gaby</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-113">September 16, 2005 at 9:50 pm</a></div>

		<div class="comment-body"><p>Thank you for the info!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-112">
		<div id="comment-112">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">DY</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-112">September 9, 2005 at 5:32 pm</a></div>

		<div class="comment-body"><p>for this line:<br />
 Mutex m = new Mutex(true, &#8220;YourAppName&#8221;, out createdNew);</p>
<p>Does &#8220;createdNew&#8221; always returns false when a previous mutex was   created. My code works ok on WinXP Pro, but when migrated to Win server 2003, it seemd that &#8220;createdNew&#8221; returns true even on subsequent activation of my winform.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-111">
		<div id="comment-111">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Toto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-111">July 29, 2005 at 10:05 am</a></div>

		<div class="comment-body"><p><a href="http://www.c-sharpcorner.com/FAQ/Create1InstanceAppSC.asp" rel="nofollow">http://www.c-sharpcorner.com/FAQ/Create1InstanceAppSC.asp</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-110">
		<div id="comment-110">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://blogs.msdn.com/abhinaba' rel='external nofollow' class='url'>Abhinaba Basu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-110">June 23, 2005 at 4:05 am</a></div>

		<div class="comment-body"><p>I think a simpler solution would be to do a PInvoke of SendMessage of any custom message after getting the handle and that message handler can bring up the Window to the front. This reduced the number of Win32 APi&#8217;s used to 2. FindWindow and SendMessage.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-109">
		<div id="comment-109">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-109">February 12, 2005 at 1:10 pm</a></div>

		<div class="comment-body"><p>This is almost exactly what I&#8217;ve been looking for.  All that missing is a .net way of bringing the previous instance to the front.  The Platform Invoke methods aren&#8217;t an option in a lot of circumstances, and will tie the code to the Windows platform.  I don&#8217;t really care for the remoting method either as it requires the application to act as a server and listen for messages on an open TCP port.  The System.Messaging library is another option if you have MSMQ installed on the PC.  There just doesn&#8217;t seem to be a pure .net way of doing it.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-108">
		<div id="comment-108">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/paul.laudeman' rel='external nofollow' class='url'>Paul</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-108">February 3, 2005 at 12:21 pm</a></div>

		<div class="comment-body"><p>David &#8211; thanks for the tip! I&#8217;ll start poking around more in the compatibility library to find the specifics.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-107">
		<div id="comment-107">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://davidkean.net' rel='external nofollow' class='url'>David M. Kean</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-107">February 3, 2005 at 3:50 am</a></div>

		<div class="comment-body"><p>The reason only VB has single instance behaviour in 2005 is because it is built into the the WindowsApplicationBase class contained in the Microsoft.VisualBasic.dll, C# users could reference it, however it doesn&#8217;t something similar to what you have done, except that it also uses remoting to pass the command-line arguments to the other instance.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-106">
		<div id="comment-106">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Vijay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-106">January 5, 2005 at 5:25 pm</a></div>

		<div class="comment-body"><p>Thank you!!! This is a great tip&#8230;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-105">
		<div id="comment-105">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">farn-yu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-105">August 12, 2004 at 2:24 pm</a></div>

		<div class="comment-body"><p>Paul,  thanks for the article.  </p>
<p>In your code, you hardcorded &quot;WindowsForms10.Window.8.app3&quot;.  Some forms have class name of &quot;WindowsForms10.Window.8.app4&quot;.  </p>
<p>Do know you know how to check what class a Form is?</p>
<p>Thanks for your help.<br />
<br />Farn-Yu<br />
<br /><a href="mailto:farn_yu@yahoo.com">farn_yu@yahoo.com</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-104">
		<div id="comment-104">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Paul Laudeman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-104">July 19, 2004 at 3:46 pm</a></div>

		<div class="comment-body"><p>Hi Michael, thanks for the comment! I&#8217;ve enjoyed reading many of your posts and articles, too!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-103">
		<div id="comment-103">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Michael Weinhardt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-103">July 19, 2004 at 3:43 pm</a></div>

		<div class="comment-body"><p>This is a great piece. Thanks for writing it up!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-102">
		<div id="comment-102">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-102">July 19, 2004 at 10:27 am</a></div>

		<div class="comment-body"><p>This works great for our little client app we all have running.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-101">
		<div id="comment-101">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Mark Bonafe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#comment-101">July 17, 2004 at 7:04 pm</a></div>

		<div class="comment-body"><p>Nice job Paul!  I&#8217;ll have to mark this page in my favorites list.</p>
<p>But &quot;minimal effort??&quot;  &lt;sigh&gt;  It&#8217;s code like this that makes me long for the real minimal effort of:</p>
<p>if App.PrevInstance() then<br />
<br />    MsgBox(&quot;No can do!&quot;)<br />
<br />    &#8230; code to find and open previous instance<br />
<br />    return<br />
<br />endif</p>
<p>hmmm &#8211; guess I&#8217;m giving away my VB roots.</p>
<p>Seriously, though.  Well done!  This is a keeper.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/paullaudeman/2004/07/17/windows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/paullaudeman/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fpaullaudeman%2F2004%2F07%2F17%2Fwindows-forms-tip-ensure-only-one-instance-of-your-application-is-running-at-a-time%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.530 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 12:07:42 -->
<!-- super cache -->