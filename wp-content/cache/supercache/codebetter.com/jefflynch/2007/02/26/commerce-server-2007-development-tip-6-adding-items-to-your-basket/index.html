<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Commerce Server 2007: Development Tip #6 &#8211; Adding Items to your Basket | Jeff Lynch</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jefflynch/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/jefflynch/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/jefflynch/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jefflynch/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/jefflynch/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Jeff Lynch' href='http://codebetter.com/jefflynch/' />
<link rel='start' title='Welcome from &#8220;A BizTalk Enthusiast&#8221;' href='http://codebetter.com/jefflynch/2004/07/01/welcome-from-a-biztalk-enthusiast/' />
<link rel='prev' title='Visual Studio Team Edition for Database Professionals: Schema View Synchronization' href='http://codebetter.com/jefflynch/2007/02/21/visual-studio-team-edition-for-database-professionals-schema-view-synchronization/' />
<link rel='next' title='Off Topic: In Seattle for the MVP Summit' href='http://codebetter.com/jefflynch/2007/03/12/off-topic-in-seattle-for-the-mvp-summit/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/' />
<link rel='shortlink' href='http://codebetter.com/jefflynch/?p=200' />
<link rel="stylesheet" href="http://codebetter.com/jefflynch/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/jefflynch/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-200" class="post-200 post type-post status-publish format-standard hentry category-commerce-server-2007">
					<h1 class="entry-title">Commerce Server 2007: Development Tip #6 &#8211; Adding Items to your Basket</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jefflynch/author/jefflynch/" title="View all posts by jefflynch">jefflynch</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/" title="10:45 pm" rel="bookmark"><span class="entry-date">February 26, 2007</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jefflynch/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/jefflynch/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jefflynch/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><P><FONT size="2"><FONT face="Segoe UI"><FONT color="#ff0000"><EM>I&#8217;ve revised the code presented in this post after a reader pointed out the (seemingly obvious, but I never saw it) flaw in my code</EM></FONT><FONT color="#ff0000"><EM>. It&#8217;s always important to have someone checking your code occasionally. Special thanks to Tim Bond for pointing out this error.</EM></FONT></FONT></FONT></P><br />
<P><FONT face="Segoe UI" size="2"><STRONG>Tip #6 &#8211; Adding Items to your Basket</STRONG></FONT></P><br />
<P><FONT face="Segoe UI" size="2">The basic funtionality of the&nbsp;<FONT color="#006400">LineItem</FONT> class&nbsp;has changed&nbsp;little&nbsp;from Commerce Server 2002 and&nbsp;adding an item to your basket works&nbsp;pretty much as it did in the previous version.</FONT></P><br />
<P><IMG src="http://codebetter.com/photos/jeff.lynch/images/162460/original.aspx"></P><FONT face="Verdana"><br />
<DIV></FONT><FONT face="Segoe UI" size="2">The first thing to do is create a new <FONT color="#006400">LineItem</FONT> instance, set the required and optional (weakly-typed) properties and then add the <FONT color="#006400">LineItem</FONT> to the OrderForm&#8217;s <FONT color="#006400">LineItemCollection</FONT>.</FONT></DIV><br />
<P><FONT face="Segoe UI" size="2">As with every action taken in the Basket, you should always update the Basket and run the appropriate pipeline as shown here.</FONT></P><br />
<P><IMG src="http://codebetter.com/photos/jeff.lynch/images/162461/original.aspx"></P><FONT face="Verdana"><br />
<DIV></FONT><FONT face="Segoe UI" size="2">In Commerce Server 2007, it&#8217;s also important to remember to dispose of the <FONT color="#006400">PipeLineInfo</FONT> object to ensure that resources are released in a timely manner. </FONT><FONT face="Segoe UI" size="2">Also, since Commerce Server 2007 now supports multiple &#8220;named&#8221; baskets that are active at the same time, you may need to extend your code to accommodate this new feature.</FONT></DIV><br />
<P><FONT face="Segoe UI" size="2">[tags: Commerce Server 2007]</FONT></P></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jefflynch/category/commerce-server-2007/" title="View all posts in Commerce Server 2007" rel="category tag">Commerce Server 2007</a>. Bookmark the <a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/" title="Permalink to Commerce Server 2007: Development Tip #6 &#8211; Adding Items to your Basket" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/feed/" title="Comments RSS to Commerce Server 2007: Development Tip #6 &#8211; Adding Items to your Basket" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-200 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jefflynch/2007/02/21/visual-studio-team-edition-for-database-professionals-schema-view-synchronization/" rel="prev"><span class="meta-nav">&larr;</span> Visual Studio Team Edition for Database Professionals: Schema View Synchronization</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jefflynch/2007/03/12/off-topic-in-seattle-for-the-mvp-summit/" rel="next">Off Topic: In Seattle for the MVP Summit <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">13 Responses to <em>Commerce Server 2007: Development Tip #6 &#8211; Adding Items to your Basket</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-428">
		<div id="comment-428">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Vedavathi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-428">August 29, 2008 at 9:21 am</a></div>

		<div class="comment-body"><p>Hi Jeff,<br />
I have one query regarding pipelines. I am running the basket pipeline in my application after adding the items to cart. Before running the pipeline, the value of the property InStockQuantity is 1000, and Inventory status will be &#8216;InStock&#8217;. But immediatly after I run the pipeline, the InStockQuantity is 0 Inventory status will be OutOfStock. Although I am ordering for only 1 quantity of that item. Can I know what would have happened here.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-427">
		<div id="comment-427">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Padma</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-427">August 18, 2008 at 6:37 am</a></div>

		<div class="comment-body"><p>Hi Jeff,</p>
<p>In the code i see the if condition in the updatebasket method:</p>
<p>You are adding UserProfile to the trageting Collection. What do i do if i need to do the same for a custom profile that i created?</p>
<p>Thanks in advance<br />
Padma</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-426">
		<div id="comment-426">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Tushar Narayan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-426">August 4, 2008 at 7:19 am</a></div>

		<div class="comment-body"><p>Hi all,</p>
<p>We have developed our website using CS 2007,but we have not used pipelines.Now,  We want to implement pipelines in our website to use the marketing manager features.Please provide me some links how to use pipelines in our code.<br />
Waiting for the response.</p>
<p>Thank you,</p>
<p>Tushar Narayan</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-425">
		<div id="comment-425">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/jeff.lynch' rel='external nofollow' class='url'>jlynch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-425">July 4, 2008 at 4:50 am</a></div>

		<div class="comment-body"><p>@Bond &#8211; I&#8217;m not sure I understand your question. A &#8220;LineItem&#8221; is created using the runtime, added to the &#8220;LineItems&#8221; collection by the runtime and the persisted to the basket&#8217;s data store by the &#8220;basket.pcf&#8221; pipeline which converts the /NET objects into COM+ objects. That&#8217;s why you must always run the basket pipeline after changing the basket.</p>
<p>Does this answer your question or are you trying to add the &#8220;LineItem&#8221; without using the runtime?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-424">
		<div id="comment-424">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Bond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-424">July 2, 2008 at 6:33 am</a></div>

		<div class="comment-body"><p>Hey Jeff,</p>
<p>Have you tried adding lineitems in the pipeline component (basket.pcf) ? if so could you please share.</p>
<p>thanks<br />
Bond</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-423">
		<div id="comment-423">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/jeff.lynch' rel='external nofollow' class='url'>jlynch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-423">April 23, 2008 at 2:06 pm</a></div>

		<div class="comment-body"><p>Padma,</p>
<p>You don&#8217;t have to do anything special to update and save a basket, just use the code shown in the post. This persists the basket in the OrderTemplatesAndBaskets table in the <sitename>_transactions database as blob data. When the basket is converted to a PurchaseOrder, it is then persisted to the PurchaseOrders, LineItems, PurchaseOrderPayments, Shipments, OrderForms and OrderAddresses tables.</p>
<p>Jeff</sitename></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-422">
		<div id="comment-422">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Padma</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-422">April 16, 2008 at 1:35 pm</a></div>

		<div class="comment-body"><p>Hi,</p>
<p>I have a problem with the AcceptBasket in the BasKetManager class of OrderManagementContext.<br />
When the saveorder value is set to true, the basket is getting saved as purchase order. What should i do to save the basket as just a basket?<br />
When the saveOrder is set to false, then nothing is saved in the database. I am using agent services to achive this functionality.</p>
<p>Please help.</p>
<p>Regards &#038; Thanks<br />
Padma</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-421">
		<div id="comment-421">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">GFI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-421">November 17, 2007 at 6:43 pm</a></div>

		<div class="comment-body"><p>Hi Jeff,</p>
<p>I m facing a situation with baskets. Here&#8217;s the problem:<br />
In current code we are saving basket as Purchase order (bskt.saveAsOrder) after checkout pipeline. But we run into issues if in case there is a communication error from bank. If there&#8217;s a communication error there is no order saved in Database.<br />
I need to find a way to save this basket before checkout; run checkout pipeline and save it again.</p>
<p>I cant use saveAsOrder twice as it will clear the basket after first save.<br />
Can u suggest any alternative??</p>
<p>Thanks,<br />
GFI</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-420">
		<div id="comment-420">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/jeff.lynch' rel='external nofollow' class='url'>jlynch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-420">March 31, 2007 at 2:29 pm</a></div>

		<div class="comment-body"><p>Tim,</p>
<p>The Commerce Server 2007 PipelineInfo object is a wrapper around a COM+ dictionary object (a hold over from CS2002) and I believe my code is written correctly but I will check with the Commerce Server team. My understanding of how .NET interacts with COM+ is limited and the details of this object are not fully exposed in the Commerce Server Runtime APIs.</p>
<p>The details on this method can be found at <a href="http://msdn2.microsoft.com/en-us/library/microsoft.commerceserver.runtime.orders.pipelineinfo.dispose.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/microsoft.commerceserver.runtime.orders.pipelineinfo.dispose.aspx</a></p>
<p>According to the docs:</p>
<p>&#8220;Always call Dispose before you release your last reference to the PipelineInfo. Otherwise, the resources it is using will not be freed until the garbage collector calls the PipelineInfo object&#8217;s Finalize method.&#8221;</p>
<p>&#8212;<br />
Jeff</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-419">
		<div id="comment-419">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Tim Bond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-419">March 30, 2007 at 10:06 pm</a></div>

		<div class="comment-body"><p>Unless I am missing something this is a pretty cronic abuse of Dispose(). You have to call Dispose on every instance you create. In this code you create 2 instances one is never Dispose and the other is created just so that it can be disposed. You should also Dispose in the error case to so this should all be wrapped in a try-finally or a using. i.e. // Run the pipeline using (PipelineInfo info = GetBasketPipelineInfo(pipelinename)) { _Basket.RunPipeline(info); // Save the Basket _Basket.Save(); // Disposing of the PipelineInfo object done by the using }</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-418">
		<div id="comment-418">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www2.henryschein.com/' rel='external nofollow' class='url'>Glen J Fergo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-418">March 21, 2007 at 1:56 pm</a></div>

		<div class="comment-body"><p>Jeff,</p>
<p>We are receiving an error on a pretty regular basis.  Although I did not code our new site (which uses CS 2007) I am very familiar with CS 2000.</p>
<p>My question is this&#8230;</p>
<p>Is it safe to assume that this check (&#8216;If the Basket Doesn&#8217;t already have an OrderFormCollection&#8217;) cannot happen in two lines like this?</p>
<p>OrderForm dstOf = dst.OrderForms[0];<br />
if (dstOf == null)<br />
{<br />
}</p>
<p>I am guessing this will throw an exception if there are no OrderForms in the OrderGroup.</p>
<p>Thanks!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-417">
		<div id="comment-417">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/jeff.lynch' rel='external nofollow' class='url'>jlynch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-417">February 21, 2007 at 1:08 pm</a></div>

		<div class="comment-body"><p>Kevin,</p>
<p>I&#39;ll edit this post and include the code this afternoon. Ping me via my blog if you need it sooner.</p>
<p>Jeff</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-416">
		<div id="comment-416">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Kevin Burton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#comment-416">February 21, 2007 at 7:04 am</a></div>

		<div class="comment-body"><p>Can you also post the source to GetBasketPipelineInfo and the pipeline that you are running?</p>
<p>Thank you.</p>
<p>Kevin</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/jefflynch/2007/02/26/commerce-server-2007-development-tip-6-adding-items-to-your-basket/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/jefflynch/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fjefflynch%2F2007%2F02%2F26%2Fcommerce-server-2007-development-tip-6-adding-items-to-your-basket%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.255 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-27 11:12:53 -->
<!-- super cache -->