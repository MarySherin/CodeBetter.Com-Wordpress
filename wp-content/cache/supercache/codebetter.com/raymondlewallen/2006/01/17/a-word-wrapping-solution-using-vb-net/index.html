<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>A word wrapping solution using VB.Net | Raymond Lewallen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/raymondlewallen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/raymondlewallen/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/raymondlewallen/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/raymondlewallen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/raymondlewallen/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Raymond Lewallen' href='http://codebetter.com/raymondlewallen/' />
<link rel='start' title='Moving some blog entries' href='http://codebetter.com/raymondlewallen/2004/12/01/moving-some-blog-entries/' />
<link rel='prev' title='Database Basics Part Three &#8211; Isolation' href='http://codebetter.com/raymondlewallen/2006/01/11/database-basics-part-three-isolation/' />
<link rel='next' title='FireFox &#8211; The Hungry-Hungry Hippo?' href='http://codebetter.com/raymondlewallen/2006/01/19/firefox-the-hungry-hungry-hippo/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/' />
<link rel='shortlink' href='http://codebetter.com/raymondlewallen/?p=232' />
<link rel="stylesheet" href="http://codebetter.com/raymondlewallen/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/raymondlewallen/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-232" class="post-232 post type-post status-publish format-standard hentry category-net-development">
					<h1 class="entry-title">A word wrapping solution using VB.Net</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/raymondlewallen/author/raymondlewallen/" title="View all posts by raymondlewallen">raymondlewallen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/" title="3:18 pm" rel="bookmark"><span class="entry-date">January 17, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/raymondlewallen/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/raymondlewallen/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/raymondlewallen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>While helping a friend with some code, I ran into a situation where<br />
I needed to do something to word wrap lines that were going to<br />
print.&nbsp; The lines were actually data coming from a database where<br />
the max length of the field is over 300 characters.&nbsp; When making<br />
this data show up in a multiline textbox, it isn’t a big deal because<br />
we can word wrap it easily enough.&nbsp; The problem comes when you<br />
want to print this data.&nbsp; I needed to take the data stored in the<br />
textboxes and write it to a text file for printing at a later<br />
time.&nbsp; That was all fine, except when I printed, naturally, the<br />
lines would run off the side of the page.</p>
<p>So here is what I came up with.&nbsp; It was very difficult looking<br />
for solutions to handle word wrapping out on google.&nbsp; The<br />
solutions I did find seems overly complex for the problem that needed<br />
to be solved.&nbsp; If you have written a better solution, please let<br />
me know.&nbsp; This is the best I came up with in the&nbsp;time<br />
constraint I had to write it in (2 hours).</p>
<p>Keep in mind, this word wrapping is rather specific, because it is<br />
setup for a basic print layout in Portrait mode, 1” margins and<br />
printing 10pt Times New Roman font, which is where the 86 characters<br />
per line comes from.</p>
<p>My next update to this routine will be to handle changing printer settings and adjusting for those for proper word wrapping.</p>
</p>
<fieldset>
<legend>Word wrapping</legend>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Private</span> <span style="color: blue">Sub</span> SetupForPrint(<span style="color: blue">ByVal</span> currentText <span style="color: blue">As</span> TextBox, <span style="color: blue">ByVal</span> filename <span style="color: blue">As</span> <span style="color: blue">String</span>)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> currentStreamWriter <span style="color: blue">As</span> System.IO.StreamWriter = <span style="color: blue">New</span> System.IO.StreamWriter(filename)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is the max length we want any line to be.<span>&nbsp; </span>This is based on printing using</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>the font fact Times New Roman at a font size of 10.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> maxLengthOfALine <span style="color: blue">As</span> <span style="color: blue">Integer</span> = 86</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is our starting position within the text body wherewe start a new line</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> startingPosition <span style="color: blue">As</span> <span style="color: blue">Integer</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is the ending position within the text body where we end a new line</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> endingPosition <span style="color: blue">As</span> <span style="color: blue">Integer</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is used for the substring for the length of the line we need to pull.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>This has to be used because you can&#8217;t always break apart strings for</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>word wrapping at exactly 86 characters.<span>&nbsp; </span>You have to account for not</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>breaking words in half, so you have to break apart at spaces.<span>&nbsp; </span>You&#8217;ll</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>see this below</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> lineLength <span style="color: blue">As</span> <span style="color: blue">Integer</span> = maxLengthOfALine</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is the line that we will be writing to the file.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Dim</span> line <span style="color: blue">As</span> <span style="color: blue">String</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; Start looping through the text of the textbox until we reach the end.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">While</span> startingPosition &lt; currentText.Text.Length</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This locates the ending position of a line identified by a CRLF.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>endingPosition = currentText.Text.IndexOf(vbCrLf, startingPosition)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This tells us that the complete line, from start to CRLF, is less than</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>86 characters, so no word wrapping needs to be handled.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">If</span> endingPosition &#8211; startingPosition &lt; maxLengthOfALine <span style="color: blue">Then</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This tells us that we have reached the end of the file, so get</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>the line and get out of the loop.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">If</span> endingPosition = -1 <span style="color: blue">Then</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>line = currentText.Text.Substring(startingPosition, currentText.Text.Length &#8211; startingPosition)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>currentStreamWriter.Write(line)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Exit</span> <span style="color: blue">While</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Else</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; We are not at the end of the file, but we have a suitable line</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>to write that doesn&#8217;t need word wrapping.<span>&nbsp; </span>Get the line and</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>set the start position of the next line to the end position of the</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>current line + 1.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>line = currentText.Text.Substring(startingPosition, endingPosition &#8211; startingPosition)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>startingPosition = endingPosition + 1</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>currentStreamWriter.Write(line)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">If</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Else</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; THIS IS WHERE WORD WRAPPING IS HANDLED</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This continues to word wrap for every 86 characters in the line</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">While</span> lineLength + startingPosition &lt;= endingPosition</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This backtracks in the line in order to find a suitable place to word wrap,</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; in this case, a SPACE</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">While</span> currentText.Text.Substring(startingPosition + lineLength &#8211; 1, 1) &lt;&gt; Chr(32)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>lineLength -= 1</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">While</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; Get the line.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>line = currentText.Text.Substring(startingPosition, lineLength)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; Write the line.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>currentStreamWriter.Write(line &amp; vbCrLf)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; If we had to backtrack, we can&#8217;t add 1 to the count.<span>&nbsp; </span>This</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; prevents us from cutting off the first letter of the next word.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">If</span> lineLength &lt; maxLengthOfALine <span style="color: blue">Then</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>startingPosition += lineLength</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">Else</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span>startingPosition += lineLength + 1</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">If</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; Reset the lineLength back to the default.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lineLength = maxLengthOfALine</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">While</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; This is the end of the lines we had to word wrap.<span>&nbsp; </span>This writes</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216; the last line that got word wrapped to the file.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>line = currentText.Text.Substring(startingPosition, endingPosition &#8211; startingPosition)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>currentStreamWriter.Write(line)</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: green">&#8216; Set the start position of the next line to the end position of the</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">&#8216;<span>&nbsp;&nbsp;&nbsp; </span>current line + 1.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>startingPosition = endingPosition + 1</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">If</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">While</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;color: blue;font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>currentStreamWriter.Close()</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt"><span style="font-size: 10pt;font-family: Arial"><span>&nbsp;&nbsp;&nbsp; </span><span style="color: blue">End</span> <span style="color: blue">Sub</span></span></p>
</fieldset>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/raymondlewallen/category/net-development/" title="View all posts in .Net Development" rel="category tag">.Net Development</a>. Bookmark the <a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/" title="Permalink to A word wrapping solution using VB.Net" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/feed/" title="Comments RSS to A word wrapping solution using VB.Net" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-232 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/raymondlewallen/2006/01/11/database-basics-part-three-isolation/" rel="prev"><span class="meta-nav">&larr;</span> Database Basics Part Three &#8211; Isolation</a></div>
					<div class="nav-next"><a href="http://codebetter.com/raymondlewallen/2006/01/19/firefox-the-hungry-hungry-hippo/" rel="next">FireFox &#8211; The Hungry-Hungry Hippo? <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">7 Responses to <em>A word wrapping solution using VB.Net</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-1573">
		<div id="comment-1573">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">brackett@ufl.edu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1573">November 26, 2007 at 5:26 pm</a></div>

		<div class="comment-body"><p>I had to do a similar requirement for PDF output, and implemented it by splitting the text into words, and then building up words until I got a line&#8217;s worth. Something like:</p>
<p>using (StreamWriter output = new StreamWriter(..)) {<br />
     string[] words = text.Split(&#8216; &#8216;, &#8216;\n&#8217;); // I split on LF, leaving the CR to find an explicit newline<br />
     StringBuilder lineBuilder = new StringBuilder(CHARS_PER_LINE);<br />
     foreach (string word in words) {<br />
          if ((lineBuilder.Length + word.Length) > CHARS_PER_LINE || word.StartsWith(&#8220;\r&#8221;)) {<br />
               // wrap to next line<br />
               output.WriteLine(lineBuilder.ToString());<br />
               lineBuilder.Remove(0, lineBuilder.Length);<br />
               word = word.Replace(&#8220;\r&#8221;, string.Empty) // remove any explicit newline<br />
          }           </p>
<p>         // Add word<br />
         lineBuilder.Append(word).Append(&#8216; &#8216;);<br />
     }</p>
<p>     // Last line<br />
    output.WriteLine(lineBuilder.ToString());<br />
}</p>
<p>I actually had to handle page breaks and different font sizes (I chose to make scaled images on a seperate page in deference to my sanity) &#8211; so the actual code was a little bit messier. But the basic concept is the same.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1572">
		<div id="comment-1572">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Bob Lott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1572">November 26, 2007 at 2:47 pm</a></div>

		<div class="comment-body"><p>Wow!   This worked great right out of the box, Thank you for sharing!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1571">
		<div id="comment-1571">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Ninjacodermonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1571">February 15, 2007 at 5:39 pm</a></div>

		<div class="comment-body"><p>I dont recall ever hearing of a word over 86 characters long&#8230;. (JK)<br />
Great code, Raymond! You just helped me tremendously!  I have a console app that I need to print records from a database to a remote printer at my hospital.  This should work great! Thanks again!<br />
-TJ</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1570">
		<div id="comment-1570">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Jason Bell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1570">January 23, 2007 at 6:14 pm</a></div>

		<div class="comment-body"><p>Doesn&#8217;t properly handle lines of text > 86 characters with no white space.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1569">
		<div id="comment-1569">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>Raymond Lewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1569">January 17, 2006 at 5:14 pm</a></div>

		<div class="comment-body"><p>Great code!  I wish I could found that when searching for &#8220;Print Word Wrap VB.Net&#8221; and other variations when searching on google.  I&#8217;d never heard of MeasureString until you guys mentioned it.  In my defense, I&#8217;m not a UI programmer either, so I don&#8217;t feel bad for not knowing <img src='http://codebetter.com/raymondlewallen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1568">
		<div id="comment-1568">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://coolthingoftheday.blogspot.com/' rel='external nofollow' class='url'>Greg</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1568">January 17, 2006 at 4:55 pm</a></div>

		<div class="comment-body"><p>This is another example of using MeasureString that worked well for me&#8230;</p>
<p>&#8220;Print a long series of paragraphs in different fonts, breaking across pages in VB .NET</p>
<p>This example shows how to print a long series of paragraphs in different fonts, breaking across pages in VB .NET. It shows measure text to see where it needs to brake across pages, and how to tell VB not to draw partial words or lines.&#8221;</p>
<p><a href="http://www.vb-helper.com/howto_net_print_long_text.html" rel="nofollow">http://www.vb-helper.com/howto_net_print_long_text.html</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1567">
		<div id="comment-1567">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">BigJimInDC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#comment-1567">January 17, 2006 at 4:45 pm</a></div>

		<div class="comment-body"><p>Try using the</p>
<p>Graphics.MeasureString Method (String, Font)</p>
<p><a href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemdrawinggraphicsclassmeasurestringtopic1.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemdrawinggraphicsclassmeasurestringtopic1.asp</a></p>
<p>That way you won&#8217;t have to hard code for a particular font face, size, etc&#8230;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/raymondlewallen/2006/01/17/a-word-wrapping-solution-using-vb-net/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/raymondlewallen/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fraymondlewallen%2F2006%2F01%2F17%2Fa-word-wrapping-solution-using-vb-net%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.326 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-27 11:07:31 -->
<!-- super cache -->