<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>The spirit of MVVM (ViewModel), it’s not a code counting exercise. | Glenn Block</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/glennblock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/glennblock/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/glennblock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/glennblock/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Glenn Block' href='http://codebetter.com/glennblock/' />
<link rel='start' title='IoC.AddComponent&lt;IBloggingStrategy, CodeBetterBloggingStrategy&gt;();' href='http://codebetter.com/glennblock/2008/01/03/ioc-addcomponent-lt-ibloggingstrategy-codebetterbloggingstrategy-gt/' />
<link rel='prev' title='Stable Composition in MEF Preview 6' href='http://codebetter.com/glennblock/2009/08/02/stable-composition-in-mef-preview-6/' />
<link rel='next' title='Should I use MEF for my general IoC needs?' href='http://codebetter.com/glennblock/2009/08/16/should-i-use-mef-for-my-general-ioc-needs/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/glennblock/2009/08/03/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise/' />
<link rel='shortlink' href='http://codebetter.com/glennblock/?p=98' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/mytechnobabble/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-98" class="post-98 post type-post status-publish format-standard hentry category-mvvm category-viewmodel">
					<h1 class="entry-title">The spirit of MVVM (ViewModel), it’s not a code counting exercise.</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/glennblock/author/glennblock/" title="View all posts by Glenn Block">Glenn Block</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/glennblock/2009/08/03/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise/" title="5:13 am" rel="bookmark"><span class="entry-date">August 3, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/glennblock/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/glennblock/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/glennblock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>&lt;Warning&gt;Long post follows&lt;/Warning&gt;</p>
<p>Lately there is a lot of momentum and interesting <a href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=MVVM+ViewModel&amp;nots=&amp;tag=&amp;lang=en&amp;from=&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=50">conversation</a> around Model-View-View-Model. There’s several good resources out there that discuss the basics of the pattern, who the actors are that are involved and what role the play. I’ll let those speak for themselves, including <a href="http://blogs.msdn.com/johngossman">John Gossman’s</a> great <a href="http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx">post</a> here, Martin Fowler’s post on the more general <a href="http://martinfowler.com/eaaDev/PresentationModel.html">PresentationModel</a> pattern and more recently <a href="http://joshsmithonwpf.wordpress.com/">Josh Smith’s</a> MSDN <a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx">article</a>, Rob Eisenberg’s new <a href="http://devlicio.us/blogs/rob_eisenberg/archive/2009/07/07/mvvm-philosophy-and-case-studies-introduction.aspx">series</a>, and Ward Bell’s <a href="http://neverindoubtnet.blogspot.com/2009/05/birth-and-death-of-m-v-vm-triads.html">posts</a> which touch on some of the deeper complexities involved.</p>
<p>In many of these discussions (not including the posts I referred to) it seems like one aspect of ViewModel get’s lost, which is “Why use it in the first place?” This leads to a lot of debate around details of implementation including one item in particular which is whether or not <a href="http://www.lhotka.net/weblog/InitialThoughtsOnMVVM.aspx">code in the code-behind</a> is an anti-pattern. Building off of the stage <a href="http://www.haacked.com/">Phil</a> set in his great <a href="http://haacked.com/archive/2009/07/14/law-of-demeter-dot-counting.aspx">LOD</a> post, I’ll say ViewModel is not a code-counting exercise.</p>
<h2>The essence and the spirit</h2>
<p>John says in his post, “Model/View/ViewModel is a variation of Model/View/Controller (MVC) that is tailored for modern UI development platforms where the View is the responsibility of a designer rather than a classic developer.&#160; The designer is generally a more graphical, artistic focused person, and does less classic coding than a traditional developer.”</p>
<p>Martin then states in this Bliki that “The essence of a Presentation Model is of a fully self-contained class that represents all the data and behavior of the UI window, but without any of the controls used to render that UI on the screen. A view then simply projects the state of the presentation model onto the glass.” Martin then adds “It&#8217;s useful for allowing you to test without the UI, support for some form of multiple view and a separation of concerns which may make it easier to develop the user interface.”</p>
<p>From John’s perspective, it is a pattern that enables a UX designer (non-developer) to be <em>responsible</em> for the UI. From Martin’s perspective it’s about separation-of-concerns and testability. So which one is right? I say both. Also notice neither one said anything about having zero-code in the code-behind. Instead they spoke about maintainability.</p>
<p>So what is the spirit of MVVM then? I say it’s building UIs that utilize platform enhancements in WPF and Silverlight to provide good separation between UI and business logic in order to make those UIs easier to maintain by developers and designers. </p>
<p>When I say designer, I don’t mean only the stereotypical guy/gal who wears a black sweater <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> . It may also be a developer who is using Blend/Cider to define the UI, which is likely, as we all know hand coding a ton of XAML is anything but fun.</p>
<p>Why have I called out WPF and Silverlight? Because the pattern is specific and solely on the specific data binding, data templates, attached properties and command implementations found in the platform. Presentation Model on the other hand is entirely general and places no such specificity. I would not for example recommend ViewModel as an appropriate pattern for ASP.NET or Winforms, but I would however recommend PresentationModel, in addition to MVP, etc.</p>
<h2>It’s not about counting code</h2>
<p>They key here (and which I want to touch on) is the last part, “easier to maintain by developers and designers.”. This means (if you buy my definition) that the chosen implementation should consider both aspects of the equation, that is what does it do for the developer and what does it do for the designer. Obviously tradeoffs have to be made, but the key is finding a healthy balance, reducing the negative impact to both.</p>
<p>Which brings us to the code counting question. Does having zero code in the code-behind make the UI easier to maintain? I say it depends on what kind of code you are talking about:</p>
<p>If the code is UI level business logic which does not relate directly to the rendering of the view, such as determining whether or not certain elements are visible, or enabled, then I agree, this kind of code is a separate concern and should not appear in the View at all and be within the ViewModel. I would include in this the XAML, as the XAML is still part of the view. Why shouldn’t this logic be there? Because it makes the UI difficult to maintain by creating a tight coupling between the UI and the logic. It makes it difficult to test, and is also very brittle and likely to break as the UI evolves in response to changing requirements.</p>
<p>On the other side of the coin are UI-specific concerns, I would include in this setting enabled state, visibility or starting/stopping animations as well as even logic that relates to which model data a specific UI element binds to. That may sound contradictory to my previous statement but it is not. What I mean is, the ViewModel should contain the logic to determine whether something is visible or not, and the View should act on that knowledge to then hide the element. Adding this logic to the ViewModel would introduce tight coupling between the ViewModel and the View, this time from the ViewModel side.</p>
<p>Now being that it is a UI specific concern, the next question is how should it be handled, as code in the code-behind or in XAML? And for that answer I would say it depends on the specific concern itself, as well as whether or not there is a UX designer who handles the UI. Even still,&#160; I would look at an approach that best meets the needs of both developers and designers.</p>
<h2>Data binding</h2>
<p>Let’s take data binding as an example. If I am working with a dedicated UX designer then bindings in XAML is the prevalent technique that our tooling provides for data binding. Now it does negatively impact the development team to some degree in that due to XAML’s very loose nature it is very easy to break and difficult to verify and test. However there’s no other option for the designer other than forcing them to write code, which is how should we say less than optimal. </p>
<p>If there was no UX designer present however, I would see no issue with putting that binding definition in code, even in the code-behind. As developers are used to writing code, not markup, and the developer IDE provides much richer support for developers in code. Now that being said, the API for defining bindings is not really well-suited for doing them in code, but OSS solutions like <a href="http://www.lostechies.com/blogs/gabrielschenker/archive/2009/06/01/fluent-silverlight-part-1.aspx">“Fluent Silverlight”</a> help bridge that gap. </p>
<h2>Animations</h2>
<p>A different example relates to animations. The user clicks a Save button on the Edit Order screen which requires some UI cue to the user such as an hourglass while the order is saving, and another cue once the Order has saved. The question is where should this logic live? In the XAML or in the code? You could handle this in the XAML by using triggers, attached behaviors and the like. In the case of Silverlight, you don’t yet have triggers yet baked in, but you could look to using those included with <a href="http://msdn.microsoft.com/en-us/magazine/cc721608.aspx">Blend</a>. </p>
<p>Now although you “could”, I wouldn’t, though you might feel different. The reason goes back to maintainability, having such logic in the view means once again it is easy to break and difficult to test (How do I know it actually works?). Instead, I would opt in this case to separate into two parts, the pure visual part and the logic. The pure visual would be the hour glass animation, and the saved completed screen which could likely be purely defined in XAML. However, the logic part which determines to show the hour glass while saving is in progress would rest in the code. I would achieve this by adding OnSave,OnSaveCompleted methods to the view which would both contain the logic to actually display the elements. </p>
<p>The ViewModel would get injected with either an interface to the view, or with a set of delegates it could call to once save begins and completes. Yes, I did say I’d put code in the code-behind! That is ok because it is code that relates entirely to a view-level concern. Also I would argue that putting the one line of code in the View, only minimally impacts the designer. They can still verify that the animations works. On the plus side it means that we’re remove one more potential piece of brittle, un-testable logic. Also it improves debugging as a developer can put a break-point on the view methods to and see whether or not they are even getting called, additionally it ensures that an exception is thrown if the animation in question is removed.</p>
<h2>Commands and Parameters</h2>
<p>The last thing I want to touch on relates to invoking commands, and usage of command parameters through element binding, vs using bound properties on the ViewModel. The user selects an item in the Order list, and double clicks. Do we a) Use element binding and have clicking on the “Open Order” button invoke the OpenOrder command passing in the currently selected order as a parameter, or b) Set the orders list selected item to bind to a SelectedOrder ViewModel property and then have a parameterless OpenOrder command which uses the SelectedOrder order property on the VM itself. </p>
<p>I would argue B over A, and why relates back to the maintainability question. If I use element binding, again I make the view harder to maintain. In this case, I haven’t coupled it to the VM, but I have coupled one part of the View to another part of the View. The impact here is on future refactorings of the View. If move around elements in the view such that the relative binding is broken, I broke my UI, if I use the second approach however, I can re-factor / replace elements all day long without breaking any relative bindings. </p>
<p>Yes, I’ve added properties to the ViewModel, but those properties are easy to discover, and result in UIs that are less prone to break over time. I should also add that using approach B works just as well for a designer, as they can easily bind to the properties on the VM for the parameters and parameterless commands.</p>
<h2>Conclusion</h2>
<p>In conclusion, the spirit of MVVM is about producing maintainable UIs for the developer and the designer, not UIs that have zero code. I would recommend folks who are developing using the MVVM pattern to focus less on whether or not there is code in the code behind, and rather focus on the type of code and whether it improves / or hinders the maintainability of the UI. Sometimes having a bit of code in the code behind actually goes a long way toward improving it.</p>
<p>What are your thoughts on this topic? I’d love to hear them.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/glennblock/category/mvvm/" title="View all posts in MVVM" rel="category tag">MVVM</a>, <a href="http://codebetter.com/glennblock/category/viewmodel/" title="View all posts in ViewModel" rel="category tag">ViewModel</a>. Bookmark the <a href="http://codebetter.com/glennblock/2009/08/03/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise/" title="Permalink to The spirit of MVVM (ViewModel), it’s not a code counting exercise." rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/glennblock/2009/08/03/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise/feed/" title="Comments RSS to The spirit of MVVM (ViewModel), it’s not a code counting exercise." rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-98 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/glennblock/2009/08/02/stable-composition-in-mef-preview-6/" rel="prev"><span class="meta-nav">&larr;</span> Stable Composition in MEF Preview 6</a></div>
					<div class="nav-next"><a href="http://codebetter.com/glennblock/2009/08/16/should-i-use-mef-for-my-general-ioc-needs/" rel="next">Should I use MEF for my general IoC needs? <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-399">
					<div id="dsq-comment-header-399" class="dsq-comment-header">
						<cite id="dsq-cite-399">
	http://www.neverindoubtnet.blogspot.com/							<span id="dsq-author-user-399">Ward Bell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-399" class="dsq-comment-body">
						<div id="dsq-comment-message-399" class="dsq-comment-message"><p>Excellent. Allow me to pile on.</p>
<p>One thing I&#8217;ve noticed is that XAML, as we know it in Silverlight at least, is hard to keep DRY. Consider what a Binding looks like when you arrange for it to support the display of validation errors and exceptions. You start to see a parade of attributes as in</p>
<p><textbox Text="{Binding Person.Name, Mode=TwoWay, ValidatesOnExceptions=True, NotifyOnValidationError=True}" /></p>
<p>Mode, ValidateOnExceptions, and NotifyOnValidationError appear not once but in binding after binding.</p>
<p>This is just one example. Suppose you find a way to rinse this detritus away (and please tell me about it &#8230; I sure miss Markup Extensions in SL).</p>
<p>Even if you beat this one, the tendency creeps back in. We start marking up the code with all kinds of behavioral concerns that are easy to get wrong, hard to debug, and just are not what designers are good at.</p>
<p>For it is also my experience that Designers are as bad at writing clean code as I am at writing good looking views.</p>
<p>Finally, I&#8217;ll mention that the habit of marking the heck out of every little thing clouds our ability to see programmatic opportunities. </p>
<p>Maybe we shouldn&#8217;t be marking up Person.Name at all. Maybe, if we had an easy way to walk the XAML tree, we could automate the wiring of the binding by letting convention tell us that &#8220;Person.Name&#8221; is accessible from the ViewModel.</p>
<p> Now, we write XAML such as</p>
<p><textbox x:Name="Name"/>.</p>
<p>A one-line wizbang in the code-behind constructs the binding for us &#8230; and not just for this TextBox but for every control bound to a property of Person.</p>
<p>I want smaller XAML, not XAML gone wild &#8230; XAML gone wilder still through the generative powers of Blend. I&#8217;ll trade a line or two of easy-to-read, easy-to-write, concentrated, testable code-behind in exchange for a big reduction in XAML.</p>
<p>I know I&#8217;m not telling _you_ anything, Glenn &#8230; because I know you worked on this very thing</p>
<p>But readers of this post should realize what we sacrifice when we seek to program with ever-more-clever XAML markup.</p>
<p>Again, way to go in clearly laying out the positions and teeing up this discussion.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-400">
					<div id="dsq-comment-header-400" class="dsq-comment-header">
						<cite id="dsq-cite-400">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-400">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-400" class="dsq-comment-body">
						<div id="dsq-comment-message-400" class="dsq-comment-message"><p>Thanks Ward!</p>
<p>Yes i agree with everything you&#8217;ve said. Having XAML support a set of conventions I believe (like you) goes a long way. It removes the question of where to put things, rather those concerns just vanish into convention thin-air.</p>
<p>I hpoe once day our platform supports more of a convention driven approach. We&#8217;ve got a great head start with ASP.NETMVC, but hopefully we&#8217;ll keep going with Silverlight and WPF. I know that conventions are not for everyone, but for those who embrace them, they make life oh so easier <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_wink.gif' alt=';-)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-401">
					<div id="dsq-comment-header-401" class="dsq-comment-header">
						<cite id="dsq-cite-401">
								<span id="dsq-author-user-401">Clint</span>
							</cite>
					</div>
					<div id="dsq-comment-body-401" class="dsq-comment-body">
						<div id="dsq-comment-message-401" class="dsq-comment-message"><p>I&#8217;ve been wanting to learn WPF and MVVM lately. As someone who is new to these, what article do you think would be best for a beginner?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-402">
					<div id="dsq-comment-header-402" class="dsq-comment-header">
						<cite id="dsq-cite-402">
	http://www.galasoft.ch							<span id="dsq-author-user-402">Laurent Bugnion</span>
							</cite>
					</div>
					<div id="dsq-comment-body-402" class="dsq-comment-body">
						<div id="dsq-comment-message-402" class="dsq-comment-message"><p>Hey Glenn,</p>
<p>Great post, and yes, code behind is ok as long as it is view related. </p>
<p>One thing i want to mention is a 3rd approach to ‘kick’ an action when selected an item: you can add a property of type ICommand to your VM and use that (with paramters if needed). To speed things up and make the code cleaner, i prefer to use a RelayCommand, but of course other implementations work as well. The command is used as a gateway to an action on the VM. In the case of a SelectedItem, it might not be the best solution, but for elements such as buttons etc&#8230;, it makes sense to use commands instead of events, and having the command on the VM and relaying the action is a very clean way. It is also possible to test the command in unit tests (though testing the CanExecute can be tricky in WPF because the CommandManager is tied to the UI). Now to be honest, i am not sure if this is what you meant with the solution A, but this would not need element binding (since the command is a property of the VM, which is the implicit data context).</p>
<p>Of course yet another solution is to use behaviors such as the ones published lately by Pete Blois from the Blend team. This introduces a dependency to the behaviors DLL which can be easily avoided by using something simple like RelayCommand or Prism’s DelegateCommand.</p>
<p>Looking forward to further discussions about this (and yes now that i am back home i will blog more about all that <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Cheers,<br />
Laurent</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-403">
					<div id="dsq-comment-header-403" class="dsq-comment-header">
						<cite id="dsq-cite-403">
	http://wekempf.spaces.live.com							<span id="dsq-author-user-403">wekempf</span>
							</cite>
					</div>
					<div id="dsq-comment-body-403" class="dsq-comment-body">
						<div id="dsq-comment-message-403" class="dsq-comment-message"><p>I agree with most of this post. I don&#8217;t think the knowledgeable folks have said that &#8220;no codebehind&#8221; was a goal of MVVM, but I can see how things that even I&#8217;ve said myself could be misunderstood . I advocate no codebehind, not as a goal of MVVM, but as a goal of making the View as &#8220;designer only&#8221; as possible. Many designers wouldn&#8217;t have  a clue how to modify the codebehind, and I&#8217;d prefer that designers and developers not have to work so closely together that codebehind magic would be necessary. These are distinct things, though. MVVM helps to eliminate codebehind, but it&#8217;s not the only thing necessary to accomplish that goal (things like value converters, markup extensions and behaviors are required as well), nor does MVVM concern itself with codebehind. We (those of us who want to eliminate most codebehind) probably do need to make this clearer in our discussions.</p>
<p>Ward&#8217;s convention idea is doable today. Walking the tree is easy, and so creating bindings based on conventions should be relatively easy as well. It wouldn&#8217;t even require codebehind to accomplish this. I think this sort of thing is what we should be moving towards, and I&#8217;ve actually been working on some of these ideas already.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-404">
					<div id="dsq-comment-header-404" class="dsq-comment-header">
						<cite id="dsq-cite-404">
	http://www.thejoyofcode.com/							<span id="dsq-author-user-404">Josh Twist</span>
							</cite>
					</div>
					<div id="dsq-comment-body-404" class="dsq-comment-body">
						<div id="dsq-comment-message-404" class="dsq-comment-message"><p>Great post Glenn &#8211; I think you&#8217;ve nailed the &#8216;when it&#8217;s OK to code-behind&#8217; question here.</p>
<p>You should have called this post &#8216;the spirit of MVVM&#8217; or something as you&#8217;ve really capture it here <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Just of other comment readers &#8211; there was a discussion on Rocky Lhotkas blog about this recently: <a href="http://www.lhotka.net/weblog/CommentView,guid,e550e8f1-9d50-41ed-8ffe-ef87a11f90f6.aspx#commentstart" rel="nofollow">http://www.lhotka.net/weblog/CommentView,guid,e550e8f1-9d50-41ed-8ffe-ef87a11f90f6.aspx#commentstart</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-405">
					<div id="dsq-comment-header-405" class="dsq-comment-header">
						<cite id="dsq-cite-405">
	http://www.acceptedeclectic.com							<span id="dsq-author-user-405">pete w</span>
							</cite>
					</div>
					<div id="dsq-comment-body-405" class="dsq-comment-body">
						<div id="dsq-comment-message-405" class="dsq-comment-message"><p>Ive been using MVVM for a few years now, and I have a love/hate relationship with the pattern.</p>
<p>I love it for its reliability. No matter how simple nor complex the UI may be, I can depend on successful results by following some simple rules. Heck I even use ViewModels in ASP.NET MVC!</p>
<p>I dont like it for the same reason as many other detractors claim it is redundant, violating DRY etc. As programmers, we tend to not be satisfied with a solution until it is elegant and succinct, and MVVM is neither. </p>
<p>Maybe once C# 4 rolls around we can revisit the debate and come up with something more elegant but in the meantime, I&#8217;ll make peace with cranking out some more ViewModels <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-406">
					<div id="dsq-comment-header-406" class="dsq-comment-header">
						<cite id="dsq-cite-406">
	http://devlicious.com/members/bennage/default.aspx							<span id="dsq-author-user-406">Christopher Bennage</span>
							</cite>
					</div>
					<div id="dsq-comment-body-406" class="dsq-comment-body">
						<div id="dsq-comment-message-406" class="dsq-comment-message"><p>@Glenn, Wow, you took the words right out of my mouth with this post. I missed most of the weekend tweets about this, but the the question of &#8220;Why use VM?&#8221; and your answer are mine exactly.</p>
<p>@Ward, I agree with you as well. Convention-based XAML is something I think more and more about all the time. It&#8217;s a little reminiscent of the strongly typed UI helpers in MVC. I&#8217;m sure that if you give Rob 24 hours, he&#8217;ll have it up and running in Caliburn.</p>
<p>@Clint, if I can be selfish, check out our book:<br />
<a href="http://www.amazon.com/Sams-Teach-Yourself-WPF-Hours/dp/0672329859" rel="nofollow">http://www.amazon.com/Sams-Teach-Yourself-WPF-Hours/dp/0672329859</a><br />
It&#8217;s an intro to WPF but we talk about this style of development as well, though the concepts have matured a great deal since it was published.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-407">
					<div id="dsq-comment-header-407" class="dsq-comment-header">
						<cite id="dsq-cite-407">
	http://kentb.blogspot.com							<span id="dsq-author-user-407">Kent Boogaart</span>
							</cite>
					</div>
					<div id="dsq-comment-body-407" class="dsq-comment-body">
						<div id="dsq-comment-message-407" class="dsq-comment-message"><p>Fantastic post, Glenn.</p>
<p>> The ViewModel would get injected with either an interface to the view, or with a set of delegates it could call to once save begins and completes</p>
<p>Can it not just maintain a state machine? For example, it could expose a property called State that changes between Idle, Saving, Saved and back to Idle. The VM updates this property as necessary and the view just binds to it and uses it as a trigger for animations. This just seems simpler to me than having the VM explicitly call back into the view.</p>
<p>> Yes, I’ve added properties to the ViewModel, but those properties are easy to discover, and result in UIs that are less prone to break over time.</p>
<p>Those properties are also there to *model the view*. If the view exposes selection, then why shouldn&#8217;t that selection be manifested in the view model? Doing so allows my unit tests to easily and naturally imitate users selecting an item. To that end, I would have a SelectedOrder property on my VM, just as you recommend.</p>
<p>@Ward: it is possible to factor out a lot of repetition in SL XAML to attached behaviors. To take your example, you could do something like:</p>
<p><textbox b:Bindings.ValidatedSuperDuperBinding="Person.Name"/></p>
<p>The attached behavior then goes off and creates the Binding object as appropriate and assigns it to the TextBox.Text property. You&#8217;re limited only by your imagination here.</p>
<p>What&#8217;s not clear to me is how well this works in practice with designers. That is, would the designer know how to apply the attached behavior? Would they want to? Is it more effort for them to set the attached behavior than it is to re-configure the binding every time?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-408">
					<div id="dsq-comment-header-408" class="dsq-comment-header">
						<cite id="dsq-cite-408">
	http://popcode.com							<span id="dsq-author-user-408">Ed McPadden</span>
							</cite>
					</div>
					<div id="dsq-comment-body-408" class="dsq-comment-body">
						<div id="dsq-comment-message-408" class="dsq-comment-message"><p>Great Post Glenn.</p>
<p>I am working on a Silverlight app that is written using Prism. I use the MVVM pattern throughout.  But I do find occassions where I need to work in the code behind to perform some very view specific functionality that would be very akward to push back into the VM.  </p>
<p>There are also times where I am using 3rd party controls that don&#8217;t do a good job at being compatible with the MVVM pattern.  In these caes, it is just easier and more maintainable to handle events from these controls in the code behind and in the code behind call back into the VM when appropriate. </p>
<p>While I&#8217;d rather keep as much as I can out of the code behind &#8230; but I don&#8217;t think it needs to be done at the cost of being overly complex when the code addresses view specific concerns.</p>
<p>Thanks Glenn for this insightful post.</p>
<p>&#8230;Ed</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-409">
					<div id="dsq-comment-header-409" class="dsq-comment-header">
						<cite id="dsq-cite-409">
								<span id="dsq-author-user-409">Steve Py</span>
							</cite>
					</div>
					<div id="dsq-comment-body-409" class="dsq-comment-body">
						<div id="dsq-comment-message-409" class="dsq-comment-message"><p>I&#8217;m no expert on VM or even MVP though the common theme is separation of responsibility, and it seems that the differences just boils down to semantics or pedantics. </p>
<p>I hate seeing any kind of business logic in the UI. To that effect, I&#8217;d say the best frame of mind to be in when considering patterns for UI, whether MVP, MVC, or MVVM is to try your hardest to ensure that there are no conditional statements involving domain objects, or even involving parameters in your code-behind.</p>
<p>UI code should signal a controller, or presenter, or ViewModel, whatever you want to call it, with the actions taken by the user. The controller does it&#8217;s mojo, then tells the view to refresh with a specific state. UI renders and interacts, and does nothing else.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-410">
					<div id="dsq-comment-header-410" class="dsq-comment-header">
						<cite id="dsq-cite-410">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-410">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-410" class="dsq-comment-body">
						<div id="dsq-comment-message-410" class="dsq-comment-message"><p>Hi Laurent, my example my not have been a good one. I was trying to give an example that involves using releative binding to grab the parameter.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-411">
					<div id="dsq-comment-header-411" class="dsq-comment-header">
						<cite id="dsq-cite-411">
	http://neilmosafi.blogspot.com							<span id="dsq-author-user-411">Neil Mosafi</span>
							</cite>
					</div>
					<div id="dsq-comment-body-411" class="dsq-comment-body">
						<div id="dsq-comment-message-411" class="dsq-comment-message"><p>I think until designers (e.g. Blend. Cider, etc) have explicit support for the MVVM architecture, it&#8217;s going to be hard to get the proper designer/developer workflow going that is so often espoused by MS etc.</p>
<p>We need Blend to have a feature like &#8220;create a view from a view model&#8221; that lists all the view models in the application and allows views to be created for them.  The designer gets to see all the properties and commands on the view model and can easily create UI elements which bind to those.</p>
<p>In short, if the pattern were explicitly acknowledged as the preferred way of doing things, it would help immensely.  Currently it&#8217;s just baked on top of the existing framework, and is often implemented slightly differently in each application it&#8217;s used in!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-412">
					<div id="dsq-comment-header-412" class="dsq-comment-header">
						<cite id="dsq-cite-412">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-412">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-412" class="dsq-comment-body">
						<div id="dsq-comment-message-412" class="dsq-comment-message"><p>Thanks Neil, that is good feedback which I will forward on to the Blend team.</p>
<p>I agree that there needs to be better tooling support both in Blend and our developer tools.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-413">
					<div id="dsq-comment-header-413" class="dsq-comment-header">
						<cite id="dsq-cite-413">
	http://vbandi.dotneteers.net							<span id="dsq-author-user-413">Andr&#225;s Velv&#225;rt</span>
							</cite>
					</div>
					<div id="dsq-comment-body-413" class="dsq-comment-body">
						<div id="dsq-comment-message-413" class="dsq-comment-message"><p>Glenn, this is very interesting and thought provoking. There is one issue with parameterless commands though. Consider a list of items in Silverlight or WPF, listed in an ItemsControl (not a ListBox). The ItemsControl does not have a SelectedItem property, so how will the VM differentiate between the items that the user has clicked on? I am considering that we should allow the DataContext of the item to be passed along with the command. DataContext should be a ViewModel or Model object anyway, so the integrity of the VM is not harmed.</p>
<p>Love the captcha btw. <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-414">
					<div id="dsq-comment-header-414" class="dsq-comment-header">
						<cite id="dsq-cite-414">
	http://goblincave.net							<span id="dsq-author-user-414">Magnus Lund</span>
							</cite>
					</div>
					<div id="dsq-comment-body-414" class="dsq-comment-body">
						<div id="dsq-comment-message-414" class="dsq-comment-message"><p>I agree mostly with you on your points &#8211; it is not until recently I finally gave into ModelViews. </p>
<p>One thing, I still like to keep in XAML is value-converters. I know many swear to having most if not all properties be of type string on the ViewModelView and then handle conversion in the ViewModel. However, I like the maintainability of global resourcedictionaries and having the binding be somewhat more complex. For me it is easier to maintain my bindings than maintaining all the properties in the ViewModel.</p>
<p>Another thing, I keep in my code-behind is handling drag and drop events. The ViewModel delivers actions to be performed when the correct events trigger &#8211; this is mostly from having only one action passed from the ViewModel to handle a number of hook-in points of the UI (be it keybindings, mousebindings or eventbindings).</p>
<p>Oh, and another point about commands is that we use our own implementation of ICommands and have them directly called in XAML, as they must be available  in globally available context-menus, menus and toolbars.</p>
<p>Of course, there is another variable &#8211; this mode of work works for us because we have no dedicated designer. </p>
<p>But certainly we agree that the less code in the code-behind -> less maintenance.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-415">
					<div id="dsq-comment-header-415" class="dsq-comment-header">
						<cite id="dsq-cite-415">
								<span id="dsq-author-user-415">Steve M</span>
							</cite>
					</div>
					<div id="dsq-comment-body-415" class="dsq-comment-body">
						<div id="dsq-comment-message-415" class="dsq-comment-message"><p>Late comment here &#8211; but I agree 100% with Glenn on all points.</p>
<p>One question I wanted to put on the table is regarding the whole ICommand thing on a view model.</p>
<p>What if in response to a button click, we need to open another window?  If the button is bound to a command in my view model &#8211; a stand alone, testable assembly, I have a problem. </p>
<p>The view model assembly is seperate, cannot open a window, and in fact should not know about windows, correct?  Trying to open a window from the view model just does not feel right anyway.</p>
<p>In the end I like classic WPF commands, along side classic event handlers directly in the code behind.  All these handlers should be a *very thin* path to the VM.  Eliminate as much code from the codebehind &#8211; absolutely &#8211; but not all of it.</p>
<p>Incedentally, sometimes you just have to use event handlers.  We use Infragistics, and when a user double clicks a row in a grid, there is no &#8216;command&#8217; available for this.</p>
<p>In the case regarding the ICommand ( which I do not like ) I think instead a classic WPF command should be used.  The handler should ask the VM as to whether an entity should be edited.  The classic WPF command handler in turn should open the next window.  Can&#8217;t do this easily in the case mentioned above.</p>
<p>The view models make business decisions ( can edit ) and the view handles display specifics ( new window, show hidden element, whatever ).  Whether something is accessible in the business model could translate to whether it is visible or disabled in the view.</p>
<p>So after all of that, why do we need ICommand?<br />
Perhaps my perspective is wrong.  Maybe the ICommand could raise an event, and the view could respond by opening a new window?</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/glennblock/2009/08/03/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise/ ';
	var disqus_identifier = '98 /blogs/glenn.block/archive/2009/08/02/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'mytechnobabble';
	var disqus_title = "The spirit of MVVM (ViewModel), it’s not a code counting exercise.";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=98');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/glennblock/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/glennblock\/2009\/08\/03\/the-spirit-of-mvvm-viewmodel-it-s-not-a-code-counting-exercise\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 1.261 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-18 16:10:38 -->
<!-- super cache -->