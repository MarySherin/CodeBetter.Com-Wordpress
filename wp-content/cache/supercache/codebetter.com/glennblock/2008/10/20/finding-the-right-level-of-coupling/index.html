<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Finding the right level of coupling | Glenn Block</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/glennblock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/glennblock/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/glennblock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/glennblock/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Glenn Block' href='http://codebetter.com/glennblock/' />
<link rel='start' title='IoC.AddComponent&lt;IBloggingStrategy, CodeBetterBloggingStrategy&gt;();' href='http://codebetter.com/glennblock/2008/01/03/ioc-addcomponent-lt-ibloggingstrategy-codebetterbloggingstrategy-gt/' />
<link rel='prev' title='Bringing Prism to WinForms' href='http://codebetter.com/glennblock/2008/10/20/bringing-prism-to-winforms/' />
<link rel='next' title='Elegant Code Cast on ALT.NET and Microsoft' href='http://codebetter.com/glennblock/2008/10/20/elegant-code-cast-on-alt-net-and-microsoft/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/glennblock/2008/10/20/finding-the-right-level-of-coupling/' />
<link rel='shortlink' href='http://codebetter.com/glennblock/?p=67' />
<link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/mytechnobabble/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-67" class="post-67 post type-post status-publish format-standard hentry category-composite-application-guidance category-composite-application-library category-composite-wpf category-misc category-patterns category-prism">
					<h1 class="entry-title">Finding the right level of coupling</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/glennblock/author/glennblock/" title="View all posts by Glenn Block">Glenn Block</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/glennblock/2008/10/20/finding-the-right-level-of-coupling/" title="6:51 am" rel="bookmark"><span class="entry-date">October 20, 2008</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/glennblock/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/glennblock/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/glennblock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><P><IMG height="420" alt="Up On the Tight Rope by Smiles Are Free." src="http://farm3.static.flickr.com/2334/1785770650_14acbe8f9a.jpg?v=0" width="545"></P><br />
<P><A title="http://www.flickr.com/photos/tammys_world/1785770650/" href="http://www.flickr.com/photos/tammys_world/1785770650/">http://www.flickr.com/photos/tammys_world/1785770650/</A></P><br />
<P>This is a follow up from my previous <A href="http://codebetter.com/blogs/glenn.block/archive/2008/10/19/bringing-prism-to-winforms.aspx">post</A> on Composite extensions for Win Forms.</P><br />
<P>Early on as we started the development of Prism, we had a few decisions to make around our coupling to WPF. We knew that Prism undoubtedly was being targeted for WPF. On the other hand we knew that some aspects of the work were not WPF specific, and might be applicable for other platforms. </P><br />
<P>After many discussions we arrived at the following guiding principles.</P><br />
<UL><br />
<LI>Don&#8217;t unnecessarily couple anything to WPF. </LI><br />
<LI>Leverage WPF to the fullest extend possible. </LI><br />
<LI>Don&#8217;t unnecessarily couple to other parts of Prism itself. </LI><br />
<LI>Don&#8217;t unnecessarily couple to a specific IoC container. </LI></UL><br />
<P>The principles may seem contradictory, but they are not. What they meant for us was that if a particular problem we encountered was best solved by WPF, then by all&nbsp; means we used it. That instead of coming up with a generic abstraction that is non-WPF specific. On the other hand if there were other problems whose solution was not by it&#8217;s nature WPF specific then we did not make it have any dependencies on WPF. These were guiding principles with some exceptions, the Bootstrapper being one of them . We could have decoupled it from WPF but decided not too. However nothing in the CAL depended on the Bootstrapper and it was fairly easy to implement so we felt we could get&nbsp; away with it and reduce the number of types we introduced.</P><br />
<P>Below are some of&nbsp; the problems we encountered and how we handled them.</P><br />
<P><STRONG>Problem: Assembly level coupling to a particular platform technology</STRONG></P><br />
<P>At a high level before delving into specific challenges there was an issue of assembly coupling. What this meant is that if a non-UI specific piece of functionality was mixed in an assembly that was UI specific, then that meant that anyone who used that assembly, had to reference the UI assemblies that were reference. For example if the module loader sits in the same assembly where there are direct references to WPF, then if I reference that assembly from a WinForms app, I pull along those WPF references. Further more having the two in the same assembly, made it much more likely that the pieces within would end up coupled to something that was platform specific.</P><br />
<P><STRONG>Solution: Assembly separation and layering.</STRONG></P><br />
<P>The solution here simply to break out the Composite Application Library into two assemblies (and corresponding namespaces) namely &#8220;Microsoft.Practices.Composite.dll&#8221; and &#8220;Microsoft.Practices.Composite.Wpf.dll&#8221;. We then carefully placed each service / component in Prism into it&#8217;s respective place. In some cases there was layering between the two. Many of the core services in Prism live in Microsoft.Practices.Composite such as the Module Loader and the container facade. Other services use a layered approach, such as the Event Aggregator which has a core set of infrastructure in Composite, along with WPF specific functionality that layers on top of it in Composite.Wpf. The Region Manager functionality all lives in Composite.Wpf, however all of its interfaces are defined in Composite. </P><br />
<P><STRONG>Problem: Implementing Module Loading</STRONG></P><br />
<P>In the case of the Module loader, there was nothing about it that seemed WPF specific. Modules / Module loading was something that we had implemented over and over again in p&amp;p at least three different times. Did we need a fourth? We felt not. When we looked at the module loading mechanisms we had done, we realized that there were two points of coupling. First, there were the parameters the loader required the module to accept. In the case of CAB, the module required a WorkItem, while in the case of WCSF it required a CompositionContainer. In either case the parameters provided to the loader were a gateway to set of other services. Furthermore the module was a base class which also tied in some more specific bits. What to do?</P><br />
<P><STRONG>Solution: Favoring Composition over Inheritance.</STRONG></P><br />
<P>The solution? Applying a simple principle. <A href="http://brighton.ncsa.uiuc.edu/prajlich/T/node14.html">Composition vs Inheritance.</A> We removed passing in a service locator to the module. Then we changed the module from being a base class to an interface. Thus with these changes the module become agnostic to platform and framework. This solved one part of the problem, but how would the module get access it&#8217;s services if there was no longer presence of something similar to a WorkItem? To address this. we brought an IoC container into the mix to handle providing dependencies to the module via it&#8217;s constructor.&nbsp; We then implemented the module loader service to utilize the container to resolve modules. As the module is resolved, it&#8217;s dependencies are injected. Rather than binding the loader to a specific IoC container implementation, we had the loader utilize a pluggable IContainerFacade (the precursor to IServiceLocator) implementation to talk to the container. </P><br />
<P>Below is a snippet of the module loader which shows this functionality.</P><br />
<DIV><br />
<DIV><PRE><SPAN>/// &lt;summary&gt;</SPAN></PRE><PRE><SPAN>/// Initialize the specified list of modules.</SPAN></PRE><PRE><SPAN>/// &lt;/summary&gt;</SPAN></PRE><PRE><SPAN>/// &lt;param name=&#8221;moduleInfos&#8221;&gt;The list of modules to initialize.&lt;/param&gt;</SPAN></PRE><PRE>[System.Diagnostics.CodeAnalysis.SuppressMessage(<SPAN>"Microsoft.Design"</SPAN>, <SPAN>"CA1031:DoNotCatchGeneralExceptionTypes"</SPAN>)]</PRE><PRE><SPAN>public</SPAN> <SPAN>void</SPAN> Initialize(ModuleInfo[] moduleInfos)</PRE><PRE>{</PRE><PRE>    List&lt;ModuleInfo&gt; modules = GetModulesLoadOrder(moduleInfos);</PRE><PRE>&nbsp;</PRE><PRE>    IEnumerable&lt;ModuleInfo&gt; newModules = LoadAssembliesAndTypes(modules);</PRE><PRE>&nbsp;</PRE><PRE>    <SPAN>foreach</SPAN> (ModuleInfo moduleInfo <SPAN>in</SPAN> newModules)</PRE><PRE>    {</PRE><PRE>        Type type = initializedModules[moduleInfo.ModuleType];</PRE><PRE>&nbsp;</PRE><PRE>        <SPAN>try</SPAN></PRE><PRE>        {</PRE><PRE>            IModule module = CreateModule(type);</PRE><PRE>            module.Initialize();</PRE><PRE>        }</PRE><PRE>        <SPAN>catch</SPAN> (Exception e)</PRE><PRE>        {</PRE><PRE>            HandleModuleLoadError(moduleInfo, type.Assembly.FullName, e);</PRE><PRE>        }</PRE><PRE>    }</PRE><PRE>}</PRE><PRE>&nbsp;</PRE><PRE><SPAN>/// &lt;summary&gt;</SPAN></PRE><PRE><SPAN>/// Uses the container to resolve a new &lt;see cref=&#8221;IModule&#8221;/&gt; by specifying its &lt;see cref=&#8221;Type&#8221;/&gt;.</SPAN></PRE><PRE><SPAN>/// &lt;/summary&gt;</SPAN></PRE><PRE><SPAN>/// &lt;param name=&#8221;type&#8221;&gt;The type to resolve. This type must implement &lt;see cref=&#8221;IModule&#8221;/&gt;.&lt;/param&gt;</SPAN></PRE><PRE><SPAN>/// &lt;returns&gt;A new instance of &lt;paramref name=&#8221;type&#8221;/&gt;.&lt;/returns&gt;</SPAN></PRE><PRE><SPAN>protected</SPAN> <SPAN>virtual</SPAN> IModule CreateModule(Type type)</PRE><PRE>{</PRE><PRE>    <SPAN>return</SPAN> (IModule)containerFacade.Resolve(type);</PRE><PRE>}</PRE></DIV></DIV><br />
<P><STRONG>Problem: Implementing Event Aggregation</STRONG></P><br />
<P>Event Aggregation was an interesting case. Parts of the aggregator had nothing particularly platform specific. The invocation of the event handler was on the other hand very specific. Events fired by the aggregator have different threading needs with regards to how the subscriber is invoked. In the case of WPF using the Dispatcher was the easiest way to go. However, if you are in Win Forms or on the web, different rules apply.</P><br />
<P><STRONG>Solution: Applying separation of concerns, layering, introducing an abstract event class</STRONG></P><br />
<P>Our EventAggregator implementation can essentially be broken into several parts. There is the subscription / retrieval of the events which the EventAggregator service provides, and then the mechanism for dispatch.&nbsp; The key to providing reuse in this case was keeping the two decoupled. The EventAggregator service itself only knows about registering and retrieving events, it does not know anything about the invocation. For the invocation side we introduced an abstract EventBase class. We discussed using an interface, but there were some specific expectations we had around how events were implemented for example ensuring that subscriptions are properly cleaned up. The EventBase relies on an IEventSubscription class for individual subscriptions. This allows flexibility not just around invocation but around the registration itself which we use in our implementation. I am sure one could argue that we could have done even further refactoring, however we got to the point that allowed us to achieve our goals.</P><br />
<P><STRONG>Note:</STRONG> In this case having a base did not seem to block any further extensibility requirements of customers, as it was so low level.&nbsp; In other cases it does, such as in the module implementation mentioned before. The moral of this story is there is no silver bullet, and it depends, it depends, it depends.</P><br />
<P>Once we had the base in place, we made the EventAggregator service depend on that base rather than a specific implementation. To address the WPF specific needs we used layering and included a CompositeWPFEvent which uses the Dispatcher. We also introduced a host of other capabilities as well in the CompositeWPFEvent like weak delegate dispatching and such, invoking the publisher thread, etc. Introducing it at this level meant not coupling other platform implementations to use this functionality.&nbsp; </P><br />
<P>Below is the code for the Subscribe method which as you can see delegates to the InternalSubscribe method (from EventBase) which takes an IEventSubscription. </P><br />
<DIV><br />
<DIV><PRE><SPAN>public</SPAN> <SPAN>virtual</SPAN> SubscriptionToken Subscribe(Action&lt;TPayload&gt; action, ThreadOption threadOption, <SPAN>bool</SPAN> keepSubscriberReferenceAlive, Predicate&lt;TPayload&gt; filter)</PRE><PRE>{</PRE><PRE>    IDelegateReference actionReference = <SPAN>new</SPAN> DelegateReference(action, keepSubscriberReferenceAlive);</PRE><PRE>    IDelegateReference filterReference = <SPAN>new</SPAN> DelegateReference(filter, keepSubscriberReferenceAlive);</PRE><PRE>    EventSubscription&lt;TPayload&gt; subscription;</PRE><PRE>    <SPAN>switch</SPAN> (threadOption)</PRE><PRE>    {</PRE><PRE>        <SPAN>case</SPAN> ThreadOption.PublisherThread:</PRE><PRE>            subscription = <SPAN>new</SPAN> EventSubscription&lt;TPayload&gt;(actionReference, filterReference);</PRE><PRE>            <SPAN>break</SPAN>;</PRE><PRE>        <SPAN>case</SPAN> ThreadOption.BackgroundThread:</PRE><PRE>            subscription = <SPAN>new</SPAN> BackgroundEventSubscription&lt;TPayload&gt;(actionReference, filterReference);</PRE><PRE>            <SPAN>break</SPAN>;</PRE><PRE>        <SPAN>case</SPAN> ThreadOption.UIThread:</PRE><PRE>            subscription = <SPAN>new</SPAN> DispatcherEventSubscription&lt;TPayload&gt;(actionReference, filterReference, UIDispatcher);</PRE><PRE>            <SPAN>break</SPAN>;</PRE><PRE>        <SPAN>default</SPAN>:</PRE><PRE>            subscription = <SPAN>new</SPAN> EventSubscription&lt;TPayload&gt;(actionReference, filterReference);</PRE><PRE>            <SPAN>break</SPAN>;</PRE><PRE>    }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;</PRE><PRE>    <SPAN>return</SPAN> <SPAN>base</SPAN>.InternalSubscribe(subscription);</PRE><PRE>}</PRE></DIV></DIV><br />
<P><STRONG>Problem: Region Manager</STRONG></P><br />
<P>Regions are the mechanism that Prism uses for defining layouts to plug views into. As we looked at WPF, we saw some very specific benefits WPF provided in implementing regions. For example using attached properties was a great way to associate a particular portion of the UI as a region, and allow a declarative mechanism for registering it. Additionally ItemsControls along with WPFs DataTemplate capability were a perfect way of controlling how views were laid out. On the other hand the notion of a region itself and a registry off regions seemed plausable for other UI platform technologies though the implementation would greatly differ. Also it seemed reasonable that extenders of CAL might want to replace parts or the whole of our region manager implementation.</P><br />
<P><STRONG>Solution: Favoring Composition over Inheritance, Layering.</STRONG></P><br />
<P>The solution here was to create a set of interfaces for the Region Manager and Region Adapter. These interfaces were placed in the Microsoft.Practices.Composite which is UI Agnostic. We then created a host of WPF specific classes which layered on top of this infrastructure which lives in the Microsoft.Practices.Composite.Wpf. Applications that utilize the CAL, depend on the Region Manager interfaces rather than any specific implementations. </P><br />
<P>Below is a snapshot of the code for some of the region related interfaces.</P><br />
<DIV><br />
<DIV><PRE><SPAN>public</SPAN> <SPAN>interface</SPAN> IRegionManager</PRE><PRE>{</PRE><PRE>    IDictionary&lt;<SPAN>string</SPAN>, IRegion&gt; Regions { get; }</PRE><PRE>    <SPAN>void</SPAN> AttachNewRegion(<SPAN>object</SPAN> regionTarget, <SPAN>string</SPAN> regionName);</PRE><PRE>    IRegionManager CreateRegionManager();</PRE><PRE>}</PRE><PRE>&nbsp;</PRE><PRE><SPAN>public</SPAN> <SPAN>interface</SPAN> IRegion</PRE><PRE>{</PRE><PRE>    IViewsCollection Views { get; }</PRE><PRE>    IViewsCollection ActiveViews { get; }</PRE><PRE>    IRegionManager Add(<SPAN>object</SPAN> view);</PRE><PRE>    IRegionManager Add(<SPAN>object</SPAN> view, <SPAN>string</SPAN> viewName);</PRE><PRE>    IRegionManager Add(<SPAN>object</SPAN> view, <SPAN>string</SPAN> viewName, <SPAN>bool</SPAN> createRegionManagerScope);</PRE><PRE>    <SPAN>void</SPAN> Remove(<SPAN>object</SPAN> view);</PRE><PRE>    <SPAN>void</SPAN> Activate(<SPAN>object</SPAN> view);</PRE><PRE>    <SPAN>void</SPAN> Deactivate(<SPAN>object</SPAN> view);</PRE><PRE>    <SPAN>object</SPAN> GetView(<SPAN>string</SPAN> viewName);</PRE><PRE>    IRegionManager RegionManager { get; set; }</PRE><PRE>}</PRE><PRE>&nbsp;</PRE><PRE><SPAN>public</SPAN> <SPAN>interface</SPAN> IViewsCollection : IEnumerable&lt;<SPAN>object</SPAN>&gt;, INotifyCollectionChanged</PRE><PRE>{</PRE><PRE>    <SPAN>bool</SPAN> Contains(<SPAN>object</SPAN> <SPAN>value</SPAN>);</PRE><PRE>}</PRE></DIV></DIV><br />
<P><STRONG>So what did we learn?</STRONG></P><br />
<P>Above and beyond Prism itself, we learned some important lessons about finding that right level of coupling.&nbsp; It&#8217;s a bit like walking a tight-rope, with each case having to carefully evaluated:</P><br />
<UL><br />
<LI>If you couple too tightly, you can greatly limit extensibility, testability and general usage scenarios, for example not being able to use in a brown-field (existing) application, which is often a critique leveled at CAB. </LI><br />
<LI>If you are too decoupled you end up introducing a lot of abstractions which greatly increases complexity and decreases maintainability of the system.&nbsp; You also often end up in a least-common-denominator situation where by decoupling from a specific technology, prevents you from taking full advantage of <STRONG>any</STRONG> specific one. This specific point comes up all the time whenever there are discussions around (the myth of) portable UI. </LI></UL><br />
<P>In other words, there&#8217;s no silver bullet. In some cases it makes sense to be more tightly coupled, in others it makes sense to be more decoupled. Finding the right balance between the two is <STRONG>key</STRONG>. It&#8217;s not easy, but <STRONG>absolutely necessary </STRONG>for a maintainable system.</P></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/glennblock/category/composite-application-guidance/" title="View all posts in Composite Application Guidance" rel="category tag">Composite Application Guidance</a>, <a href="http://codebetter.com/glennblock/category/composite-application-library/" title="View all posts in Composite Application Library" rel="category tag">Composite Application Library</a>, <a href="http://codebetter.com/glennblock/category/composite-wpf/" title="View all posts in Composite WPF" rel="category tag">Composite WPF</a>, <a href="http://codebetter.com/glennblock/category/misc/" title="View all posts in misc" rel="category tag">misc</a>, <a href="http://codebetter.com/glennblock/category/patterns/" title="View all posts in patterns" rel="category tag">patterns</a>, <a href="http://codebetter.com/glennblock/category/prism/" title="View all posts in prism" rel="category tag">prism</a>. Bookmark the <a href="http://codebetter.com/glennblock/2008/10/20/finding-the-right-level-of-coupling/" title="Permalink to Finding the right level of coupling" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/glennblock/2008/10/20/finding-the-right-level-of-coupling/feed/" title="Comments RSS to Finding the right level of coupling" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-67 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/glennblock/2008/10/20/bringing-prism-to-winforms/" rel="prev"><span class="meta-nav">&larr;</span> Bringing Prism to WinForms</a></div>
					<div class="nav-next"><a href="http://codebetter.com/glennblock/2008/10/20/elegant-code-cast-on-alt-net-and-microsoft/" rel="next">Elegant Code Cast on ALT.NET and Microsoft <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-247">
					<div id="dsq-comment-header-247" class="dsq-comment-header">
						<cite id="dsq-cite-247">
	http://www.infusion.com							<span id="dsq-author-user-247">Kyle Szklenski</span>
							</cite>
					</div>
					<div id="dsq-comment-body-247" class="dsq-comment-body">
						<div id="dsq-comment-message-247" class="dsq-comment-message"><p>This is becoming one of my favorite blog posts ever after a couple rereads. I really like the fact that you focus on not so much minimizing coupling, but coupling in the correct way.</p>
<p>It inspired me to think about design patterns in a new way. Namely, design patterns are not meant to reduce coupling. They are meant to introduce coupling in such a way that it doesn&#8217;t interfere with the rest of the program, and so that flexibility is increased and fragility is decreased.</p>
<p>This post even made me think about my favorite design pattern differently! It&#8217;s the adapter pattern, one that few people actively use on a daily basis, but that comes so in-handy when it&#8217;s used that it&#8217;s incredible. The way I think about it now is not that it reduces coupling between the wrapped classes, but that it introduces coupling between them in such a way that is extensible for the future (if you need to add something else, just make a new adapter). I have not gotten to look at it directly, but if I had to guess, I&#8217;d say your IoC container container would use it in exactly that way, too, so that&#8217;s interesting.</p>
<p>By the way, I consider the adapter pattern to be a pattern for all the ages of the software life-cycle. In the development phase, it can very easily act as a stub or mock, deferring full development of the interfaces until later and providing trivial implementations. In production, it does its standard thing, combining together disparate interfaces to make them more useful together so that you don&#8217;t need specific code in every class that uses one of those interfaces to handle the other interfaces. And finally, in legacy systems, it can be added and used to make them more robust and able to be incorporated into current or future developments much more easily. /pseudorant off.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-248">
					<div id="dsq-comment-header-248" class="dsq-comment-header">
						<cite id="dsq-cite-248">
	http://www.codebetter.com/blogs/glenn.block/							<span id="dsq-author-user-248">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-248" class="dsq-comment-body">
						<div id="dsq-comment-message-248" class="dsq-comment-message"><p>Kyle</p>
<p>Thanks. That&#8217;s an interesting perception on design patterns. I think in general all design patterns reduce coupling on some level though in varying degress. For example Factories / Service locator vs IOC. Command Pattern vs Adapter vs Strategy. Composite vs Iterator. Which pattern is right for any situation depends completely on the requirements. That&#8217;s they key. </p>
<p>I agree completely on the adapter pattern that it can reduce greatly reduce coupling,  thereby improving testability. Sometimes it can be an anti-pattern though <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  </p>
<p>It just depends. <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/glennblock/2008/10/20/finding-the-right-level-of-coupling/ ';
	var disqus_identifier = '67 /blogs/glenn.block/archive/2008/10/19/finding-the-right-level-of-coupling.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'mytechnobabble';
	var disqus_title = "Finding the right level of coupling";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=67');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/glennblock/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/glennblock\/2008\/10\/20\/finding-the-right-level-of-coupling\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.714 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-27 12:33:11 -->
<!-- super cache -->