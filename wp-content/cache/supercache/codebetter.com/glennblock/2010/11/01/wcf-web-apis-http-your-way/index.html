<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>WCF Web APIs, HTTP your way | Glenn Block</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/glennblock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/glennblock/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/glennblock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/glennblock/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Glenn Block' href='http://codebetter.com/glennblock/' />
<link rel='start' title='IoC.AddComponent&lt;IBloggingStrategy, CodeBetterBloggingStrategy&gt;();' href='http://codebetter.com/glennblock/2008/01/03/ioc-addcomponent-lt-ibloggingstrategy-codebetterbloggingstrategy-gt/' />
<link rel='prev' title='Taking HTTP support in WCF to the next level' href='http://codebetter.com/glennblock/2010/10/26/taking-http-support-in-wcf-to-the-next-level/' />
<link rel='next' title='Exploring resources, a resource programming model, and code-based configuration.' href='http://codebetter.com/glennblock/2010/11/15/exploring-resources-a-resource-programming-model-and-code-based-configuration/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/glennblock/2010/11/01/wcf-web-apis-http-your-way/' />
<link rel='shortlink' href='http://codebetter.com/glennblock/?p=137' />
<link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/mytechnobabble/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-137" class="post-137 post type-post status-publish format-standard hentry category-http category-rest category-wcf-web-apis">
					<h1 class="entry-title">WCF Web APIs, HTTP your way</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/glennblock/author/glennblock/" title="View all posts by Glenn Block">Glenn Block</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/glennblock/2010/11/01/wcf-web-apis-http-your-way/" title="10:44 am" rel="bookmark"><span class="entry-date">November 1, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/glennblock/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/glennblock/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/glennblock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>At PDC in my session&#160; <a href="http://player.microsoftpdc.com/Session/17a9e09f-4af1-4ef3-8a5a-ebf1e9bd9c8e">“Building Web APIs for the Highly Connected Web”</a> we announced WCF Web APIs, new work we are doing to make HTTP first class in WCF. In this post I am going to describe what we are doing and why. If you are saying, “just show me the bits”, then just head on over to <a href="http://wcf.codeplex.com">wcf.codeplex.com</a> our new site that we just launched! </p>
<h1>Why HTTP?</h1>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_thumb17_5F00_1415D371.png"><img style="border-right-width: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" border="0" alt="image_thumb[17]" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb17_thumb_081673EE.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=B%2bUpxCWsmqDB1ZfER8FJjEnHvFA%3d" width="365" height="224" /></a></p>
<p>HTTP is ubiquitous and it’s lightweight.&#160; Every consumer that connects to the web understands it, every browser supports it, and the infrastructure of the world wide web is built around it.&#160; That means when you travel HTTP, you get carte blanche status throughout the world wide web. It’s like a credit card that is always accepted everywhere. In the past, HTTP’s primary usage was for serving up HTML pages. Over time however our web applications have evolved. These newer breed are much more dynamic, aggregating data not only from the company server but from a multitude of services that are hosted in the cloud. Many of those services themselves are now being exposed directly over HTTP in order to have maximum reach. </p>
<p>Whereas in the past the primary consumer was a desktop / laptop PC, we’ve now moved into the age of devices including phones like IPhone, Android and Windows Phone as well as other portable tablets like the iPad and the upcoming Slate. Each of these devices (including the PC) have different capabilities, however one thing is consistent, they all talk HTTP.</p>
<h1>WCF and HTTP, we’re going much further.</h1>
<p>As the industry evolves, our platform needs to evolve. Since .NET 3.5, we have been continually evolving WCF to provide better support for surfacing services and data over HTTP.&#160; We’ve made good progress but there is more we can do. Developers using WCF have said they want more control over HTTP. We’ve also heard developers asking for better support for consuming WCF services with web toolkits like jQuery. Additionally, we’ve heard requests about simplifying configuration, removing ceremony, more testability, and just an overall simplified model. <strong>We hear you and we’re taking action. </strong>We’re making significant enhancements to our platform to address the concerns.&#160; Below is a list of some of the improvements we are focusing on specific to HTTP which we just made available on Codeplex (available in WCF HTTP Preview 1.zip). For the jQuery work check out these excellent posts by <a href="http://tomasz.janczuk.org/2010/10/wcf-support-for-jquery-on.html">Tomek</a> and <a href="http://hashtagfail.com/post/1432485895/jsonvalue-json-walkthrough">Yavor</a>.</p>
<h1>Our HTTP focus areas</h1>
<h2>Media Types and Formats</h2>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_thumb11_5F00_796E58B9.png"><img style="border-right-width: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" border="0" alt="image_thumb[11]" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb11_thumb_2AFC5700.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=yRxil6EMEVsrC00UNuXVQ101a4U%3d" width="369" height="209" /></a></p>
<p>HTTP is extremely flexible allowing the body to be presented in many different media types (content type) with html, pure xml and json, atom and OData being just a few. With WCF Web APIs we’re going to make it very easy for services to support multiple formats on a single service. Out of the box, we are planning to support xml, json and OData however we’re also making it very easy to add on support for additional media types including those that contain <a href="http://amundsen.com/hypermedia/">hypermedia</a> (see my talk for an exampe). This gives WCF the flexibility to service a variety clients based on their needs and capabilities.</p>
<p>Below is a snippet which demonstrates taking a contact returned from an operation and representing it as a png file stored in an images folder. PngProcessor derives from MediaTypeProcessor. Processors are a new extensibility point in WCF Web APIs. MediaTypeProcessor is a special processor that you derive from to support a new format.</p>
<pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> PngProcessor : MediaTypeProcessor
</pre>
<pre>{
</pre>
<pre>

    <span style="color: #0000ff">public</span> PngProcessor(HttpOperationDescription operation, 

        MediaTypeProcessorMode mode)

</pre>
<pre>        : <span style="color: #0000ff">base</span>(operation, mode)
</pre>
<pre>    {
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> IEnumerable&lt;<span style="color: #0000ff">string</span>&gt; SupportedMediaTypes
</pre>
<pre>    {
</pre>
<pre>        <span style="color: #0000ff">get</span>
</pre>
<pre>        {
</pre>
<pre>            yield <span style="color: #0000ff">return</span> &quot;<span style="color: #8b0000">image/png</span>&quot;;
</pre>
<pre>        }
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> WriteToStream(<span style="color: #0000ff">object</span> instance, 

        Stream stream, HttpRequestMessage request)

</pre>
<pre>    {
</pre>
<pre>        var contact = instance <span style="color: #0000ff">as</span> Contact;
</pre>
<pre>        <span style="color: #0000ff">if</span> (contact != <span style="color: #0000ff">null</span>)
</pre>
<pre>        {
</pre>
<pre>

            var path = <span style="color: #0000ff">string</span>.Format(CultureInfo.InvariantCulture, 

                @&quot;<span style="color: #8b0000">{0}bin\Images\Image{1}.png</span>&quot;, 

                AppDomain.CurrentDomain.BaseDirectory, 

                contact.ContactId);

</pre>
<pre>            <span style="color: #0000ff">using</span> (var fileStream = <span style="color: #0000ff">new</span> FileStream(path, FileMode.Open))
</pre>
<pre>            {
</pre>
<pre>                <span style="color: #0000ff">byte</span>[] bytes = <span style="color: #0000ff">new</span> <span style="color: #0000ff">byte</span>[fileStream.Length];
</pre>
<pre>                fileStream.Read(bytes, 0, (<span style="color: #0000ff">int</span>)fileStream.Length);
</pre>
<pre>                stream.Write(bytes, 0, (<span style="color: #0000ff">int</span>)fileStream.Length);
</pre>
<pre>            }
</pre>
<pre>        }
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">object</span> ReadFromStream(Stream stream, 

        HttpRequestMessage request)

</pre>
<pre>    {
</pre>
<pre>        <span style="color: #0000ff">throw</span> <span style="color: #0000ff">new</span> NotImplementedException();
</pre>
<pre>    }
</pre>
<pre>}</pre>
</pre>
<p>This <em>same</em> Png formatter can sit side by side with formatters for other media types like json, xml, and atom. WCF will automatically select the right processor based on matching the request accept headers passed from the client against the SupportedMediaTypes. </p>
<h2></h2>
<p>To see different media types in action, check the ContactManager sample that ships with WCF Web APIs.</p>
<h3><u>Registering formatters / processors</u></h3>
<p>In order to register processors, we’re exploring a new programmatic configuration model which allows you to configure all processors (including formatters) at a single place within your application. To configure processors, you derive from a HostConfiguration class and override a few methods. You then pass your custom configuration class to the WebHttpServiceHost or WebHttpServiceHostFactory.</p>
<p>In the ContactManager sample we’re shipping on Codeplex you wll see the following in the Global.asax.</p>
<pre>
<pre><span style="color: #0000ff">protected</span> <span style="color: #0000ff">void</span> Application_Start(<span style="color: #0000ff">object</span> sender, EventArgs e)
</pre>
<pre>{
</pre>
<pre>    var configuration = <span style="color: #0000ff">new</span> ContactManagerConfiguration();
</pre>
<pre>

    RouteTable.Routes.AddServiceRoute&lt;ContactResource&gt;(

        &quot;<span style="color: #8b0000">contact</span>&quot;, configuration);
</pre>
<pre>

    RouteTable.Routes.AddServiceRoute&lt;ContactsResource&gt;(

        &quot;<span style="color: #8b0000">contacts</span>&quot;, configuration);

</pre>
<pre>}</pre>
</pre>
<h1></h1>
<p>Both the ContactResource and ContactsResource are configured with a ContactManagerConfiguration instance. That class registers the processors for each operation.</p>
<pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> ContactManagerConfiguration : HostConfiguration
</pre>
<pre>{
</pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> RegisterRequestProcessorsForOperation(

        HttpOperationDescription operation,

</pre>
<pre>        IList&lt;Processor&gt; processors, MediaTypeProcessorMode mode)
</pre>
<pre>    {
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> JsonProcessor(operation, mode));
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> FormUrlEncodedProcessor(operation, mode));
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> RegisterResponseProcessorsForOperation(

        HttpOperationDescription operation,

</pre>
<pre>        IList&lt;Processor&gt; processors, MediaTypeProcessorMode mode)
</pre>
<pre>    {
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> JsonProcessor(operation, mode));
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> PngProcessor(operation, mode));
</pre>
<pre>    }
</pre>
<pre>}</pre>
</pre>
<p>Notice above the request is configured to support Json and FormUrlEncoding while the response supports Json and Png. These Register methods are called per operation thus configuration of processors can even be more fine grained. Plus you can reuse your configuration classes even across applications.</p>
<h3><u>JsonProcessor / FormUrlEncodedProcessor.</u></h3>
<p>In addition to supporting representing types in multiple formats, we also can support untyped operations with the new Json primitives that come out of our jQuery work which I mentioned above. The JsonValueSample we’ve included illustrates how this works.</p>
<pre>
<pre>[ServiceContract]
</pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> ContactsResource
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">private</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">int</span> nextId = 1;
</pre>
<pre></pre>
<pre>    [WebInvoke(UriTemplate = &quot;<span style="color: #8b0000"></span>&quot;, Method = &quot;<span style="color: #8b0000">POST</span>&quot;)]
</pre>
<pre>    <span style="color: #0000ff">public</span> JsonValue Post(JsonValue contact)
</pre>
<pre>    {
</pre>
<pre>        var postedContact = (dynamic)contact;
</pre>
<pre>        var contactResponse = (dynamic)<span style="color: #0000ff">new</span> JsonObject();
</pre>
<pre>        contactResponse.Name = postedContact.Name;
</pre>
<pre>        contactResponse.ContactId = nextId++;
</pre>
<pre>        <span style="color: #0000ff">return</span> contactResponse;
</pre>
<pre>    }
</pre>
<pre>}</pre>
</pre>
<p><u></u></p>
<p><u></u></p>
<p>In the snippet above you can see that the Post method accepts a JsonValue and returns a JsonValue. Within it casts the incoming parameter to dynamic (there actually is an extension method AsDynamic which you can use) pulls out the name and then creates a new JsonObject which it sets some properties on and returns. </p>
<p>If you look in the JsonValueSampleConfiguration you will see that it accepts Form Url Encoding (something not previously possible in WCF without a lot of work) for the request and returns Json. </p>
<pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> JsonValueSampleConfiguration : HostConfiguration
</pre>
<pre>{
</pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> RegisterRequestProcessorsForOperation(

        HttpOperationDescription operation, 

        IList&lt;Processor&gt; processors, 

        MediaTypeProcessorMode mode)

</pre>
<pre>    {
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> FormUrlEncodedProcessor(operation, mode));
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> RegisterResponseProcessorsForOperation(

        HttpOperationDescription operation, 

        IList&lt;Processor&gt; processors, 

        MediaTypeProcessorMode mode)

</pre>
<pre>    {
</pre>
<pre>        processors.ClearMediaTypeProcessors();
</pre>
<pre>        processors.Add(<span style="color: #0000ff">new</span> JsonProcessor(operation, mode));
</pre>
<pre>    }
</pre>
<pre>}</pre>
</pre>
<p>This is extremely powerful for folks solely working with Uri Form Encoding and Json and who are comfortable/prefer working without a concrete type.</p>
<h2>Queryability</h2>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_thumb13_5F00_0A77A7FF.png"><img style="border-right-width: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" border="0" alt="image_thumb[13]" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb13_thumb_1E935539.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=WkUj9j9yXVZOmYcqZ3spcIZd0aE%3d" width="316" height="180" /></a></p>
<p>One challenge when exposing data over HTTP is how to allow clients to filter that data.&#160; In WCF Web APIs we’re introducing IQueryable support on the client and server for addressing these challenges. </p>
<h3><u>Making the service queryable</u></h3>
<p>On the server side, your service operation returns an IQueryable&lt;T&gt; and you annotate it with a [QueryComposition] attribute. Once you do that, your service lights up and is now queryable using the OData uri format. </p>
<p>We’ve included a QueryableSample which illustrates how this works. Below is a snippet from the CoontactsResource in that sample.</p>
<pre>
<pre>[WebGet(UriTemplate = &quot;<span style="color: #8b0000"></span>&quot;)]
</pre>
<pre>[QueryComposition]
</pre>
<pre><span style="color: #0000ff">public</span> IEnumerable&lt;Contact&gt; Get()
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">return</span> contacts.AsQueryable();
</pre>
<pre>}</pre>
</pre>
<p>The Get method above returns an IQueryable of contacts. (Today the method must return IEnumerable&lt;Contact&gt; but this will be fixed in the near future).</p>
<p>With the query composition enabled, the host will now accept requests like “<a title="http://localhost:8081/contacts?$filter=Id%20eq%201" href="http://localhost:8081/contacts?$filter=Id%20eq%201">http://localhost:8081/contacts?$filter=Id%20eq%201</a>” which says “find me the contact with an ID equal to 1”.</p>
<p>Note: Currently this feature is not compatible with our new WebHttpServiceHost / Processors, it only works with our existing WebServiceHost. This is temporary as we are planning to migrate over to the new host / processor model.</p>
<h3><u>Querying the service, LINQ to WCF</u></h3>
<p>On the client side we’re introducing the ability to do LINQ queries directly to resources which are exposed through query composition. We’ve added a CreateQuery&lt;T&gt; extension method which you can use with the new HttpClient (next section) to create a WebQuery&lt;T&gt;. Once you have that query, you can then apply a Where, or an Order by. Once you start to iterate through the result, we will automatically do a Get request to the server using the correct URI based on the filter. The results will come back properly ordered and filtered based on your query.</p>
<p>Below is a snippet that shows querying an Orders resource </p>
<pre>
<pre><span style="color: #0000ff">public</span> IEnumerable&lt;Order&gt; GetApprovedOrders()
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">string</span> address = &quot;<span style="color: #8b0000">http://contoso.com/orders</span>&quot;;</pre>
<pre>    HttpClient client = <span style="color: #0000ff">new</span> HttpClient(address);
</pre>
<pre>    WebQuery&lt;Order&gt; orders = client.CreateQuery&lt;Contact&gt;();
</pre>
<pre>

    <span style="color: #0000ff">return</span> orders.Where&lt;Order&gt;(o=&gt;o.State == OrderState.Approved).

        OrderBy(o=o.OrderID);

</pre>
<pre>}</pre>
</pre>
<h2>Getting first class support for HTTP</h2>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_thumb16_5F00_0218F40A.png"><img style="border-right-width: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" border="0" alt="image_thumb[16]" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb16_thumb_3D02B784.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=4OwXLo8ADTN2ewtvj%2bVxsAMG1p4%3d" width="331" height="250" /></a></p>
<p>HTTP is more than a transport, it is a rich application layer protocol. There’s a lot more interesting information than just the body which lives in the headers. It is the headers that most of the web infrastructure actually cares about. For example if you want to allow requests to be cached throughout the web, you need to use entity tags which live where? In the headers. Point blank,&#160; if you want to access the full richness of HTTP you need to access those headers. </p>
<h3><u>HTTP Messages</u></h3>
<p>We’re introducing support for HttpRequestMessage and HttpResponseMessage. These classes which originally shipped in the REST starter kit allow unfettered and strongly typed access to the underlying HTTP request and response.&#160; With these new apis you can access HTTP&#160; wherever you are, whether you are authoring a service, or extending the stack and whether you are on the server <strong>or the client. </strong>Another nice thing about these messages is they are easy to use in unit testing. They don’t have any implicit dependencies to WCF as WebOperationContext does nor are they statically called. They are lightweight data containers that are very easy to create.</p>
<p>For example, you can author a service which receives the HttpRequestMessage and HttpResponseMessage, and which directly accesses the headers and the body. The HelloWorldResource below supports caching on the client side, as it returns an entity tag “HW” which the client can send in an IfNoneMatch header in subsequent requests. The resource can then then return a status 304 to tell the client to use it’s cached copy. The client in this case might not be the browser but a proxy server sitting in the middle.</p>
<pre>
<pre>[ServiceContract]
</pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> HelloWorldResource {
</pre>
<pre>  [WebGet(UriTemplate=&quot;<span style="color: #8b0000"></span>&quot;)]
</pre>
<pre>  <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> Get(HttpRequestMessage req, HttpResponseMessage resp) {
</pre>
<pre>    <span style="color: #0000ff">if</span> (req.IfNoneMatch.Contains(&quot;<span style="color: #8b0000">HW</span>&quot;)) {
</pre>
<pre>      resp.StatusCode = HttpStatusCode.NotModified;
</pre>
<pre>      <span style="color: #0000ff">return</span>;
</pre>
<pre>    }
</pre>
<pre>
</pre>
<pre>    resp.HttpContent.Create(&quot;<span style="color: #8b0000">Hello World Resource</span>&quot;, &quot;<span style="color: #8b0000">text/html</span>&quot;);
</pre>
<pre>    resp.StatusCode = HttpStatusCode.OK;
</pre>
<pre>    resp.Headers.Tag = &quot;<span style="color: #8b0000">HW</span>&quot;; <span style="color: #008000">//set the tag</span>
</pre>
<pre>  }
</pre>
<pre>}</pre>
</pre>
<p>The code above would likely be factored into a common set of utility functions rather than being redundantly coded for each operation. The important thing is we’re providing the messages which enables that refactoring.</p>
<p>You can also mix and match using messages with strongly typed objects representing the body. For example you might want to do a redirect on a Get request for a document that has moved.</p>
<pre>
<pre>[ServiceContract]
</pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> DocumentResource
</pre>
<pre>{
</pre>
<pre>    [WebGet(UriTemplate=&quot;<span style="color: #8b0000">{name}</span>&quot;)]
</pre>
<pre>    <span style="color: #0000ff">public</span> Document Get(<span style="color: #0000ff">string</span> name, HttpResponseMessage resp)
</pre>
<pre>    {
</pre>
<pre>        Document doc;
</pre>
<pre></pre>
<pre>        <span style="color: #008000">//foo has moved</span>
</pre>
<pre>        <span style="color: #0000ff">if</span> (name == &quot;<span style="color: #8b0000">Foo</span>&quot;)
</pre>
<pre>        {
</pre>
<pre>            resp.StatusCode = HttpStatusCode.MovedPermanently;
</pre>
<pre>            resp.Headers.Location = <span style="color: #0000ff">new</span> Uri(&quot;<span style="color: #8b0000">http://someplace/Foo</span>&quot;);
</pre>
<pre>            <span style="color: #0000ff">return</span> <span style="color: #0000ff">null</span>;
</pre>
<pre>        }
</pre>
<pre>        <span style="color: #008000">//find the document</span>
</pre>
<pre>        <span style="color: #0000ff">return</span> doc;
</pre>
<pre>    }
</pre>
<pre>} </pre>
<p><u></u></pre>
<p><u></u><u></u></p>
<p>Within the ContactManager sample you will see other examples of mixing messages with concrete types.&#160; </p>
<h3><u>HTTP Client</u></h3>
<p>Providing a client for consuming HTTP is equally as important as being able to expose it. For that reason we’re also bringing the HttpClient we shipped in the REST starter kit forward. You can use the new client within desktop applications or within services themselves in order to consume other HTTP services. We’re also providing extensions to the client for supporting queryability, which I will cover in the next section.</p>
<p>Below is a simple example of using HttpClient.</p>
<pre>
<pre>var client = <span style="color: #0000ff">new</span> HttpClient();
</pre>
<pre>client.DefaultHeaders.Accept.Add(&quot;<span style="color: #8b0000">text/xml</span>&quot;);
</pre>
<pre>var resp = client.Get(&quot;<span style="color: #8b0000">http://contoso.com/contacts/1</span>&quot;);
</pre>
<pre>resp.Content.ReadAsXmlSerializable&lt;Contact&gt;();
</pre>
</pre>
<h3><u>Request and response processing</u></h3>
<p><a href="http://codebetter.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_thumb19_5F00_7BF6C8D0.png"><img style="border-right-width: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px;padding-top: 0px" border="0" alt="image_thumb[19]" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb19_thumb_746DEA14.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=dbI1v11vggVJJw6%2fc%2bub9RcqIZU%3d" width="356" height="202" /></a></p>
<p>When you work with HTTP, there are various parts of the request and response which need to be processed or transformed <img style="border-bottom-style: none;border-right-style: none;border-top-style: none;border-left-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/wlEmoticon-smile_25FBE85B.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=dt7aBMBLbWiiRzEzDvvI7obJTEY%3d" />. With HttpRequestMessage and HttpResponseMessage we’re allowing you to do this processing within the actual operation as there are places where this is appropriate. However, there are other cases that are concerns that are cross-cutting which don’t belong in the operation. Take formatting for example. It’s very convenient to have the ContactResource simply return and accept a contact, rather than it have to drop down to a message and manually do the formatting. In the same way the ContactResource operation may depend on certain values extracted from segments of the request URI like the ID. In the past we dealt with each of these concerns in a one-off basis. With WCF Web APIs we’re exploring a more general purpose way to handle these concerns. We’re introducing&#160; a request and response pipeline of what we’re currently calling Processors. A Processor has a simple execute method with takes inputs and provides outputs. The inputs could be things like the request or response, or outputs from other processors. In this way processors are composable. </p>
<p>Out of the box we use processors today mainly for extracting values from the uri, for content negotation (selecting the format) and for media type formatters. However processors are extensible, and you can introduce your own for adding custom processing within the request or the response.</p>
<p>We’ve already seen above how to create processors specific for formatting. Here is an example of a different kind of processor that takes a latitude and longitude in a URI for example “http://contoso/map/12.3456,-98.7654” and converts it into Location object. Once the location processor is registered, the MapResource.Get method will automatically get a location object passed in. </p>
<pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> Location
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">double</span> Latitude { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">double</span> Longitude { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre>}
</pre>
<pre></pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> LocationProcessor : Processor&lt;<span style="color: #0000ff">string</span>, <span style="color: #0000ff">string</span>, Location&gt;
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">public</span> LocationProcessor()
</pre>
<pre>    {
</pre>
<pre>        <span style="color: #0000ff">this</span>.OutArguments[0].Name = &quot;<span style="color: #8b0000">Location</span>&quot;;
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>

    <span style="color: #0000ff">public</span> <span style="color: #0000ff">override</span> ProcessorResult&lt;Location&gt; OnExecute(

        <span style="color: #0000ff">string</span> latitude, 

        <span style="color: #0000ff">string</span> longitude)

</pre>
<pre>    {
</pre>
<pre>        var lat = <span style="color: #0000ff">double</span>.Parse(latitude);
</pre>
<pre>        var lon = <span style="color: #0000ff">double</span>.Parse(longitude);
</pre>
<pre>

        <span style="color: #0000ff">return</span> <span style="color: #0000ff">new</span> ProcessorResult&lt;Location&gt; { Output = 

            <span style="color: #0000ff">new</span> Location { Latitude = lat, Longitude = lon } };

</pre>
<pre>    }
</pre>
<pre>}
</pre>
<pre></pre>
<pre>[ServiceContract]
</pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> MapResource {
</pre>
<pre>  [UriTemplate=&quot;<span style="color: #8b0000">{latitude},{longitude}</span>&quot;]
</pre>
<pre>  <span style="color: #0000ff">public</span> Stream Get(Location location) {
</pre>
<pre>    <span style="color: #008000">//return the map</span>
</pre>
<pre>  }
</pre>
<pre>}</pre>
</pre>
<p>The processor above inherits from Processor&lt;T1, T2, TOutput&gt; meaning that it takes two inputs (strings in this case) and it outputs a location. In the execute method the parameter names conventionally match against outputs coming from other processors in this case the method expects “latitude” and “longitude” params. You might be wondering where these parameters come from. If you look on the MapResource.Get method you see that it has 2 parameters named latitude and longitude respectively. A special processor UriTemplateHttpProcessor automatically extracts values from the uri and returns those values as outputs. In this case it returns latitude and longitude thus making those values available to the LocationProcessor (or any other processor).</p>
<p>The logic above is very simple in that it parses numbers. However, you could imagine expanding the processor to do more. For example it could be rewritten to also accept a more expressive uri like “http://contoso/map/12 deg 34’ 56” N, 98 deg 76’ 54” W ”. </p>
<p>This is just a small illustration of the kinds of things you can do with processors. You could imagine handling concerns related to entity tags like IfMatch / IfNonMatch in processors for example.</p>
<p>There’s a lot more to say about processors and their configuration. Look for more on both topics in future posts. <a href="http://www.bizcoder.com">Darrel Miller</a> also has a nice post where he talks about processors <a href="http://www.bizcoder.com/index.php/2010/10/28/wcf-http/">here</a>.</p>
<h2></h2>
<h1>Conventions, Resources and Testability</h1>
<p>We’ve heard plenty of feedback from folks in the community that they would like to see us offer configuration alternatives to attributes and provide more out of the box conventions. We’ve also heard developers asking for us to ensure that we provide better support for test driven development, and using tools like IoC containers. As we move forward we are definitely thinking about all of the above. </p>
<p>Our current focus for the platform has been to enhance the existing Web HTTP programming model to provide richer support for HTTP. These enhancements will likely roll into the framework soon and will provide a very smooth migration path for existing WCF HTTP customers.</p>
<p>Longer term, we are also exploring a new convention based programming model for configuring HTTP resources (services). With this new model we are also looking at how we can enhance it to be more resource oriented, for example allowing specification of child resources so that URIs can be constructed dynamically rather than being hardcoded. This new model will make it’s way to Codeplex soon where we’d like to incubate it with the community. </p>
<p>With the new bits we are delivering we are also being intentional about designing things in a more testable manner for example HttpRequestMessage and HttpResponseMessage allow developers to move away from static calls which are difficult to test. Processors are also easy to test as they each do a single thing, and do not have static dependencies. In addition to the new bits, we are looking at investments we can make into our existing bits to better support testability. For example we are exploring allowing you to plug in an IoC container for service instantiation.&#160; </p>
<h1>It’s still early, we want your help</h1>
<p>We’re still early in the development of these new features! Not all of these features will make it in the box, but many definitely will. You can help us prioritize by checking out our new bits on Codeplex, participating in the forums and adding work items so others can vote.</p>
<p>OK, what are you waiting for? Head on over to <a href="http://wcf.codeplex.com">wcf.codeplex.com</a>. The future awaits!!!</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/glennblock/category/http/" title="View all posts in HTTP" rel="category tag">HTTP</a>, <a href="http://codebetter.com/glennblock/category/rest/" title="View all posts in REST" rel="category tag">REST</a>, <a href="http://codebetter.com/glennblock/category/wcf-web-apis/" title="View all posts in WCF Web APIs" rel="category tag">WCF Web APIs</a>. Bookmark the <a href="http://codebetter.com/glennblock/2010/11/01/wcf-web-apis-http-your-way/" title="Permalink to WCF Web APIs, HTTP your way" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/glennblock/2010/11/01/wcf-web-apis-http-your-way/feed/" title="Comments RSS to WCF Web APIs, HTTP your way" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-137 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/glennblock/2010/10/26/taking-http-support-in-wcf-to-the-next-level/" rel="prev"><span class="meta-nav">&larr;</span> Taking HTTP support in WCF to the next level</a></div>
					<div class="nav-next"><a href="http://codebetter.com/glennblock/2010/11/15/exploring-resources-a-resource-programming-model-and-code-based-configuration/" rel="next">Exploring resources, a resource programming model, and code-based configuration. <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-613">
					<div id="dsq-comment-header-613" class="dsq-comment-header">
						<cite id="dsq-cite-613">
	http://geek.ianbattersby.com							<span id="dsq-author-user-613">Ian Battersby</span>
							</cite>
					</div>
					<div id="dsq-comment-body-613" class="dsq-comment-body">
						<div id="dsq-comment-message-613" class="dsq-comment-message"><p>Great article, it reaffirms all the good vibes I&#8217;d got when watching your screen-cast the other week. </p>
<p>Certainly I&#8217;d like to see the ability to easily plug a IoC container (of my choice), and definitely a &#8220;less attribute .. more convention&#8221; based approach; I&#8217;d also like to see HostConfiguration use some kind of explicit fluent DSL (ala StructureMap).</p>
<p>Keep up the great work, this is all very cool <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-614">
					<div id="dsq-comment-header-614" class="dsq-comment-header">
						<cite id="dsq-cite-614">
								<span id="dsq-author-user-614">Steve</span>
							</cite>
					</div>
					<div id="dsq-comment-body-614" class="dsq-comment-body">
						<div id="dsq-comment-message-614" class="dsq-comment-message"><p>So is this the new direction of WCF, to basically become REST based?  </p>
<p>As much as I prefer that from a personal standpoint, the company I work for prefers SOAP (specifically wsHttp binding) for Transaction Support amongst other things.  So, since this post is also on wcf.codeplex.com, coupled with the Silverlight change of direction &#8220;announcement&#8221; last week, my employer is a little bit worried that all the SOAP based work we have scheduled over the next year is going to be a waste of time.</p>
<p>Any clarification would be great.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-615">
					<div id="dsq-comment-header-615" class="dsq-comment-header">
						<cite id="dsq-cite-615">
	http://www.matthidinger.com							<span id="dsq-author-user-615">Matt Hidinger</span>
							</cite>
					</div>
					<div id="dsq-comment-body-615" class="dsq-comment-body">
						<div id="dsq-comment-message-615" class="dsq-comment-message"><p>WCF may finally become a viable choice for me in the future. In my current apps I&#8217;m still using ASP.NET MVC controllers to create RESTful services that return JSON, they just seem to have so much less overhead and ceremony to get up and running. WCF can do a lot, but it has a pretty high learning curve and a ton of configuration. I really welcome these changes, especially for any services I make in the future. </p>
<p>Keep up the good work Glenn, it&#8217;s great to see the progress so far in a short time you&#8217;ve been on the team.</p>
<p>-Matt</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-616">
					<div id="dsq-comment-header-616" class="dsq-comment-header">
						<cite id="dsq-cite-616">
								<span id="dsq-author-user-616">Steve</span>
							</cite>
					</div>
					<div id="dsq-comment-body-616" class="dsq-comment-body">
						<div id="dsq-comment-message-616" class="dsq-comment-message"><p>Seems that my previous comment/question got eaten.</p>
<p>So, I&#8217;m a bit confused, is Microsoft going all REST with WCF then?  I ask because wcf.codeplex.com  doesn&#8217;t even mention SOAP, and if anything it should be the hub of all things WCF (that, or it&#8217;s incredibly misleading).</p>
<p>Is this due to the fact that the WS* standards really hasn&#8217;t been adopted by anyone?</p>
<p>I&#8217;m cool if that&#8217;s the direction things are going, I&#8217;ve had enough of WCF&#8217;s config hell, and people trying to turn SOAP into just another API call (due to Transaction support), but some clarification would be appreciated.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-617">
					<div id="dsq-comment-header-617" class="dsq-comment-header">
						<cite id="dsq-cite-617">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-617">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-617" class="dsq-comment-body">
						<div id="dsq-comment-message-617" class="dsq-comment-message"><p>@Steve</p>
<p>No, if you watch my talk I clarify that. I will be doing a follow up post to clarify. This an evolution of our HTTP stack, but we still fully committed to the rest of the stack.</p>
<p>We are seeing a lot of interest in taking our HTTP stack further which is why we are doing this work.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-618">
					<div id="dsq-comment-header-618" class="dsq-comment-header">
						<cite id="dsq-cite-618">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-618">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-618" class="dsq-comment-body">
						<div id="dsq-comment-message-618" class="dsq-comment-message"><p>Hi Ian.</p>
<p>The HostConfiguration class is just exploratory at this point. Jeremy have had lots of conversations about FIs and we are planning to do one at some point, but we need to nail the underlying semantic model first.</p>
<p>Thanks<br />
Glenn</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-619">
					<div id="dsq-comment-header-619" class="dsq-comment-header">
						<cite id="dsq-cite-619">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-619">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-619" class="dsq-comment-body">
						<div id="dsq-comment-message-619" class="dsq-comment-message"><p>Matt, thanks for the encouragement.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-620">
					<div id="dsq-comment-header-620" class="dsq-comment-header">
						<cite id="dsq-cite-620">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-620">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-620" class="dsq-comment-body">
						<div id="dsq-comment-message-620" class="dsq-comment-message"><p>@Matt</p>
<p>Agreed that we can definitely simplify the config story. We&#8217;re working on it.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-621">
					<div id="dsq-comment-header-621" class="dsq-comment-header">
						<cite id="dsq-cite-621">
								<span id="dsq-author-user-621">Steve</span>
							</cite>
					</div>
					<div id="dsq-comment-body-621" class="dsq-comment-body">
						<div id="dsq-comment-message-621" class="dsq-comment-message"><p>Glenn,</p>
<p>Thanks for the clarification.  You might want to change up the wcf.codeplex.com page a bit to indicate that though.</p>
<p>A Community Page should reflect the entirely of the application, even if it&#8217;s just a brief description of other features with links to appropriate articles about it.  </p>
<p>With the Sliverlight bruhaha last week, when my employer caught wind of this new site with absolutely no reference to anything but REST, they were incredibly worried that we needed to completely change our remoting/wcf strategy.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-622">
					<div id="dsq-comment-header-622" class="dsq-comment-header">
						<cite id="dsq-cite-622">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-622">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-622" class="dsq-comment-body">
						<div id="dsq-comment-message-622" class="dsq-comment-message"><p>Steve that&#8217;s a great point. I will add something. The reason we called it WCF.Codeplex.com is because we are planning other things..not because WCF is just HTTP <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </p>
<p>Glenn</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/glennblock/2010/11/01/wcf-web-apis-http-your-way/ ';
	var disqus_identifier = '137 /blogs/glenn.block/archive/2010/11/01/wcf-web-apis-http-your-way.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'mytechnobabble';
	var disqus_title = "WCF Web APIs, HTTP your way";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=137');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/glennblock/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/glennblock\/2010\/11\/01\/wcf-web-apis-http-your-way\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.754 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-25 15:09:36 -->
<!-- super cache -->