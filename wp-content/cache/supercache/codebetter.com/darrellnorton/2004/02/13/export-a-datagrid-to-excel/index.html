<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Export a DataGrid to Excel | Darrell Norton</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/darrellnorton/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/darrellnorton/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/darrellnorton/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/darrellnorton/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/darrellnorton/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Darrell Norton' href='http://codebetter.com/darrellnorton/' />
<link rel='start' title='Introductory Web Post' href='http://codebetter.com/darrellnorton/2003/06/03/introductory-web-post/' />
<link rel='prev' title='A Review of Patterns of Enterprise Application Architecture by Martin Fowler' href='http://codebetter.com/darrellnorton/2004/02/11/a-review-of-patterns-of-enterprise-application-architecture-by-martin-fowler/' />
<link rel='next' title='Dodgeit (spam)' href='http://codebetter.com/darrellnorton/2004/02/13/dodgeit-spam/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/' />
<link rel='shortlink' href='http://codebetter.com/darrellnorton/?p=232' />
<link rel="stylesheet" href="http://codebetter.com/darrellnorton/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/darrellnorton/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-232" class="post-232 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">Export a DataGrid to Excel</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/darrellnorton/author/darrellnorton/" title="View all posts by darrellnorton">darrellnorton</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/" title="12:50 am" rel="bookmark"><span class="entry-date">February 13, 2004</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/darrellnorton/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/darrellnorton/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/darrellnorton/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><P>I just found a neat way to output the results of an ASP.NET DataGrid to Excel.&nbsp; Just put the following code in a button_click event handler, and when a&nbsp;user clicks the button, it will output the DataGrid, including formatting, to a new Excel window, leaving the browser window undisturbed.&nbsp; Of course this assumes your users have Excel.</P><SPAN><SPAN><br />
<P><SPAN>&#8216; Set the content type to Excel<BR></SPAN><SPAN><FONT color="#000000">Response.ContentType = &#8220;application/vnd.ms-excel&#8221;</FONT></SPAN></P><br />
<P>&#8216;Turn off the view state<BR></SPAN><SPAN>Me</SPAN><SPAN>.EnableViewState = <SPAN>False</SPAN></SPAN></P><br />
<P><SPAN>&#8216;Remove the charset from the Content-Type header<BR></SPAN><SPAN>Response.Charset = <FONT color="#0000ff">String</FONT>.Empty</SPAN></P><br />
<P><SPAN>Dim</SPAN><SPAN> myTextWriter <SPAN>As</SPAN> <SPAN>New</SPAN> System.IO.StringWriter()<BR><SPAN>Dim</SPAN> myHtmlTextWriter <SPAN>As</SPAN> <SPAN>New</SPAN> System.Web.UI.HtmlTextWriter(myTextWriter)</SPAN></P><br />
<P><SPAN>&#8216;Get the HTML for the control<BR></SPAN><SPAN>myDataGrid.RenderControl(myHtmlTextWriter)</SPAN></P><br />
<P><SPAN>&#8216;Write the HTML to the browser<BR></SPAN><SPAN>Response.Write(myTextWriter.ToString())</SPAN></P><br />
<P><SPAN>&#8216;End the response<BR></SPAN><SPAN>Response.End()</SPAN></P><br />
<P><FONT color="#ff0000"><STRONG>Update:</STRONG></FONT> Added the Response.ContentType line which I had inadvertently forgotten.</P><br />
<P><STRONG><FONT color="#ff0000">Update 2:</FONT></STRONG>&nbsp; <A href="http://www.dotnetjunkies.com/bsblog">Brendan Tompkins</A>&nbsp;has graciously offered <A href="http://www.intrinsigo.com/bsblog/ExcelXML.zip">3 XSLT files</A> to transform a DataGrid&#8217;s XML into Excel, comma-delimited, and tab-delimited files.&nbsp; Thanks Brendan!</P></SPAN></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/darrellnorton/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/" title="Permalink to Export a DataGrid to Excel" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/feed/" title="Comments RSS to Export a DataGrid to Excel" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-232 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/darrellnorton/2004/02/11/a-review-of-patterns-of-enterprise-application-architecture-by-martin-fowler/" rel="prev"><span class="meta-nav">&larr;</span> A Review of Patterns of Enterprise Application Architecture by Martin Fowler</a></div>
					<div class="nav-next"><a href="http://codebetter.com/darrellnorton/2004/02/13/dodgeit-spam/" rel="next">Dodgeit (spam) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">91 Responses to <em>Export a DataGrid to Excel</em> </h3>

			<div class="navigation">
				<div class="nav-previous"></div>
				<div class="nav-next"></div>
			</div>

			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-511">
		<div id="comment-511">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">kimptonr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-511">March 16, 2005 at 1:26 pm</a></div>

		<div class="comment-body"><p>Hi Sam tryed changing to addheader but still no good. I know the code works as I can download the file with a smaller date range but when I try for the full 6k lines I get no dialogue box. Just a blank aspx page<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-510">
		<div id="comment-510">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-510">March 16, 2005 at 1:15 pm</a></div>

		<div class="comment-body"><p>Hello,<br />
<br />I still have the same problem. It looked for a while that it got solved, but nope. I still have the same problem as mentioned below. But one thing I have observed is, it works great in a mozilla browser, or firefox. Any ideas??</p>
<p>&quot;I have used :<br />
<br />Response.AddHeader(&quot;content-disposition&quot;, &quot;attachment; filename=myfile.xls&quot;)<br />
<br />This opens the file download dialog box with open and save options I have expected. The save button works great, the problem is when I click, Open, excel application opens and then an eror message is displayed something in these lines &quot;the file you are looking for is not found in documents and settings/&lt;user&gt;/Local Settings/Temporary Internet Files/Contents.IE5&#8230;.&quot;<br />
<br />And also I oberved that, if I keep the excel application open when I click on the button, the Open button on file download works fine. It opens the excel file.<br />
<br />Can anyone help me solve the mistery??&quot;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-509">
		<div id="comment-509">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-509">March 16, 2005 at 1:14 pm</a></div>

		<div class="comment-body"><p>Kimptonr,</p>
<p>I am not sure if this could be a problem but try, Response.AddHeader instaed of Response.AppendHeader.<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-508">
		<div id="comment-508">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">kimptonr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-508">March 16, 2005 at 5:42 am</a></div>

		<div class="comment-body"><p>Hi Sam, My problem is that the dialog box doesn&#8217;t open! Any ideas? Here is my code<br />
<br /> Response.Clear()<br />
<br />        Response.ClearContent()<br />
<br />        Response.ClearHeaders()<br />
<br />        Response.AppendHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=stockmovementbreakdown.xls&quot;)</p>
<p>        Response.ContentType = &quot;application/vnd.ms-excel&quot;</p>
<p>        Response.Charset = String.Empty</p>
<p>        Dim tw As New System.IO.StringWriter<br />
<br />        Dim hw As New System.Web.UI.HtmlTextWriter(tw)</p>
<p>        &#8216; Get the HTML for the control.<br />
<br />        ordermovementgrid.RenderControl(hw)<br />
<br />        &#8216; Write the HTML back to the browser.<br />
<br />        Response.Write(tw.ToString())<br />
<br />        &#8216; End the response.<br />
<br />        Response.End()</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-507">
		<div id="comment-507">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-507">March 15, 2005 at 6:45 pm</a></div>

		<div class="comment-body"><p>I figured the problem of my question. I have a user control which has the button that triggers the whole datagrid to excel export.<br />
<br />I used Response object and neglected that I have to point the response object of the parent page in which the user control resides.<br />
<br />I then went and added:</p>
<p>MyBase.Response, and boom, it works now!<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-506">
		<div id="comment-506">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-506">March 15, 2005 at 6:09 pm</a></div>

		<div class="comment-body"><p>I have used :<br />
<br />Response.AddHeader(&quot;content-disposition&quot;, &quot;attachment; filename=myfile.xls&quot;)<br />
<br />This opens the file download dialog box with open and save options I have expected. The save button works great, the problem is when I click, Open, excel application opens and then an eror message is displayed something in these lines &quot;the file you are looking for is not found in documents and settings/&lt;user&gt;/Local Settings/Temporary Internet Files/Contents.IE5&#8230;.&quot;<br />
<br />And also I oberved that, if I keep the excel application open when I click on the button, the Open button on file download works fine. It opens the excel file.<br />
<br />Can anyone help me solve the mistery??</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-505">
		<div id="comment-505">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">kimptonr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-505">March 15, 2005 at 7:42 am</a></div>

		<div class="comment-body"><p>I have a similar problem I&#8217;m trying to download 11k rows and I get a blank screen and nothing returns. Any ideas? Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-504">
		<div id="comment-504">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/darrell.norton/' rel='external nofollow' class='url'>Darrell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-504">March 9, 2005 at 10:45 am</a></div>

		<div class="comment-body"><p>Use CarlosAg&#8217;s Excel XML Writer library:<br />
<br /><a target="_new" href="http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx">http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-503">
		<div id="comment-503">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Carlos M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-503">March 8, 2005 at 9:23 pm</a></div>

		<div class="comment-body"><p>I am trying to Export DataGrids to Excel.  Here is my problem:</p>
<p>The HTMLTextWriter passes the HTML tables into Excel.  This causes problems with large data sets.  For example, I have about 16K rows (7 columns).   After downloading it to the client, the .xls file takes about 5 min to open on a relatively fast computer.  </p>
<p>Any ideas?  DataGrid would be the preferred method when exporting.  Thanks in advance.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-502">
		<div id="comment-502">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Buddy2005</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-502">February 25, 2005 at 6:18 am</a></div>

		<div class="comment-body"><p>Hi All</p>
<p>Can anyone help me in solving my problem. I am battling to make it right. Problem is &#8211;</p>
<p>When I click on &quot;Export to Excel&quot; button on my web page &#8211; it opens a new window b/c I have addded the javascript code as window.open(strURL). On this new browser it opens the excel workseet with the same contents I need. But the problem is that the name of the worksheet is picked up from &quot;URL&quot;.</p>
<p>Please find a fraction of code :-<br />
<br />Response.Clear()<br />
<br />Response.Buffer = True<br />
<br />Response.Charset = String.Empty<br />
<br />Me.EnableViewState = False<br />
<br />Response.AddHeader(&quot;Content-Disposition&quot;, &quot;inline;filename=MyReport.xls&quot;)<br />
<br />Response.ContentType = &quot;application/vnd.ms-excel&quot;</p>
<p>If I open this web application on web server then the name of worksheet and window name is &quot;MyReport.xls&quot;.</p>
<p>But if open the web application from any other client machine then the window and worksheet name is picked up from the URL instead of &quot;MyReport.xls&quot;.</p>
<p>I have no clue, how to resolve this. I have tried a lot of things. But doesn&#8217;t work.</p>
<p>Can any one help me out please&#8230;..</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-501">
		<div id="comment-501">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Tony Ngo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-501">January 17, 2005 at 6:45 am</a></div>

		<div class="comment-body"><p>Sorry for not showing the link but here it is again.<br />
<br /><a target="_new" href="http://weblogs.asp.net/datagridgirl/archive/2003/04/14/5631.aspx">http://weblogs.asp.net/datagridgirl/archive/2003/04/14/5631.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-500">
		<div id="comment-500">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Tony Ngo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-500">January 17, 2005 at 6:34 am</a></div>

		<div class="comment-body"><p>You can check this out.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-499">
		<div id="comment-499">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Akram Javed Kayani</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-499">January 16, 2005 at 12:25 am</a></div>

		<div class="comment-body"><p>Hi,<br />
<br />Im haveing a little issue with the formatting of coulms after the export is complete. For example I have a coulm that contains text, but after it is exported into excel if a certain cell in the column only contained digits like 1234 excel leaves it as it is but if I have a longer string of digits like 12345678809 excel converst it into something like 1234Exx or something. Same is with some dates values like if i write 1: 21-12-2003 it would convert it into 1-1-2003 1:21AM where &quot;1:&quot; was only intended as a line number kind of thing. How can i prevent excel from formating the data on its own.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-498">
		<div id="comment-498">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">BlackCatBone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-498">December 29, 2004 at 7:57 am</a></div>

		<div class="comment-body"><p>Hello,</p>
<p>Does anyone know how to set the charset of the Response object so that the unicode character set is used when exporting a datagrid to Excel?  All the examples I have seen include the equivalnet of this C# line:</p>
<p>Response.Charset = &quot;&quot;;</p>
<p>I am using the Northwind database and international characters (such as two dots over the letter O) are scrambled in Excel.  I tried this line but it did not work:</p>
<p>Response.Charset = &quot;utf-8&quot;;</p>
<p>Can anyone help with this?</p>
<p>Thanks.</p>
<p>BCB</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-497">
		<div id="comment-497">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sravanth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-497">December 24, 2004 at 2:53 am</a></div>

		<div class="comment-body"><p>Does anyone know how to change the sheet name produced so that it doesn&#8217;t just default to the actual name of the page?<br />
<br />The problem im facing is that the name of the excel file is &quot;assignmentList.xls&quot; but the Sheet gets named to &quot;.xls]AssignmentList&quot;. Any clues.</p>
<p>Thanks in Advance,<br />
<br />Sravanth</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-496">
		<div id="comment-496">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-496">December 21, 2004 at 7:54 pm</a></div>

		<div class="comment-body"><p>I&#8217;m not really sure. Try the code sample on this page to see if it works the way you want it to:<br />
<br /><a target="_new" href="http://www.eggheadcafe.com/articles/20021220.asp">http://www.eggheadcafe.com/articles/20021220.asp</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-495">
		<div id="comment-495">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">BlackCatBone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-495">December 21, 2004 at 2:23 pm</a></div>

		<div class="comment-body"><p>Darrell,</p>
<p>Yes, the code is in a button.  And yes, Microsoft Excel opens in a separate window and displays the exported data.</p>
<p>But I don&#8217;t think I made my question clear.  I&#8217;m not trying to open Microsoft Excel.  I want to display the exported data inside a second instance of the IE web browser.  Meaning that when the user clicks the Export button, IE would pop open another window that hosted the Excel data.</p>
<p>Why am I trying to do this?  My customer doesn&#8217;t like the &quot;open or save&quot; prompt that is always displayed before the data are made visible.  I believe that if I can open the exported data in a separate IE window, my customer will not get this prompt.</p>
<p>Thanks for any help you can provide.</p>
<p>BCB</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-494">
		<div id="comment-494">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-494">December 21, 2004 at 12:44 pm</a></div>

		<div class="comment-body"><p>Did you put the export to excel code in a button? If so that should open up Excel in its own window, leaving the browser window unchanged.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-493">
		<div id="comment-493">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">BlackCatBone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-493">December 21, 2004 at 11:45 am</a></div>

		<div class="comment-body"><p>Darrell,</p>
<p>I&#8217;ve succeeded in exporting my DataGrid contents to Microsoft Excel by adding this line to the export logic:<br />
<br />Response.AddHeader(&quot;content-disposition&quot;,&quot;attachment; filename=divreinvestment.xls&quot;) </p>
<p>However, I would like to display the exported data in a second IE window that I open when the user clicks the Export button.  If I omit the line I referenced above, the exported data overlay the page the user was on when they clicked the &quot;Export&quot; button.  In other words, there is no second window.  The exported data just wipe out the page containing the Export button.</p>
<p>I think you mentioned a way to open a second IE (not Excel) window in one of your earlier posts when you stated:</p>
<p>&quot;To open it in a new window simply direct the form at the top of the report to<br />
<br />target = &quot;_blank&quot; &quot;</p>
<p>My problem is I don&#8217;t know how to do what you are suggesting.  Could you supply a code fragment that shows how and where you assign a value to &quot;target&quot;?</p>
<p>Thanks for your help.</p>
<p>BlackCatBone</p>
<p></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-492">
		<div id="comment-492">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Louise</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-492">December 7, 2004 at 3:08 am</a></div>

		<div class="comment-body"><p>I have exported a datagrid to excel, but some of the fields themselves contain new lines (\r\n).  When this is exported the data which should appear in one cell breaks over a number of lines.  Is there some character I can replace the \r\n with, which will cause excel to take a new line within the same cell (Equivalent of Alt + Enter).</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-491">
		<div id="comment-491">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Chris Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-491">December 1, 2004 at 6:34 pm</a></div>

		<div class="comment-body"><p>Response.AddHeader(&quot;content-disposition&quot;,&quot;attachment; filename=divreinvestment.xls&quot;)<br />
<br />Opens in new excel window.<br />
<br />Thanks BEN I&#8217;ve looking everywhere for that.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-490">
		<div id="comment-490">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-490">December 1, 2004 at 2:10 pm</a></div>

		<div class="comment-body"><p>Lori &#8211; Check out Carlos&#8217; Excel Xml Writer utility. Office 2003 works much better through Excel. The hack above was to make sure it worked on down-level Excel versions.</p>
<p><a target="_new" href="http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx">http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-489">
		<div id="comment-489">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Lori</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-489">December 1, 2004 at 1:12 pm</a></div>

		<div class="comment-body"><p>I have the export to excel code (shown at the top) and it was working great, until our company pushed out office 2003.  Now you get the file download box, but when you press open, the page flickers, the download box goes away, but you never get the document.  I tried inserting the &quot;add header&quot; line, but then I get 2 file download boxes, one right after the other, then the excel does open in a new browser.  Anyone have any ideas on what changed?  I don&#8217;t think my customer&#8217;s what to press open twice.  Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-488">
		<div id="comment-488">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Temp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-488">November 4, 2004 at 6:29 am</a></div>

		<div class="comment-body"><p>I am getting error response.End() part. It says &#8216;Thread was being aborted&#8217;.  Could any one help me fix this.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-487">
		<div id="comment-487">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">POD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-487">November 2, 2004 at 3:45 pm</a></div>

		<div class="comment-body"><p>I have a question guys, i dunno much about ASP, so i do most programs on VB and Access.  I am creating a program now on VB and I&#8217;m kindly asking you guys if you can help me export data on my VB Datagrid to an Excel file (template Excel file &#8211; meaning the file is already existing and program should fill up which columns i want to fill up).  Example Col1 &amp; Row1 of VB Datagrid should fill up Col5 and Row5 of my Excel Template.  Or any workaround will do.  Please do help me if you have any idea on this.  thanks&#8230;.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-486">
		<div id="comment-486">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-486">October 18, 2004 at 5:46 am</a></div>

		<div class="comment-body"><p>No meta tags or anything of that nature. You can always post your problem on the ASP.NET Forums. If you post your code there people generally can answer your question right away.  Post it to this forum:</p>
<p><a target="_new" href="http://asp.net/Forums/ShowForum.aspx?tabindex=1&amp;ForumID=24">http://asp.net/Forums/ShowForum.aspx?tabindex=1&amp;ForumID=24</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-485">
		<div id="comment-485">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Nand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-485">October 17, 2004 at 2:17 am</a></div>

		<div class="comment-body"><p>Darrell i ve gone thru the code..if possible can u send me the screen shot and code.if u tell ur email address i could give u how my excel file looks&#8230;i use notepad to type my code and not the VS editor..is there any meta tag to add</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-484">
		<div id="comment-484">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-484">October 15, 2004 at 5:33 am</a></div>

		<div class="comment-body"><p>Nand &#8211; try checking out a complete tutorial here:<br />
<br /><a target="_new" href="http://www.dotnetjohn.com/articles/articleid78.aspx">http://www.dotnetjohn.com/articles/articleid78.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-483">
		<div id="comment-483">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">nand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-483">October 15, 2004 at 3:05 am</a></div>

		<div class="comment-body"><p>Darrell ,can u help me with the problem.<br />
<br />The above is the code i used.it opens the excel file with controls in web page but not data in data grid.<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-482">
		<div id="comment-482">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-482">October 13, 2004 at 6:09 am</a></div>

		<div class="comment-body"><p>To open it in a new window simply direct the form at the top of the report to<br />
<br />target = &quot;_blank&quot;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-481">
		<div id="comment-481">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">nand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-481">October 13, 2004 at 2:29 am</a></div>

		<div class="comment-body"><p>Let me know what is problem with above code</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-480">
		<div id="comment-480">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Nand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-480">October 13, 2004 at 1:21 am</a></div>

		<div class="comment-body"><p>this is the code i use</p>
<p> response.Clear()<br />
<br />&#8216;	Response.buffer=true</p>
<p>	Response.ContentType = &quot;application/vnd.ms-excel&quot;<br />
<br />	Me.EnableViewState = false<br />
<br />	Response.Charset = String.Empty</p>
<p>	Dim tw As New System.IO.StringWriter()<br />
<br />        Dim hw As New System.Web.UI.HtmlTextWriter(tw)</p>
<p>       dgExport.RenderControl(hw)</p>
<p>       response.write(tw.Tostring())<br />
<br />       response.end</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-479">
		<div id="comment-479">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Nand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-479">October 13, 2004 at 1:20 am</a></div>

		<div class="comment-body"><p>i ve used the same code as above but it does not work<br />
<br />it opens the excel sheet with controls in web page.The data grid that i ve is a simple one with no controls.pls let me know what is wrong</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-478">
		<div id="comment-478">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-478">October 12, 2004 at 8:40 am</a></div>

		<div class="comment-body"><p>To open it in a new window simply direct the form at the top of the report to<br />
<br />target = &quot;_blank&quot;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-477">
		<div id="comment-477">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">stefan demetz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-477">October 1, 2004 at 3:23 pm</a></div>

		<div class="comment-body"><p><a target="_new" href="http://dotnetjunkies.com/WebLog/stefandemetz/archive/2004/10/01/27337.aspx">http://dotnetjunkies.com/WebLog/stefandemetz/archive/2004/10/01/27337.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-476">
		<div id="comment-476">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-476">September 17, 2004 at 6:54 am</a></div>

		<div class="comment-body"><p>Andrew &#8211; see if any of the resources on this page help: <a target="_new" href="http://weblogs.asp.net/sbehera/archive/2003/11/13/37251.aspx">http://weblogs.asp.net/sbehera/archive/2003/11/13/37251.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-475">
		<div id="comment-475">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-475">September 17, 2004 at 1:27 am</a></div>

		<div class="comment-body"><p>I am trying to export to excel and that works fine! but i then wish to import that data back to the server at a later date! my problem being i hav a validation check and i need the saved .XLS file to be in application/vnd.ms-excel format. it is however not in this format so it does not work!? any ideas</p>
<p>- <a href="mailto:andrew.j.h.phillips@btinternet.com">andrew.j.h.phillips@btinternet.com</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-474">
		<div id="comment-474">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Raj</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-474">September 16, 2004 at 3:13 pm</a></div>

		<div class="comment-body"><p>Brian,<br />
<br />Did you get your excel sheet to open in a new browser window? If not let me know and I can help. I just got mine to work. Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-473">
		<div id="comment-473">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-473">September 14, 2004 at 12:02 pm</a></div>

		<div class="comment-body"><p>When user hit open in file download dialogue box? It doesn&#8217;t open a new window. Please help.<br />
<br />THanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-472">
		<div id="comment-472">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Geert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-472">September 7, 2004 at 11:59 pm</a></div>

		<div class="comment-body"><p>Great stuff! Just what I needed <img src='http://codebetter.com/darrellnorton/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-471">
		<div id="comment-471">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-471">August 18, 2004 at 7:04 am</a></div>

		<div class="comment-body"><p>Does anyone know how to change the sheet name produced so that it doesn&#8217;t just default to the actual name of the page?</p>
<p>Thanx, Chris</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-470">
		<div id="comment-470">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-470">July 30, 2004 at 9:13 am</a></div>

		<div class="comment-body"><p>Interesting.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-469">
		<div id="comment-469">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-469">July 30, 2004 at 8:41 am</a></div>

		<div class="comment-body"><p>Interestingly I found out that the data grid output is in HTML format however the WriteLine output is not.  The debugger showed me this.</p>
<p>I guess this means I need to format my WriteLine output in HTML and add a table and it should work.</p>
<p>?myTextWriter.ToString()<br />
<br />&quot;Start Date: 6/6/2004</p>
<p>End Date: 6/6/2004</p>
<p>&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;4&quot; rules=&quot;all&quot; class=&quot;standard_font&quot; bordercolor=&quot;#CCCCCC&quot; border=&quot;1&quot; id=&quot;datagridCommissionReport&quot; style=&quot;border-color:#CCCCCC;border-width:1px;border-style:Solid;border-collapse:collapse;&quot;&gt;<br />
<br />	&lt;tr class=&quot;tabletitle&quot;&gt;<br />
<br />		&lt;td&gt;Title&lt;/td&gt;&lt;td&gt;Title1&lt;/td&gt;&lt;td&gt;Retail&lt;/td&gt;&lt;td&gt;Title2&lt;/td&gt;&lt;td&gt;Title3&lt;/td&gt;&lt;td&gt;Title4&lt;/td&gt;&lt;td&gt;Title5&lt;/td&gt;&lt;td&gt;Title6&lt;/td&gt;&lt;td&gt;Title7&lt;/td&gt;&lt;td&gt;Title8&lt;/td&gt;&lt;td&gt;Title9&lt;/td&gt;<br />
<br />	&lt;/tr&gt;&lt;tr&gt;<br />
<br />		&lt;td nowrap=&quot;nowrap&quot; style=&quot;font-weight:bold;&quot;&gt;X,X&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;<br />
<br />	&lt;/tr&gt;&lt;tr class=&quot;tablelightcell&quot;&gt;<br />
<br />		&lt;td nowrap=&quot;nowrap&quot; style=&quot;font-weight:bold;&quot;&gt;X,X&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;&lt;td align=&quot;Right&quot;&gt;$0.00&lt;/td&gt;<br />
<br />	&lt;/tr&gt;<br />
<br />&lt;/table&gt;&quot;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-468">
		<div id="comment-468">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-468">July 30, 2004 at 8:31 am</a></div>

		<div class="comment-body"><p>Darrell.  Adding the Environment.Newline doesn&#8217;t work.  Thanks for the idea though.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-467">
		<div id="comment-467">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-467">July 30, 2004 at 8:01 am</a></div>

		<div class="comment-body"><p>Have you tried something like this?</p>
<p>myHtmlTextWriter.WriteLine(lblStartDate.Text)<br />
<br />myHtmlTextWriter.WriteLine(Environment.Newline)<br />
<br />myHtmlTextWriter.WriteLine(lblEndDate.Text)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-466">
		<div id="comment-466">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-466">July 30, 2004 at 7:51 am</a></div>

		<div class="comment-body"><p>I am also trying to output additional lines to the Excel spreadsheet.  I am adding lines like the following in the button click:</p>
<p>myHtmlTextWriter.WriteLine(lblStartDate.Text)<br />
<br />myHtmlTextWriter.WriteLine(lblEndDate.Text)</p>
<p>Unfortunately, even though this is supposed to write line terminators, it doesn&#8217;t and all the additional text is on the same line.  </p>
<p>does anyone know how to get each WriteLine to output to a new excel line?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-465">
		<div id="comment-465">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-465">July 28, 2004 at 7:29 am</a></div>

		<div class="comment-body"><p>Thanks Ben!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-464">
		<div id="comment-464">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-464">July 28, 2004 at 7:27 am</a></div>

		<div class="comment-body"><p>OK &#8211; </p>
<p>OPEN REPORT IN NEW WINDOW : you need to add the following code.</p>
<p>Response.AddHeader(&quot;content-disposition&quot;,&quot;attachment; filename=divreinvestment.xls&quot;)</p>
<p>The code above gives a file download dialogue box and the user can select save or open.</p>
<p>TO REMOVE UNWANTED CONTROLS (eg. buttons that cause a form error)</p>
<p>You will need to remove the column from the datagrid. Code has been posted suggesting that the following will work :</p>
<p>clientval.Columns.Remove(clientval.Columns.Item(11)) </p>
<p>The above will not work as the datagrid has to be rebound in order for the column changes to take effect.</p>
<p>I ended up using a function to return a dataset, removing the column then binding the datagrid again before exporting to XLS.</p>
<p>Hope this helps (I have just spent best part of a day on this!!!)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-463">
		<div id="comment-463">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Ben White</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-463">July 28, 2004 at 2:53 am</a></div>

		<div class="comment-body"><p>Has anyone come up with a workable solution to opening the report up in a new window?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-462">
		<div id="comment-462">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-462">July 6, 2004 at 10:25 am</a></div>

		<div class="comment-body"><p>Take a look at Jason Haley&#8217;s blog post here:<br />
<br /><a target="_new" href="http://dotnetjunkies.com/WebLog/jhaley/archive/2004/03/20/9583.aspx">http://dotnetjunkies.com/WebLog/jhaley/archive/2004/03/20/9583.aspx</a></p>
<p>He includes formulas, so I&#8217;m sure a similar method could be used to include cell formatting for numbers and so forth.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-461">
		<div id="comment-461">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-461">July 6, 2004 at 9:59 am</a></div>

		<div class="comment-body"><p>Works great, was wondering how to change the value going in to Excel as &#8216;TEXT&#8217; not &#8216;GENERAL&#8217; most of the account numbers are coming as 2.1999457E+1 so really from &#8216;GENERAL&#8217; to &#8216;NUMBER&#8217; etc&#8230;? Or if you have any other sugests..</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-460">
		<div id="comment-460">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-460">June 29, 2004 at 2:35 pm</a></div>

		<div class="comment-body"><p>Check this Microsoft KB article:<br />
<br /><a target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;317719">http://support.microsoft.com/default.aspx?scid=kb;EN-US;317719</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-459">
		<div id="comment-459">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Gaye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-459">June 29, 2004 at 2:24 pm</a></div>

		<div class="comment-body"><p>I don&#8217;t find target as a property for the button control.  It&#8217;s not a button column on the datagrid  &#8211;it&#8217;s just an asp button at the bottom of my page.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-458">
		<div id="comment-458">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-458">June 29, 2004 at 2:03 pm</a></div>

		<div class="comment-body"><p>In the button&#8217;s properties, have the target set to _new.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-457">
		<div id="comment-457">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Gaye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-457">June 29, 2004 at 1:53 pm</a></div>

		<div class="comment-body"><p>Hi Darrell,</p>
<p>The way it works is it opens a new page in excel within my existing browser.  If the user closes &#8211; what they think is excel &#8211; it closes the whole browser.  I would like to open the new excel page in a new browser &#8212; so if the user closes the excel page &#8211; it doesn&#8217;t close the original browser.  Hope that makes sense.</p>
<p>I&#8217;m using IE.</p>
<p>Thanks, Gaye</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-456">
		<div id="comment-456">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-456">June 29, 2004 at 1:00 pm</a></div>

		<div class="comment-body"><p>Gaye &#8211; what do you mean by opens in a new page? Are you using Mozilla or IE? Is it a new page in Excel or the browser?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-455">
		<div id="comment-455">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">gaye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-455">June 29, 2004 at 11:43 am</a></div>

		<div class="comment-body"><p>I was trying to open the excel in a new window using the information above:</p>
<p>Response.AddHeader( &quot;Content-Disposition&quot;, &quot;filename=&quot;+someName); </p>
<p>But this doesn&#8217;t open in a new window &#8212; it opens in a new page &#8212; is there a way to open in a new window?? or am I doing something wrong?</p>
<p>Thanks, Gaye</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-454">
		<div id="comment-454">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-454">June 10, 2004 at 9:14 am</a></div>

		<div class="comment-body"><p>Larry &#8211; make sure to sort the datagrid so that the row you want is at the top. Is your datagrid bound to a dataset? If so, use the Find method to select the individual row.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-453">
		<div id="comment-453">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-453">June 10, 2004 at 8:59 am</a></div>

		<div class="comment-body"><p>I&#8217;ll try that. But, how does that give it the row that I want?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-452">
		<div id="comment-452">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-452">June 9, 2004 at 7:43 pm</a></div>

		<div class="comment-body"><p>Set the pagesize of the DataGrid to 1, then rebind the datagrid, and then export to Excel.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-451">
		<div id="comment-451">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-451">June 9, 2004 at 3:59 pm</a></div>

		<div class="comment-body"><p>how about exporting just one row of the datagrid to excel.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-450">
		<div id="comment-450">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-450">May 10, 2004 at 2:05 pm</a></div>

		<div class="comment-body"><p>Sal &#8211; try checking out Brendan&#8217;s utility class here: <a target="_new" href="http://dotnetjunkies.com/WebLog/bsblog/archive/2004/04/27/12229.aspx">http://dotnetjunkies.com/WebLog/bsblog/archive/2004/04/27/12229.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-449">
		<div id="comment-449">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sal </cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-449">May 10, 2004 at 1:55 pm</a></div>

		<div class="comment-body"><p>Code works great for basic grid. Thanks!<br />
<br />It does fail, however, if you use the DataGrid&#8217;s AllowPaging property (which I find useful for presenting large data tables. Does anyone have a solution to this one (besides turning off paging)? I&#8217;ve tried and failed.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-448">
		<div id="comment-448">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Thomas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-448">May 10, 2004 at 6:50 am</a></div>

		<div class="comment-body"><p>Response.End thread was being aborted</p>
<p>How can i fix it ?<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-447">
		<div id="comment-447">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-447">May 3, 2004 at 1:07 pm</a></div>

		<div class="comment-body"><p>Kevin &#8211; someName is just a string variable that holds a file name.  You can use &quot;myExcelFile.xls&quot; if you want.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-446">
		<div id="comment-446">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-446">May 3, 2004 at 12:10 pm</a></div>

		<div class="comment-body"><p>what is suppose to be placed in the someName spot because when i put that in there it tells me that i have not declared someName!!<br />
<br />thanks!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-445">
		<div id="comment-445">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-445">April 26, 2004 at 6:42 pm</a></div>

		<div class="comment-body"><p>Kevin &#8211; add this line of code right before the Response.ContentType line:</p>
<p>//This will make the browser interpret the output as an Excel file<br />
<br />Response.AddHeader( &quot;Content-Disposition&quot;, &quot;filename=&quot;+someName);</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-444">
		<div id="comment-444">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-444">April 26, 2004 at 3:43 pm</a></div>

		<div class="comment-body"><p>Is there a way to open the excel in a new window?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-443">
		<div id="comment-443">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-443">April 26, 2004 at 2:57 pm</a></div>

		<div class="comment-body"><p>Look what happens when people try to get along and help each other.  Can&#8217;t we all just&#8230; get along?  <img src='http://codebetter.com/darrellnorton/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-442">
		<div id="comment-442">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-442">April 26, 2004 at 2:28 pm</a></div>

		<div class="comment-body"><p>Danny,<br />
<br />thanks for the help what it was is that i had a column for editing the records so that is why it was not working. Thanks for the help!!!<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-441">
		<div id="comment-441">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-441">April 25, 2004 at 8:41 am</a></div>

		<div class="comment-body"><p>Danny &#8211; thanks!  Good answer.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-440">
		<div id="comment-440">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-440">April 25, 2004 at 5:55 am</a></div>

		<div class="comment-body"><p>Hi Kevin,</p>
<p>You will get the error &#8216;must be placed inside a form tag with runat=server&#8217; if the datagrid contains a control.</p>
<p>In your case you have the datagrids AllowSorting=&quot;true&quot; which makes the headers of the datagrid a link which is then a control.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-439">
		<div id="comment-439">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-439">April 24, 2004 at 8:14 am</a></div>

		<div class="comment-body"><p>Kevin &#8211; I&#8217;m not ignoring, just have a lot going on this weekend.  I&#8217;ll work on it some and try to get back to this blog entry.  Also you can send me an email via the Contact page and I&#8217;ll get in touch with you in person.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-438">
		<div id="comment-438">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-438">April 23, 2004 at 1:38 pm</a></div>

		<div class="comment-body"><p>Here is the code for the button:</p>
<p>Sub exportbutton_onclick(s as Object, e as EventArgs)</p>
<p>&#8216; Set the content type to Excel<br />
<br />Response.ContentType = &quot;application/vnd.ms-excel&quot;</p>
<p>&#8216;Turn off the view state<br />
<br />Me.EnableViewState = False</p>
<p>&#8216;Remove the charset from the Content-Type header<br />
<br />Response.Charset = String.Empty</p>
<p>Dim myTextWriter As New System.IO.StringWriter()<br />
<br />Dim myHtmlTextWriter As New System.Web.UI.HtmlTextWriter(myTextWriter)</p>
<p>&#8216;Get the HTML for the control<br />
<br />dgCore.RenderControl(myHtmlTextWriter)</p>
<p>&#8216;Write the HTML to the browser<br />
<br />Response.Write(myTextWriter.ToString())</p>
<p>&#8216;End the response<br />
<br />Response.End()</p>
<p>End Sub<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-437">
		<div id="comment-437">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-437">April 23, 2004 at 1:28 pm</a></div>

		<div class="comment-body"><p>Kevin &#8211; I haven&#8217;t seen that error message before.  Can you send some sample code via the contact page?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-436">
		<div id="comment-436">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-436">April 23, 2004 at 12:59 pm</a></div>

		<div class="comment-body"><p>I get this error when the export button is pushed System.Web.HttpException: Control &#8216;dgCore__ctl2__ctl0&#8242; of type &#8216;Button&#8217; must be placed inside a form tag with runat=server.</p>
<p>and it refers to the line:<br />
<br />dgCore.RenderControl(myHtmlTextWriter)</p>
<p>My datagrid is inside the form tags so i do not know what the problem is? Does anyone know?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-435">
		<div id="comment-435">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-435">April 21, 2004 at 8:48 am</a></div>

		<div class="comment-body"><p>alishcka &#8211; I thought setting the Response.Charset to an empty string would solve that problem.  I&#8217;m not sure on how to internationalize this, since I don&#8217;t have that much experience in this area.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-434">
		<div id="comment-434">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">alishcka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-434">April 21, 2004 at 8:33 am</a></div>

		<div class="comment-body"><p>I have other kind of solution for the same problem it&#8217;s called dataset to excel. I didn&#8217;t send datagrid to excel but I send to dataset which fill the grid. you can find code in the internet for this solution. but main problem is for me I don&#8217;t live in the English spoken countries so how can I fit the charset problem<br />
<br />because in turkey we use latin alfabet but some kind of vovels not have equvalent.<br />
<br />so if you know any kind of way please share.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-433">
		<div id="comment-433">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-433">April 13, 2004 at 7:33 am</a></div>

		<div class="comment-body"><p>I got an error</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-432">
		<div id="comment-432">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-432">April 6, 2004 at 8:45 am</a></div>

		<div class="comment-body"><p>Yvonne &#8211; I already had that line of code in there.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-431">
		<div id="comment-431">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Yvonne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-431">April 6, 2004 at 7:46 am</a></div>

		<div class="comment-body"><p>I have been running into the exact same problem the code below fixed it</p>
<p>IMPORTANT: Excel XP will not show the report if this line is not added:<br />
<br />EnableViewState = false; If you don&#8217;t do it , it will tell you that it is &quot;unable to read the file&quot;<br /></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-430">
		<div id="comment-430">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-430">April 3, 2004 at 10:26 am</a></div>

		<div class="comment-body"><p>Bill &#8211; if you could send me (email me via the blog and I&#8217;ll reply) a copy of what you are using I could try to fix it.  I can&#8217;t seem to replicate this for the life of me.  Also, what version of Excel are you testing on?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-429">
		<div id="comment-429">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Bill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-429">April 3, 2004 at 6:40 am</a></div>

		<div class="comment-body"><p>Jeremy, I get the &#8216;Unable to read file&#8217; error like you, after approx. 100 rows.  Have you found a resolution?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-428">
		<div id="comment-428">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-428">March 24, 2004 at 7:20 pm</a></div>

		<div class="comment-body"><p>Jeremy &#8211; no I haven&#8217;t.  The tests I ran were on pages with around a hundred rows, but I didn&#8217;t count to make sure.  Hopefully I can test again soon.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-427">
		<div id="comment-427">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">jeremy t</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-427">March 24, 2004 at 7:08 pm</a></div>

		<div class="comment-body"><p>Has anyone yet encountered the msgbox &quot;Unable to Read file&quot; if the datagrid contains over say 100 records ?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-426">
		<div id="comment-426">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-426">February 13, 2004 at 7:16 am</a></div>

		<div class="comment-body"><p>Nice, thanks Brendan!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-425">
		<div id="comment-425">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Brendan Tompkins</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-425">February 13, 2004 at 6:51 am</a></div>

		<div class="comment-body"><p>D-Ral.. Yep this is cool. You can also try transforming your ds.GetXml() using a variety of different methods to return comma delim, or even ExcelXML&#8230; Try these XSLT files, <a target="_new" href="http://www.intrinsigo.com/bsblog/ExcelXML.zip">http://www.intrinsigo.com/bsblog/ExcelXML.zip</a> against your DataSet&#8217;s GetXml() string, before you do your Response.Write</p>
<p>-B</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-424">
		<div id="comment-424">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Darrell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-424">February 13, 2004 at 5:36 am</a></div>

		<div class="comment-body"><p>Robert and Joseph &#8211; yes I forgot the MIME type line!  Thanks for pointing it out!  I have fixed the code example by adding two lines of code above.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-423">
		<div id="comment-423">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Robert Hurlbut</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-423">February 13, 2004 at 3:52 am</a></div>

		<div class="comment-body"><p>Thanks for the great link, Joseph.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-422">
		<div id="comment-422">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">JosephCooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-422">February 12, 2004 at 9:58 pm</a></div>

		<div class="comment-body"><p>I don&#8217;t know if it is what Darrell had in mind, but I think if you set the mime type to &quot;	application/excel&quot; in the header then this would display in the client in Excel, but maybe there is some &quot;tick&quot; or &quot;hook&quot; that I missed too. I found a fairly extensive list of MIME types here: <a target="_new" href="http://www.webmaster-toolkit.com/mime-types.shtml">http://www.webmaster-toolkit.com/mime-types.shtml</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-421">
		<div id="comment-421">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Robert Hurlbut</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#comment-421">February 12, 2004 at 8:36 pm</a></div>

		<div class="comment-body"><p>Darrell &#8212; just looking at the code, I don&#8217;t understand how it knows to go to Excel?  Where is the &quot;hook&quot;, or am I missing something?  Thanks, Robert</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/darrellnorton/2004/02/13/export-a-datagrid-to-excel/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://codebetter.com/darrellnorton/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='232' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d8e4a1ffda" /></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.411 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-25 15:22:52 -->
<!-- super cache -->